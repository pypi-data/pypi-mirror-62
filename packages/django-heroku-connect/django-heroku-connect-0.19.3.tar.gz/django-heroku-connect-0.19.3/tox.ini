[tox]
envlist =
    py{36}-dj{111,20,21,22,30,master}
    isort
    docs
whitelist_externals=sphinx-build

[travis]
unignore_outcomes = True
python =
    3.6: py36,isort,docs

[testenv]
deps=
    -rrequirements-dev.txt
    dj111: django>=1.11,<2.0
    dj20: django>=2.0a1,<2.1
    dj21: django>=2.1a1,<2.2
    dj22: django>=2.2a1,<3.0
    dj30: django>=3.0a1,<3.1
    djmaster: https://github.com/django/django/archive/master.tar.gz#egg=django
setenv =
    PYTHONPATH = {toxinidir}
commands=
    coverage run --source=heroku_connect -m 'pytest' \
        --basetemp={envtmpdir} \
        --ignore=.tox \
        {posargs}

[testenv:isort]
changedir={toxinidir}
deps=
    isort
commands=
    isort --check-only --recursive --diff {posargs}

[testenv:docs]
deps=
    -rrequirements-dev.txt
commands=python setup.py build_sphinx -b spelling
