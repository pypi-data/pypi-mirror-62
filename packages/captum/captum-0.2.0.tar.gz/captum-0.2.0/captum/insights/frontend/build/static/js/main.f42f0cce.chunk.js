(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{1:function(e,a,t){e.exports={app:"App_app__1kX79",header:"App_header__3ZZ1n",header__name:"App_header__name__11V8z",header__nav:"App_header__nav__1d4-r",header__nav__item:"App_header__nav__item__1sl_l","header__nav__item--active":"App_header__nav__item--active__qHsJb","filter-panel":"App_filter-panel__1_W-D",viz__panel:"App_viz__panel__1DvPS","filter-panel__column":"App_filter-panel__column__tSar1","filter-panel__column__title":"App_filter-panel__column__title__1BI85",panel__column__title:"App_panel__column__title__1ZKms","filter-panel__column__body":"App_filter-panel__column__body__2gifz","filter-panel__column--end":"App_filter-panel__column--end__11Fot",select:"App_select__lfdUS",input:"App_input__2NxBo","input--narrow":"App_input--narrow__3EP69",row:"App_row__1s1ax","row--padding":"App_row--padding__290gG",btn:"App_btn__34jjX","btn--large":"App_btn--large__1yJzq","btn--outline":"App_btn--outline__Gy9-J","btn--solid":"App_btn--solid__jJmRZ",viz:"App_viz__22ORP",loading:"App_loading__wCN4P",panel:"App_panel___hL33","panel--loading":"App_panel--loading__2o16s","panel--center":"App_panel--center__3KnXW",panel__column:"App_panel__column__3x9QU","panel__column--stretch":"App_panel__column--stretch__2o3HO",gallery:"App_gallery__11BWP",gallery__item:"App_gallery__item__2XNr9",gallery__item__image:"App_gallery__item__image__3sU36",gallery__item__description:"App_gallery__item__description__1eCLM","bar-chart__group":"App_bar-chart__group__17Ybq","bar-chart__group__bar":"App_bar-chart__group__bar__1T_FD","bar-chart__group__title":"App_bar-chart__group__title__1gSfe","percentage-blue":"App_percentage-blue__2Y6MH","percentage-light-blue":"App_percentage-light-blue__2W41P","percentage-light-red":"App_percentage-light-red__189Ov","percentage-red":"App_percentage-red__3dSfE","percentage-gray":"App_percentage-gray__HnO9X","percentage-white":"App_percentage-white__3aG-5","text-feature-word":"App_text-feature-word__Spy0f",tooltip__label:"App_tooltip__label__37Y9h","general-feature__label-container":"App_general-feature__label-container__1wWDg","general-feature__label":"App_general-feature__label__Oz5fH","general-feature__percent":"App_general-feature__percent__2FWgI","general-feature__bar-container":"App_general-feature__bar-container__ZNGWt","general-feature__bar":"App_general-feature__bar__3s8ZU","general-feature__bar__positive":"App_general-feature__bar__positive__JbWh6","general-feature__bar__negative":"App_general-feature__bar__negative__Tju-a",spinner:"App_spinner__zg8k4"}},11:function(e,a,t){e.exports=t(24)},16:function(e,a,t){},23:function(e,a,t){},24:function(e,a,t){"use strict";t.r(a);var n=t(0),l=t.n(n),r=t(9),c=t.n(r),s=(t(16),t(2)),i=t(3),_=t(5),o=t(4),p=t(6),u=t(7),m=t(10),d=t.n(m),h=t(1),g=t.n(h),f=(t(23),Object.freeze({Number:"number",Enum:"enum"}));function b(e){return Array.isArray(e)?e.join(" "):Object.keys(e).filter((function(a){return!!e[a]})).join(" ")}function v(e){switch(e.type){case"checkbox":return e.checked;case"number":return parseInt(e.value);default:return e.value}}var E=function(e){function a(){return Object(s.a)(this,a),Object(_.a)(this,Object(o.a)(a).apply(this,arguments))}return Object(p.a)(a,e),Object(i.a)(a,[{key:"render",value:function(){return l.a.createElement("header",{className:g.a.header},l.a.createElement("div",{className:g.a.header__name},"Captum Insights"),l.a.createElement("nav",{className:g.a.header__nav},l.a.createElement("ul",null,l.a.createElement("li",{className:b([g.a.header__nav__item,g.a["header__nav__item--active"]])},"Instance Attribution"))))}}]),a}(l.a.Component);function y(e){return l.a.createElement("div",{className:g.a.tooltip},l.a.createElement("div",{className:g.a.tooltip__label},e.label))}var N=function(e){function a(e){var t;Object(s.a)(this,a),(t=Object(_.a)(this,Object(o.a)(a).call(this,e))).handleClassDelete=function(e){var a=t.state.classes.slice(0),n=a.splice(e,1),l=[].concat(t.state.suggested_classes,n);t.setState({classes:a,suggested_classes:l})},t.handleClassAdd=function(e){var a=[].concat(t.state.classes,e),n=t.state.suggested_classes.filter((function(a){return a.id!==e.id}));t.setState({classes:a,suggested_classes:n})},t.handleInputChange=function(e){var a=e.target,n=v(e.target),l=a.name;t.setState(Object(u.a)({},l,n))},t.handleArgumentChange=function(e){var a=e.target,n=a.name,l=v(a),r=t.state.method_arguments;r[t.state.selected_method][n].value=l,t.setState({method_arguments:r})},t.handleSubmit=function(e){var a=t.state.selected_method,n=t.state.method_arguments,l=a in n?n[a]:{},r={};Object.keys(l).forEach((function(e){r[e]=l[e].value}));var c={prediction:t.state.prediction,classes:t.state.classes.map((function(e){return e.name})),attribution_method:a,arguments:r};t.props.fetchData(c),e.preventDefault()};var n=e.config.classes.map((function(e,a){return{id:a,name:e}}));return t.state={prediction:"all",classes:[],suggested_classes:n,selected_method:e.config.selected_method,method_arguments:e.config.method_arguments},t}return Object(p.a)(a,e),Object(i.a)(a,[{key:"render",value:function(){return l.a.createElement(O,{prediction:this.state.prediction,classes:this.state.classes,suggestedClasses:this.state.suggested_classes,selectedMethod:this.state.selected_method,methodArguments:this.state.method_arguments,methods:this.props.config.methods,handleClassAdd:this.handleClassAdd,handleClassDelete:this.handleClassDelete,handleInputChange:this.handleInputChange,handleArgumentChange:this.handleArgumentChange,handleSubmit:this.handleSubmit})}}]),a}(l.a.Component),j=function(e){function a(){return Object(s.a)(this,a),Object(_.a)(this,Object(o.a)(a).apply(this,arguments))}return Object(p.a)(a,e),Object(i.a)(a,[{key:"render",value:function(){return l.a.createElement(d.a,{tags:this.props.classes,autofocus:!1,suggestions:this.props.suggestedClasses,handleDelete:this.props.handleClassDelete,handleAddition:this.props.handleClassAdd,minQueryLength:0,placeholder:"add new class..."})}}]),a}(l.a.Component),A=function(e){function a(){return Object(s.a)(this,a),Object(_.a)(this,Object(o.a)(a).apply(this,arguments))}return Object(p.a)(a,e),Object(i.a)(a,[{key:"render",value:function(){var e=this.props.limit[0],a=this.props.limit[1];return l.a.createElement("div",null,this.props.name+": ",l.a.createElement("input",{className:b([g.a.input,g.a["input--narrow"]]),name:this.props.name,type:"number",value:this.props.value,min:e,max:a,onChange:this.props.handleInputChange}))}}]),a}(l.a.Component),C=function(e){function a(){return Object(s.a)(this,a),Object(_.a)(this,Object(o.a)(a).apply(this,arguments))}return Object(p.a)(a,e),Object(i.a)(a,[{key:"render",value:function(){var e=this.props.limit.map((function(e,a){return l.a.createElement("option",{value:e},e)}));return l.a.createElement("div",null,this.props.name+": ",l.a.createElement("select",{className:g.a.select,name:this.props.name,value:this.props.value,onChange:this.props.handleInputChange},e))}}]),a}(l.a.Component),O=function(e){function a(){var e,t;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(t=Object(_.a)(this,(e=Object(o.a)(a)).call.apply(e,[this].concat(r)))).createComponentFromConfig=function(e,a){switch(a.type){case f.Number:return l.a.createElement(A,{name:e,limit:a.limit,value:a.value,handleInputChange:t.props.handleArgumentChange});case f.Enum:return l.a.createElement(C,{name:e,limit:a.limit,value:a.value,handleInputChange:t.props.handleArgumentChange})}},t}return Object(p.a)(a,e),Object(i.a)(a,[{key:"render",value:function(){var e=this,a=this.props.methods.map((function(e,a){return l.a.createElement("option",{key:a,value:e},e)})),t=null;if(this.props.selectedMethod in this.props.methodArguments){var n=this.props.methodArguments[this.props.selectedMethod];t=Object.keys(n).map((function(a,t){return e.createComponentFromConfig(a,n[a])}))}return l.a.createElement("form",{onSubmit:this.props.handleSubmit},l.a.createElement("div",{className:g.a["filter-panel"]},l.a.createElement("div",{className:g.a["filter-panel__column"]},l.a.createElement("div",{className:g.a["filter-panel__column__title"]},"Filter by Classes"),l.a.createElement("div",{className:g.a["filter-panel__column__body"]},l.a.createElement(j,{handleClassDelete:this.props.handleClassDelete,handleClassAdd:this.props.handleClassAdd,suggestedClasses:this.props.suggestedClasses,classes:this.props.classes}))),l.a.createElement("div",{className:g.a["filter-panel__column"]},l.a.createElement("div",{className:g.a["filter-panel__column__title"]},"Filter by Instances"),l.a.createElement("div",{className:g.a["filter-panel__column__body"]},"Prediction:"," ",l.a.createElement("select",{className:g.a.select,name:"prediction",onChange:this.props.handleInputChange,value:this.props.prediction},l.a.createElement("option",{value:"all"},"All"),l.a.createElement("option",{value:"correct"},"Correct"),l.a.createElement("option",{value:"incorrect"},"Incorrect")))),l.a.createElement("div",{className:g.a["filter-panel__column"]},l.a.createElement("div",{className:g.a["filter-panel__column__title"]},"Choose Attribution Method"),l.a.createElement("div",{className:g.a["filter-panel__column__body"]},"Attribution Method:"," ",l.a.createElement("select",{className:g.a.select,name:"selected_method",onChange:this.props.handleInputChange,value:this.props.selectedMethod},a))),l.a.createElement("div",{className:g.a["filter-panel__column"]},l.a.createElement("div",{className:g.a["filter-panel__column__title"]},"Attribution Method Arguments"),l.a.createElement("div",{className:g.a["filter-panel__column__body"]},t)),l.a.createElement("div",{className:b([g.a["filter-panel__column"],g.a["filter-panel__column--end"]])},l.a.createElement("button",{className:b([g.a.btn,g.a["btn--outline"],g.a["btn--large"]])},"Fetch"))))}}]),a}(l.a.Component);function k(e){return l.a.createElement("div",{className:g.a.spinner})}function w(e){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=[220,100,80],n=[10,100,67],l=null;l=e>0?t:n;var r=[0,40,a?100:90],c=Math.abs(.01*e);if(c<.02)return r;var s=[l[0],(l[1]-r[1])*c+r[1],(l[2]-r[2])*c+r[2]];return"hsl(".concat(s[0],", ").concat(s[1],"%, ").concat(s[2],"%)")}function x(e){return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:g.a.panel__column__title},e.data.name," (Image)"),l.a.createElement("div",{className:g.a.panel__column__body},l.a.createElement("div",{className:g.a.gallery},l.a.createElement("div",{className:g.a.gallery__item},l.a.createElement("div",{className:g.a.gallery__item__image},l.a.createElement("img",{src:"data:image/png;base64,"+e.data.base})),l.a.createElement("div",{className:g.a.gallery__item__description},"Original")),l.a.createElement("div",{className:g.a.gallery__item},l.a.createElement("div",{className:g.a.gallery__item__image},l.a.createElement("img",{src:"data:image/png;base64,"+e.data.modified})),l.a.createElement("div",{className:g.a.gallery__item__description},"Attribution Magnitude")))))}function I(e){var a=e.data.base.map((function(a,t){return l.a.createElement(l.a.Fragment,null,l.a.createElement("span",{style:{backgroundColor:w(e.data.modified[t],!1)},className:"text-feature-word"},a,l.a.createElement(y,{label:e.data.modified[t].toFixed(3)}))," ")}));return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:g.a.panel__column__title},e.data.name," (Text)"),l.a.createElement("div",{className:g.a.panel__column__body},a))}function S(e){var a=e.data.base.map((function(a,t){var n=e.data.modified[t].toFixed(3),r="general-feature__bar__"+(n>0?"positive":"negative"),c=Math.abs(n)+"%";return l.a.createElement("div",{className:g.a["general-feature"]},l.a.createElement("span",{className:g.a["general-feature__label-container"]},l.a.createElement("span",{className:g.a["general-feature__label"]},a),l.a.createElement("span",{className:g.a["general-feature__percent"]},n)),l.a.createElement("div",{className:g.a["general-feature__bar-container"]},l.a.createElement("span",{className:b([g.a["general-feature__bar"],r]),style:{width:c}})))}));return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:g.a.panel__column__title},e.data.name," (General)"),l.a.createElement("div",{className:g.a.panel__column__body},a))}function T(e){var a=e.data;switch(a.type){case"image":return l.a.createElement(x,{data:a});case"text":return l.a.createElement(I,{data:a});case"general":return l.a.createElement(S,{data:a});default:throw new Error("Unsupported feature visualization type: "+a.type)}}var D=function(e){function a(){return Object(s.a)(this,a),Object(_.a)(this,Object(o.a)(a).apply(this,arguments))}return Object(p.a)(a,e),Object(i.a)(a,[{key:"render",value:function(){return this.props.feature_outputs.map((function(e){var a=100*e.contribution,t=a>10?a:a+10;return l.a.createElement("div",{className:g.a["bar-chart__group"]},l.a.createElement("div",{className:g.a["bar-chart__group__bar"],style:{height:t+"px",backgroundColor:w(a)}}),l.a.createElement("div",{className:g.a["bar-chart__group__title"]},e.name))}))}}]),a}(l.a.Component),F=function(e){function a(){var e,t;Object(s.a)(this,a);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(t=Object(_.a)(this,(e=Object(o.a)(a)).call.apply(e,[this].concat(l)))).onClick=function(e){e.preventDefault(),t.props.onTargetClick(t.props.labelIndex,t.props.instance)},t}return Object(p.a)(a,e),Object(i.a)(a,[{key:"render",value:function(){var e;return l.a.createElement("button",{onClick:this.onClick,className:b((e={},Object(u.a)(e,g.a.btn,!0),Object(u.a)(e,g.a["btn--solid"],this.props.active),Object(u.a)(e,g.a["btn--outline"],!this.props.active),e))},this.props.children)}}]),a}(l.a.Component),z=function(e){function a(e){var t;return Object(s.a)(this,a),(t=Object(_.a)(this,Object(o.a)(a).call(this,e))).onTargetClick=function(e,a){t.setState({loading:!0}),t.props.onTargetClick(e,a,(function(){return t.setState({loading:!1})}))},t.state={loading:!1},t}return Object(p.a)(a,e),Object(i.a)(a,[{key:"render",value:function(){var e,a=this,t=this.props.data,n=t.feature_outputs.map((function(e){return l.a.createElement(T,{data:e})}));return l.a.createElement(l.a.Fragment,null,this.state.loading&&l.a.createElement("div",{className:g.a.loading},l.a.createElement(k,null)),l.a.createElement("div",{className:b((e={},Object(u.a)(e,g.a.panel,!0),Object(u.a)(e,g.a["panel--long"],!0),Object(u.a)(e,g.a["panel--loading"],this.state.loading),e))},l.a.createElement("div",{className:g.a.panel__column},l.a.createElement("div",{className:g.a.panel__column__title},"Predicted"),l.a.createElement("div",{className:g.a.panel__column__body},t.predicted.map((function(e){return l.a.createElement("div",{className:b([g.a.row,g.a["row--padding"]])},l.a.createElement(F,{onTargetClick:a.onTargetClick,labelIndex:e.index,instance:a.props.instance,active:e.index===t.active_index},e.label," (",e.score.toFixed(3),")"))})))),l.a.createElement("div",{className:g.a.panel__column},l.a.createElement("div",{className:g.a.panel__column__title},"Label"),l.a.createElement("div",{className:g.a.panel__column__body},l.a.createElement("div",{className:g.a["row row--padding"]},l.a.createElement(F,{onTargetClick:this.onTargetClick,labelIndex:t.actual.index,instance:this.props.instance,active:t.actual.index===t.active_index},t.actual.label)))),l.a.createElement("div",{className:g.a.panel__column},l.a.createElement("div",{className:g.a.panel__column__title},"Contribution"),l.a.createElement("div",{className:g.a.panel__column__body},l.a.createElement("div",{className:g.a["bar-chart"]},l.a.createElement(D,{feature_outputs:t.feature_outputs})))),l.a.createElement("div",{className:b([g.a.panel__column,g.a["panel__column--stretch"]])},n)))}}]),a}(l.a.Component);function M(e){return e.loading?l.a.createElement("div",{className:"viz"},l.a.createElement("div",{className:b([g.a.panel,g.a["panel--center"]])},l.a.createElement(k,null))):e.data&&0!==e.data.length?l.a.createElement("div",{className:g.a.viz},e.data.map((function(a,t){return l.a.createElement(z,{data:a,instance:t,key:t,onTargetClick:e.onTargetClick})}))):l.a.createElement("div",{className:g.a.viz},l.a.createElement("div",{className:g.a.panel},l.a.createElement("div",{className:g.a.panel__column},"Please press"," ",l.a.createElement("strong",{className:g.a["text-feature-word"]},"Fetch")," to start loading data.")))}var P=function(e){function a(){return Object(s.a)(this,a),Object(_.a)(this,Object(o.a)(a).apply(this,arguments))}return Object(p.a)(a,e),Object(i.a)(a,[{key:"componentDidMount",value:function(){this.props.fetchInit()}},{key:"render",value:function(){return l.a.createElement("div",{className:g.a.app},l.a.createElement(E,null),l.a.createElement(N,{fetchData:this.props.fetchData,config:this.props.config,key:this.props.config.classes}),l.a.createElement(M,{data:this.props.data,loading:this.props.loading,onTargetClick:this.props.onTargetClick}))}}]),a}(l.a.Component),J=function(e){function a(e){var t;return Object(s.a)(this,a),(t=Object(_.a)(this,Object(o.a)(a).call(this,e)))._fetchInit=function(){fetch("init").then((function(e){return e.json()})).then((function(e){return t.setState({config:e})}))},t.fetchData=function(e){t.setState({loading:!0}),fetch("fetch",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){return t.setState({data:e,loading:!1})}))},t.onTargetClick=function(e,a,n){fetch("attribute",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({labelIndex:e,instance:a})}).then((function(e){return e.json()})).then((function(e){var l=Object.assign([],t.state.data);l[a]=e,t.setState({data:l}),n()}))},t.state={data:[],config:{classes:[],methods:[],method_arguments:{}},loading:!1},t._fetchInit(),t}return Object(p.a)(a,e),Object(i.a)(a,[{key:"render",value:function(){return l.a.createElement(P,{fetchData:this.fetchData,fetchInit:this._fetchInit,onTargetClick:this.onTargetClick,data:this.state.data,config:this.state.config,loading:this.state.loading})}}]),a}(l.a.Component);c.a.render(l.a.createElement(J,null),document.getElementById("root"))}},[[11,1,2]]]);
//# sourceMappingURL=main.f42f0cce.chunk.js.map