full:
  stage: test
  image: i10git.cs.fau.de:5005/pycodegen/pycodegen/full
  script:
    - git submodule update --init --recursive
    - python -m pip install -e .
    - python setup.py test
    - python setup.py bdist_wheel
    - python setup.py sdist
  tags:
    - docker
    - cuda
  artifacts:
    paths:
      - 'src/pyronn_torch/pyronn_torch_cpp.so'
      - 'dist'

minimal-windows:
  stage: test
  tags:
    - win
  script:
    - source /cygdrive/c/Users/build/Miniconda3/Scripts/activate
    - source activate pystencils_dev
    - env
    - conda env list
    - python -c "import numpy"
    - git submodule update --init --recursive
    - pip install -e .
    - python setup.py bdist_wheel
  artifacts:
    paths:
      - 'dist'
