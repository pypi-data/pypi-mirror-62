{"version":3,"sources":["webpack:///./src/common/util/debounce.ts","webpack:///./src/common/string/compare.ts","webpack:///./src/common/util/render-status.ts","webpack:///./src/data/config_flow.ts","webpack:///./src/dialogs/config-flow/show-dialog-data-entry-flow.ts","webpack:///./src/dialogs/config-flow/show-dialog-config-flow.ts","webpack:///./src/common/dom/setup-leaflet-map.ts","webpack:///./src/data/zone.ts","webpack:///./src/components/map/ha-location-editor.ts","webpack:///./src/data/core.ts","webpack:///./src/components/timezone-datalist.ts","webpack:///./src/onboarding/onboarding-core-config.ts"],"names":["__webpack_require__","d","__webpack_exports__","debounce","func","wait","timeout","immediate","arguments","length","undefined","_len","args","Array","_key","context","this","callNow","clearTimeout","setTimeout","apply","compare","caseInsensitiveCompare","a","b","toLowerCase","afterNextRender","nextRender","cb","requestAnimationFrame","Promise","resolve","DISCOVERY_SOURCES","createConfigFlow","fetchConfigFlow","handleConfigFlowStep","ignoreConfigFlow","deleteConfigFlow","getConfigFlowHandlers","getConfigFlowInProgressCollection","subscribeConfigFlowInProgress","localizeConfigFlowTitle","_common_util_debounce__WEBPACK_IMPORTED_MODULE_0__","home_assistant_js_websocket__WEBPACK_IMPORTED_MODULE_1__","hass","handler","callApi","flowId","concat","data","callWS","type","flow_id","fetchConfigFlowInProgress","conn","sendMessagePromise","subscribeConfigFlowInProgressUpdates","store","subscribeEvents","then","flows","setState","getCollection","onChange","connection","subscribe","localize","flow","placeholders","title_placeholders","placeholderKeys","Object","keys","forEach","key","push","loadDataEntryFlowDialog","showFlowDialog","_common_dom_fire_event__WEBPACK_IMPORTED_MODULE_0__","all","e","bind","element","dialogParams","flowConfig","fireEvent","dialogTag","dialogImport","assign","loadConfigFlowDialog","showConfigFlowDialog","loadDevicesAndAreas","getFlowHandlers","handlers","sort","handlerA","handlerB","createFlow","fetchFlow","handleFlowStep","deleteFlow","renderAbortDescription","step","description","localizeKey","reason","description_placeholders","html","_templateObject","renderShowFormStepHeader","step_id","renderShowFormStepDescription","_templateObject2","renderShowFormStepFieldLabel","field","name","renderShowFormStepFieldError","error","renderExternalStepHeader","renderExternalStepDescription","_templateObject3","_templateObject4","renderCreateEntryDescription","_templateObject5","_templateObject6","title","setupLeafletMap","createTileLayer","mapElement","darkMode","draw","Leaflet","map","style","_args","regeneratorRuntime","async","_context","prev","next","parentNode","Error","awrap","t","sent","Icon","Default","imagePath","document","createElement","setAttribute","appendChild","setView","addTo","abrupt","stop","leaflet","tileLayer","Browser","retina","attribution","subdomains","minZoom","maxZoom","defaultRadiusColor","homeRadiusColor","passiveRadiusColor","fetchZones","createZone","updateZone","deleteZone","values","zoneId","updates","zone_id","customElement","LocationEditor","property","_leafletMap","location","_locationMarker","getBounds","fitBounds","fitZoom","_ignoreFitToMap","changedProps","_get","_getPrototypeOf","prototype","call","_initMap","has","_updateMarker","fitMap","_updateRadius","_updateRadiusColor","_updateIcon","shadowRoot","querySelector","_ref","_ref2","_this2","_mapEl","Boolean","radius","_slicedToArray","addEventListener","ev","_locationUpdated","latlng","invalidateSize","longitude","lng","Math","abs","lat","bubbles","getRadius","icon","iconHTML","el","outerHTML","_iconEl","divIcon","iconSize","className","_setIcon","editing","_moveMarker","setIcon","_this3","enable","moveMarker","resizeMarker","_resizeMarkers","target","getLatLng","_radiusUpdated","_this4","_context2","remove","setLatLng","disable","_setupEdit","circle","color","radiusColor","addLayer","marker","draggable","setRadius","setStyle","css","LitElement","saveCoreConfig","detectCoreConfig","createTimezoneListEl","google_timezones_json__WEBPACK_IMPORTED_MODULE_0__","google_timezones_json__WEBPACK_IMPORTED_MODULE_0___default","n","list","id","timezones","option","value","innerHTML","amsterdam","OnboardingCoreConfig","onboardingLocalize","user","_working","_nameValue","_handleChange","_connectWifi","_detect","_locationValue","_locationChanged","_timeZoneValue","_elevationValue","_unitSystem","_unitSystemValue","_unitSystemChanged","_save","focus","keyCode","inputElement","_name","_location","_elevation","_timeZone","currentTarget","detail","latitude","Number","elevation","String","unit_system","time_zone","t0","alert","message","finish","result","_continueFlow","continueFlowId","dialogClosedCallback","preventDefault","location_name","onboardCoreConfigStep"],"mappings":"uFAAAA,EAAAC,EAAAC,EAAA,sBAAAC,IAOO,IAAMA,EAAW,SACtBC,EACAC,GAEM,IACFC,EAFJC,EACMC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,IAAAA,UAAA,GAGN,OAAO,WAAkB,QAAAG,EAAAH,UAAAC,OAANG,EAAM,IAAAC,MAAAF,GAAAG,EAAA,EAAAA,EAAAH,EAAAG,IAANF,EAAME,GAAAN,UAAAM,GAGvB,IAAMC,EAAUC,KAOVC,EAAUV,IAAcD,EAC9BY,aAAaZ,GACbA,EAAUa,WARI,WACZb,EAAU,KACLC,GACHH,EAAKgB,MAAML,EAASH,IAKIP,GACxBY,GACFb,EAAKgB,MAAML,EAASH,uCC5B1BZ,EAAAC,EAAAC,EAAA,sBAAAmB,IAAArB,EAAAC,EAAAC,EAAA,sBAAAoB,IAAO,IAAMD,EAAU,SAACE,EAAWC,GACjC,OAAID,EAAIC,GACE,EAEND,EAAIC,EACC,EAGF,GAGIF,EAAyB,SAACC,EAAWC,GAAZ,OACpCH,EAAQE,EAAEE,cAAeD,EAAEC,kDCZ7BzB,EAAAC,EAAAC,EAAA,sBAAAwB,IAAA1B,EAAAC,EAAAC,EAAA,sBAAAyB,IAAO,IAAMD,EAAkB,SAACE,GAC9BC,sBAAsB,kBAAMV,WAAWS,EAAI,MAGhCD,EAAa,WACxB,OAAO,IAAIG,QAAQ,SAACC,GAClBL,EAAgBK,wCCJpB/B,EAAAC,EAAAC,EAAA,sBAAA8B,IAAAhC,EAAAC,EAAAC,EAAA,sBAAA+B,IAAAjC,EAAAC,EAAAC,EAAA,sBAAAgC,IAAAlC,EAAAC,EAAAC,EAAA,sBAAAiC,IAAAnC,EAAAC,EAAAC,EAAA,sBAAAkC,IAAApC,EAAAC,EAAAC,EAAA,sBAAAmC,IAAArC,EAAAC,EAAAC,EAAA,sBAAAoC,IAAAtC,EAAAC,EAAAC,EAAA,sBAAAqC,IAAAvC,EAAAC,EAAAC,EAAA,sBAAAsC,IAAAxC,EAAAC,EAAAC,EAAA,sBAAAuC,IAAA,IAAAC,EAAA1C,EAAA,KAAA2C,EAAA3C,EAAA,IAIagC,EAAoB,CAAC,WAAY,UAAW,OAAQ,YAEpDC,EAAmB,SAACW,EAAqBC,GAAtB,OAC9BD,EAAKE,QAA2B,OAAQ,6BAA8B,CACpED,aAGSX,EAAkB,SAACU,EAAqBG,GAAtB,OAC7BH,EAAKE,QACH,MADF,8BAAAE,OAEgCD,KAGrBZ,EAAuB,SAClCS,EACAG,EACAE,GAHkC,OAKlCL,EAAKE,QACH,OADF,8BAAAE,OAEgCD,GAC9BE,IAGSb,EAAmB,SAACQ,EAAqBG,GAAtB,OAC9BH,EAAKM,OAAO,CAAEC,KAAM,6BAA8BC,QAASL,KAEhDV,EAAmB,SAACO,EAAqBG,GAAtB,OAC9BH,EAAKE,QAAQ,SAAb,8BAAAE,OAAqDD,KAE1CT,EAAwB,SAACM,GAAD,OACnCA,EAAKE,QAAkB,MAAO,wCAE1BO,EAA4B,SAACC,GAAD,OAChCA,EAAKC,mBAAmB,CACtBJ,KAAM,kCAGJK,EAAuC,SAACF,EAAMG,GAAP,OAC3CH,EAAKI,gBACHvD,YACE,kBACEkD,EAA0BC,GAAMK,KAAK,SAACC,GAAD,OACnCH,EAAMI,SAASD,GAAO,MAE1B,KACA,GAEF,4BAGSrB,EAAoC,SAACe,GAAD,OAC/CQ,YACER,EACA,sBACAD,EACAG,IAGShB,EAAgC,SAC3CI,EACAmB,GAF2C,OAGxCxB,EAAkCK,EAAKoB,YAAYC,UAAUF,IAErDtB,EAA0B,SACrCyB,EACAC,GAEA,IAAMC,EAAeD,EAAKpD,QAAQsD,oBAAsB,GAClDC,EAAkBC,OAAOC,KAAKJ,GACpC,GAA+B,IAA3BE,EAAgB7D,OAClB,OAAOyD,EAAQ,aAAAlB,OAAcmB,EAAKtB,QAAnB,kBAEjB,IAAMjC,EAAiB,GAKvB,OAJA0D,EAAgBG,QAAQ,SAACC,GACvB9D,EAAK+D,KAAKD,GACV9D,EAAK+D,KAAKP,EAAaM,MAElBR,EAAQ9C,WAAR,gBAAA4B,OAAsBmB,EAAKtB,QAA3B,uBAAAG,OAA2DpC,uCCnFpEZ,EAAAC,EAAAC,EAAA,sBAAA0E,IAAA5E,EAAAC,EAAAC,EAAA,sBAAA2E,IAAA,IAAAC,EAAA9E,EAAA,IA+Ea4E,EAA0B,kBACrC9C,QAAAiD,IAAA,CAAA/E,EAAAgF,EAAA,GAAAhF,EAAAgF,EAAA,GAAAhF,EAAAgF,EAAA,GAAAhF,EAAAgF,EAAA,GAAAhF,EAAAgF,EAAA,MAAArB,KAAA3D,EAAAiF,KAAA,YAEWJ,EAAiB,SAC5BK,EACAC,EACAC,GAEAC,YAAUH,EAAS,cAAe,CAChCI,UAAW,yBACXC,aAAcX,EACdO,aAAYZ,OAAAiB,OAAA,GACPL,EADO,CAEVC,wiCC7EC,IAAMK,EAAuBb,IAEvBc,EAAuB,SAClCR,EACAC,GAFkC,OAIlCN,YAAeK,EAASC,EAAc,CACpCQ,qBAAqB,EACrBC,gBAAiB,SAAChD,GAAD,OACfN,YAAsBM,GAAMe,KAAK,SAACkC,GAAD,OAC/BA,EAASC,KAAK,SAACC,EAAUC,GAAX,OACZ1E,YACEsB,EAAKsB,SAAL,aAAAlB,OAA2B+C,EAA3B,kBACAnD,EAAKsB,SAAL,aAAAlB,OAA2BgD,EAA3B,wBAIRC,WAAYhE,IACZiE,UAAWhE,IACXiE,eAAgBhE,IAChBiE,WAAY/D,IAEZgE,uBAhBoC,SAgBbzD,EAAM0D,GAC3B,IAAMC,EAAcC,YAClB5D,EAAKsB,SADwB,aAAAlB,OAEhBsD,EAAKzD,QAFW,kBAAAG,OAEasD,EAAKG,QAC/CH,EAAKI,0BAGP,OAAOH,EACHI,YADcC,IAEqBL,GAEnC,IAGNM,yBA9BoC,SA8BXjE,EAAM0D,GAC7B,OAAO1D,EAAKsB,SAAL,aAAAlB,OACQsD,EAAKzD,QADb,iBAAAG,OACoCsD,EAAKQ,QADzC,YAKTC,8BApCoC,SAoCNnE,EAAM0D,GAClC,IAAMC,EAAcC,YAClB5D,EAAKsB,SADwB,aAAAlB,OAEhBsD,EAAKzD,QAFW,iBAAAG,OAEYsD,EAAKQ,QAFjB,gBAG7BR,EAAKI,0BAEP,OAAOH,EACHI,YADcK,IAEqBT,GAEnC,IAGNU,6BAjDoC,SAiDPrE,EAAM0D,EAAMY,GACvC,OAAOtE,EAAKsB,SAAL,aAAAlB,OACQsD,EAAKzD,QADb,iBAAAG,OACoCsD,EAAKQ,QADzC,UAAA9D,OAEHkE,EAAMC,QAKZC,6BAzDoC,SAyDPxE,EAAM0D,EAAMe,GACvC,OAAOzE,EAAKsB,SAAL,aAAAlB,OAA2BsD,EAAKzD,QAAhC,kBAAAG,OAAwDqE,KAGjEC,yBA7DoC,SA6DX1E,EAAM0D,GAC7B,OAAO1D,EAAKsB,SAAL,aAAAlB,OACQsD,EAAKzD,QADb,iBAAAG,OACoCsD,EAAKQ,QADzC,YAKTS,8BAnEoC,SAmEN3E,EAAM0D,GAClC,IAAMC,EAAcC,YAClB5D,EAAKsB,SADwB,aAAAlB,OAEhBsD,EAAKzD,QAFW,YAAAG,OAEOsD,EAAKQ,QAFZ,gBAG7BR,EAAKI,0BAGP,OAAOC,YAAPa,IAEM5E,EAAKsB,SACL,sEAGFqC,EACEI,YADSc,IAE0BlB,GAEnC,KAIRmB,6BAxFoC,SAwFP9E,EAAM0D,GACjC,IAAMC,EAAcC,YAClB5D,EAAKsB,SADwB,aAAAlB,OAEhBsD,EAAKzD,QAFW,yBAAAG,OAEoBsD,EAAKC,aACpD,WACFD,EAAKI,0BAGP,OAAOC,YAAPgB,IACIpB,EACEI,YADSiB,IAE0BrB,GAEnC,GAEA3D,EAAKsB,SACL,0DACA,OACAoC,EAAKuB,8CC9HjB7H,EAAAC,EAAAC,EAAA,sBAAA4H,IAAA9H,EAAAC,EAAAC,EAAA,sBAAA6H,IAIO,IAAMD,EAAkB,SAC7BE,GAD6B,IAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA9H,UAAA,OAAA+H,mBAAAC,MAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,UAE7BV,EAF6BK,EAAA7H,OAAA,QAAAC,IAAA4H,EAAA,IAAAA,EAAA,GAG7BJ,EAH6BI,EAAA7H,OAAA,QAAAC,IAAA4H,EAAA,IAAAA,EAAA,GAKxBN,EAAWY,WALa,CAAAH,EAAAE,KAAA,cAMrB,IAAIE,MAAM,oDANW,cAAAJ,EAAAE,KAAA,EAAAJ,mBAAAO,MASN9I,EAAAgF,EAAA,KAAArB,KAAA3D,EAAA+I,EAAA9D,KAAA,cATM,WASvBkD,EATuBM,EAAAO,MAYrBC,KAAKC,QAAQC,UAAY,kCAE7BjB,EAdyB,CAAAO,EAAAE,KAAA,gBAAAF,EAAAE,KAAA,GAAAJ,mBAAAO,MAerB9I,EAAAgF,EAAA,KAAArB,KAAA3D,EAAA+I,EAAA9D,KAAA,cAfqB,eAkBvBmD,EAAMD,EAAQC,IAAIJ,IAClBK,EAAQe,SAASC,cAAc,SAC/BC,aAAa,OAAQ,sCAC3BjB,EAAMiB,aAAa,MAAO,cAC1BtB,EAAWY,WAAWW,YAAYlB,GAClCD,EAAIoB,QAAQ,CAAC,WAAY,WAAY,IACrCzB,EAAgBI,EAASF,GAAUwB,MAAMrB,GAxBZK,EAAAiB,OAAA,SA0BtB,CAACtB,EAAKD,IA1BgB,yBAAAM,EAAAkB,WA6BlB5B,EAAkB,SAC7B6B,EACA3B,GAEA,OAAO2B,EAAQC,UAAR,qCAAA7G,OAEHiF,EAAW,WAAa,YAFrB,gBAAAjF,OAGU4G,EAAQE,QAAQC,OAAS,UAAY,QACpD,CACEC,YACE,wIACFC,WAAY,OACZC,QAAS,EACTC,QAAS,wCC9CfnK,EAAAC,EAAAC,EAAA,sBAAAkK,IAAApK,EAAAC,EAAAC,EAAA,sBAAAmK,IAAArK,EAAAC,EAAAC,EAAA,sBAAAoK,IAAAtK,EAAAC,EAAAC,EAAA,sBAAAqK,IAAAvK,EAAAC,EAAAC,EAAA,sBAAAsK,IAAAxK,EAAAC,EAAAC,EAAA,sBAAAuK,IAAAzK,EAAAC,EAAAC,EAAA,sBAAAwK,IAAO,IAAMN,EAAqB,UACrBC,EAA0B,UAC1BC,EAA6B,UAqB7BC,EAAa,SAAC3H,GAAD,OACxBA,EAAKM,OAAe,CAAEC,KAAM,eAEjBqH,EAAa,SAAC5H,EAAqB+H,GAAtB,OACxB/H,EAAKM,OAALqB,OAAAiB,OAAA,CACErC,KAAM,eACHwH,KAGMF,EAAa,SACxB7H,EACAgI,EACAC,GAHwB,OAKxBjI,EAAKM,OAALqB,OAAAiB,OAAA,CACErC,KAAM,cACN2H,QAASF,GACNC,KAGMH,EAAa,SAAC9H,EAAqBgI,GAAtB,OACxBhI,EAAKM,OAAO,CACVC,KAAM,cACN2H,QAASF,q8RCrBZG,YAAc,yCACTC,smBACHC,sEACAA,oEACAA,yEACAA,4FACgB,6QASjB,WACOjK,KAAKkK,aAAgBlK,KAAKmK,WAG1BnK,KAAKoK,gBAA2BC,UACnCrK,KAAKkK,YAAYI,UAAWtK,KAAKoK,gBAA2BC,aAE5DrK,KAAKkK,YAAY1B,QAAQxI,KAAKmK,SAAUnK,KAAKuK,SAE/CvK,KAAKwK,gBAAkBxK,KAAKmK,8CAG9B,WACE,OAAOxE,YAAPC,+CAKF,SAAuB6E,GACrBC,EAAAC,EAjCEX,EAiCFY,WAAA,eAAA5K,MAAA6K,KAAA7K,KAAmByK,GACnBzK,KAAK8K,gDAGP,SAAkBL,GAChBC,EAAAC,EAtCEX,EAsCFY,WAAA,UAAA5K,MAAA6K,KAAA7K,KAAcyK,GAGTzK,KAAKmH,UAINsD,EAAaM,IAAI,cACnB/K,KAAKgL,iBAEHhL,KAAKmK,UACHnK,KAAKwK,iBACLxK,KAAKwK,gBAAgB,KAAOxK,KAAKmK,SAAS,IAC1CnK,KAAKwK,gBAAgB,KAAOxK,KAAKmK,SAAS,IAE5CnK,KAAKiL,UAGLR,EAAaM,IAAI,WACnB/K,KAAKkL,gBAEHT,EAAaM,IAAI,gBACnB/K,KAAKmL,qBAEHV,EAAaM,IAAI,SACnB/K,KAAKoL,gDAIT,WACE,OAAOpL,KAAKqL,WAAYC,cAAc,6CAGxC,eAAAC,EAAAC,EAAAC,EAAAzL,KAAA,OAAAuH,mBAAAC,MAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,cAAAF,EAAAE,KAAA,EAAAJ,mBAAAO,MAC2ChB,YACvC9G,KAAK0L,QACL,EACAC,QAAQ3L,KAAK4L,UAJjB,OAAAL,EAAA9D,EAAAO,KAAAwD,EAAAK,EAAAN,EAAA,GACGvL,KAAKkK,YADRsB,EAAA,GACqBxL,KAAKmH,QAD1BqE,EAAA,GAMExL,KAAKkK,YAAY4B,iBACf,QAEA,SAACC,GAAD,OAA2BN,EAAKO,iBAAiBD,EAAGE,UAEtDjM,KAAKoL,cACLpL,KAAKgL,gBACLhL,KAAKiL,SACLjL,KAAKkK,YAAYgC,iBAdnB,yBAAAzE,EAAAkB,SAAA,KAAA3I,oDAiBA,SAAyBiM,GACvB,IAAIE,EAAYF,EAAOG,IACnBC,KAAKC,IAAIH,GAAa,MAExBA,GAAeA,EAAY,IAAS,KAAS,IAAS,KAExDnM,KAAKmK,SAAWnK,KAAKwK,gBAAkB,CAACyB,EAAOM,IAAKJ,GACpD9H,YAAUrE,KAAM,cAAUN,EAAW,CAAE8M,SAAS,gDAGlD,WACExM,KAAKwK,gBAAkBxK,KAAKmK,SAC5BnK,KAAK4L,OAAU5L,KAAKoK,gBAA2BqC,YAC/CpI,YAAUrE,KAAM,cAAUN,EAAW,CAAE8M,SAAS,6CAGlD,WACE,GAAKxM,KAAK0M,KAAV,CAMA,IAAIC,EACEC,EAAKxE,SAASC,cAAc,WAClCuE,EAAGtE,aAAa,OAAQtI,KAAK0M,MAC7BC,EAAWC,EAAGC,UAEd7M,KAAK8M,QAAU9M,KAAKmH,QAAS4F,QAAQ,CACnCpH,KAAMgH,EACNK,SAAU,CAAC,GAAI,IACfC,UAAW,4BAEbjN,KAAKkN,gBAfHlN,KAAK8M,aAAUpN,wCAkBnB,WACOM,KAAKoK,iBAAoBpK,KAAK8M,UAI9B9M,KAAK4L,OAMS5L,KAAKoK,gBAAgB+C,QAAQC,YACrCC,QAAQrN,KAAK8M,SANrB9M,KAAKoK,gBAA2BiD,QAAQrN,KAAK8M,kDASlD,WAAqB,IAAAQ,EAAAtN,KAEnBA,KAAKoK,gBAAgB+C,QAAQI,SAE7B,IAAMC,EAAaxN,KAAKoK,gBAAgB+C,QAAQC,YAE1CK,EAAezN,KAAKoK,gBAAgB+C,QAAQO,eAAe,GACjE1N,KAAKkN,WACLM,EAAW1B,iBACT,UAEA,SAACC,GAAD,OAAsBuB,EAAKtB,iBAAiBD,EAAG4B,OAAOC,eAExDH,EAAa3B,iBACX,UAEA,SAACC,GAAD,OAAsBuB,EAAKO,eAAe9B,gDAI9C,eAAA+B,EAAA9N,KAAA,OAAAuH,mBAAAC,MAAA,SAAAuG,GAAA,cAAAA,EAAArG,KAAAqG,EAAApG,MAAA,UACO3H,KAAKmK,SADZ,CAAA4D,EAAApG,KAAA,eAEQ3H,KAAKoK,kBACPpK,KAAKoK,gBAAgB4D,SACrBhO,KAAKoK,qBAAkB1K,GAJ7BqO,EAAArF,OAAA,qBASM1I,KAAKoK,gBATX,CAAA2D,EAAApG,KAAA,YAUI3H,KAAKoK,gBAAgB6D,UAAUjO,KAAKmK,WAChCnK,KAAK4L,OAXb,CAAAmC,EAAApG,KAAA,gBAaM3H,KAAKoK,gBAAgB+C,QAAQe,UAbnCH,EAAApG,KAAA,EAAAJ,mBAAAO,MAcYnH,eAdZ,OAeMX,KAAKmO,aAfX,eAAAJ,EAAArF,OAAA,kBAoBO1I,KAAK4L,QAYR5L,KAAKoK,gBAAkBpK,KAAKmH,QAASiH,OAAOpO,KAAKmK,SAAU,CACzDkE,MAAOrO,KAAKsO,aAAelF,IAC3BwC,OAAQ5L,KAAK4L,SAEf5L,KAAKkK,YAAaqE,SAASvO,KAAKoK,iBAChCpK,KAAKmO,eAhBLnO,KAAKoK,gBAAkBpK,KAAKmH,QAASqH,OAAOxO,KAAKmK,SAAU,CACzDsE,WAAW,IAEbzO,KAAKkN,WACLlN,KAAKoK,gBAAgB0B,iBACnB,UAEA,SAACC,GAAD,OAAsB+B,EAAK9B,iBAAiBD,EAAG4B,OAAOC,eAExD5N,KAAKkK,YAAaqE,SAASvO,KAAKoK,kBA9BpC,yBAAA2D,EAAApF,SAAA,KAAA3I,iDAyCA,WACOA,KAAKoK,iBAAoBpK,KAAK4L,QAGlC5L,KAAKoK,gBAA2BsE,UAAU1O,KAAK4L,wDAGlD,WACO5L,KAAKoK,iBAAoBpK,KAAK4L,QAGlC5L,KAAKoK,gBAA2BuE,SAAS,CAAEN,MAAOrO,KAAKsO,yDAG1D,WACE,OAAOM,YAAP5I,UAvNyB6I,uCChB7B7P,EAAAC,EAAAC,EAAA,sBAAA4P,IAAA9P,EAAAC,EAAAC,EAAA,sBAAA6P,IAAO,IAAMD,EAAiB,SAC5BlN,EACA+H,GAF4B,OAI5B/H,EAAKM,OAALqB,OAAAiB,OAAA,CACErC,KAAM,sBACHwH,KAGMoF,EAAmB,SAACnN,GAAD,OAC9BA,EAAKM,OAAoC,CACvCC,KAAM,0DCvBVnD,EAAAC,EAAAC,EAAA,sBAAA8P,IAAA,IAAAC,EAAAjQ,EAAA,KAAAkQ,EAAAlQ,EAAAmQ,EAAAF,GAEaD,EAAuB,WAClC,IAAMI,EAAOhH,SAASC,cAAc,YAQpC,OAPA+G,EAAKC,GAAK,YACV9L,OAAOC,KAAK8L,KAAW7L,QAAQ,SAACC,GAC9B,IAAM6L,EAASnH,SAASC,cAAc,UACtCkH,EAAOC,MAAQ9L,EACf6L,EAAOE,UAAYH,IAAU5L,GAC7B0L,EAAK7G,YAAYgH,KAEZH,kvKCoBT,IAAMM,EAAY,CAAC,UAAW,m1LAE7B3F,YAAc,6CACT4F,smBACH1F,kEACAA,gFAEAA,sDAA8B,8BAE9BA,mEACAA,uEACAA,wEACAA,yEACAA,+EAED,WACE,OAAOtE,YAAPC,IAEM5F,KAAK4P,mBACL,6CACA,OACA5P,KAAK4B,KAAKiO,KAAM1J,MAKTnG,KAAK4P,mBACZ,sDAGU5P,KAAK8P,SACR9P,KAAK+P,WACG/P,KAAKgQ,cAKlBhQ,KAAK4P,mBACL,uDAKE5P,KAAK4P,mBACL,8DAIiB5P,KAAKiQ,aASkBjQ,KAAKkQ,QAI5BlQ,KAAKkQ,QACtBlQ,KAAK4P,mBACL,sDASQ5P,KAAKmQ,eACN,GACDnQ,KAAKoQ,iBAQNpQ,KAAK4B,KAAKsB,SACjB,2DAIUlD,KAAK8P,SACR9P,KAAKqQ,eACGrQ,KAAKgQ,cAKbhQ,KAAK4B,KAAKsB,SACjB,2DAIUlD,KAAK8P,SACR9P,KAAKsQ,gBACGtQ,KAAKgQ,cAGG,WAArBhQ,KAAKuQ,YACHvQ,KAAK4B,KAAKsB,SACR,kEAEFlD,KAAK4B,KAAKsB,SACR,gEAQNlD,KAAK4B,KAAKsB,SACV,6DAKUlD,KAAKwQ,iBACGxQ,KAAKyQ,mBAEqBzQ,KAAK8P,SAC/C9P,KAAK4B,KAAKsB,SACV,oEAGElD,KAAK4B,KAAKsB,SACV,gEAI0ClD,KAAK8P,SACjD9P,KAAK4B,KAAKsB,SACV,sEAGElD,KAAK4B,KAAKsB,SACV,kEAQalD,KAAK0Q,MAAmB1Q,KAAK8P,SAC9C9P,KAAK4P,mBACL,0FAOV,SAAuBnF,GAAc,IAAAgB,EAAAzL,KACnC0K,EAAAC,EA7JEgF,EA6JF/E,WAAA,eAAA5K,MAAA6K,KAAA7K,KAAmByK,GACnBtK,WACE,kBAAMsL,EAAKJ,WAAYC,cAAc,eAAgBqF,SACrD,KAEF3Q,KAAK8L,iBAAiB,WAAY,SAACC,GACd,KAAfA,EAAG6E,SACLnF,EAAKiF,MAAM3E,KAGD/L,KAAKqL,WAAYC,cAC7B,mBAEIuF,aAAatI,YAAYyG,oDAGjC,WACE,YAAsBtP,IAAfM,KAAK8Q,MACR9Q,KAAK8Q,MACL9Q,KAAK4P,mBACH,uGAIR,WACE,OAAO5P,KAAK+Q,WAAarB,4CAG3B,WACE,YAA2BhQ,IAApBM,KAAKgR,WAA2BhR,KAAKgR,WAAa,2CAG3D,WACE,OAAOhR,KAAKiR,qDAGd,WACE,YAA4BvR,IAArBM,KAAKuQ,YAA4BvQ,KAAKuQ,YAAc,oDAG7D,SAAsBxE,GACpB,IAAM4B,EAAS5B,EAAGmF,cAClBlR,KAAA,IAAAgC,OAAS2L,EAAOxH,OAAUwH,EAAO6B,oDAGnC,SAAyBzD,GACvB/L,KAAK+Q,UAAYhF,EAAGmF,cAAc/G,yDAGpC,SACE4B,GAEA/L,KAAKuQ,YAAcxE,EAAGoF,OAAO3B,2CAG/B,eAAA7F,EAAA,OAAApC,mBAAAC,MAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,cACE3H,KAAK8P,UAAW,EADlBrI,EAAAC,KAAA,EAAAD,EAAAE,KAAA,EAAAJ,mBAAAO,MAGyBiH,YAAiB/O,KAAK4B,OAH/C,QAGU+H,EAHVlC,EAAAO,MAIeoJ,UAAYzH,EAAOwC,YAC5BnM,KAAK+Q,UAAY,CAACM,OAAO1H,EAAOyH,UAAWC,OAAO1H,EAAOwC,aAEvDxC,EAAO2H,YACTtR,KAAKgR,WAAaO,OAAO5H,EAAO2H,YAE9B3H,EAAO6H,cACTxR,KAAKuQ,YAAc5G,EAAO6H,aAExB7H,EAAO8H,YACTzR,KAAKiR,UAAYtH,EAAO8H,WAd9BhK,EAAAE,KAAA,iBAAAF,EAAAC,KAAA,GAAAD,EAAAiK,GAAAjK,EAAA,SAiBIkK,MAAK,0CAAA3P,OAA2CyF,EAAAiK,GAAIE,UAjBxD,eAAAnK,EAAAC,KAAA,GAmBI1H,KAAK8P,UAAW,EAnBpBrI,EAAAoK,OAAA,6BAAApK,EAAAkB,SAAA,KAAA3I,KAAA,0DAuBA,WAAuB,IAAAsN,EAAAtN,KACrBA,KAAK4B,KACFE,QAAQ,OAAQ,6BAA8B,CAC7CD,QAAS,qBAEVc,KAAK,SAACmP,GACLxE,EAAKyE,cAAcD,EAAO1P,sDAIhC,SAAsBL,GACpB2C,YAAqB1E,KAAM,CACzBgS,eAAgBjQ,EAChBkQ,qBAAsB,kDAM1B,SAAoBlG,GAApB,IAAA5B,EAAA2H,EAAA,OAAAvK,mBAAAC,MAAA,SAAAuG,GAAA,cAAAA,EAAArG,KAAAqG,EAAApG,MAAA,cACEoE,EAAGmG,iBACHlS,KAAK8P,UAAW,EAFlB/B,EAAArG,KAAA,EAIUyC,EAAWnK,KAAKmQ,eAJ1BpC,EAAApG,KAAA,EAAAJ,mBAAAO,MAKUgH,YAAe9O,KAAK4B,KAAM,CAC9BuQ,cAAenS,KAAK+P,WACpBqB,SAAUjH,EAAS,GACnBgC,UAAWhC,EAAS,GACpBmH,UAAWD,OAAOrR,KAAKsQ,iBACvBkB,YAAaxR,KAAKwQ,iBAClBiB,UAAWzR,KAAKqQ,gBAAkB,SAXxC,cAAAtC,EAAApG,KAAA,EAAAJ,mBAAAO,MAayBsK,YAAsBpS,KAAK4B,OAbpD,OAaUkQ,EAbV/D,EAAA/F,KAcI3D,YAAUrE,KAAM,kBAAmB,CACjCmC,KAAM,cACN2P,WAhBN/D,EAAApG,KAAA,iBAAAoG,EAAArG,KAAA,GAAAqG,EAAA2D,GAAA3D,EAAA,SAmBI/N,KAAK8P,UAAW,EAChB6B,MAAK,mBAAA3P,OAAoB+L,EAAA2D,GAAIE,UApBjC,yBAAA7D,EAAApF,SAAA,KAAA3I,KAAA,qDAwBA,WACE,OAAO4O,YAAP5I,UAvR+B6I","file":"chunk.87b3d715f3a2133fce74.js","sourcesContent":["// From: https://davidwalsh.name/javascript-debounce-function\n\n// Returns a function, that, as long as it continues to be invoked, will not\n// be triggered. The function will be called after it stops being called for\n// N milliseconds. If `immediate` is passed, trigger the function on the\n// leading edge, instead of the trailing.\n// tslint:disable-next-line: ban-types\nexport const debounce = <T extends Function>(\n  func: T,\n  wait,\n  immediate = false\n): T => {\n  let timeout;\n  // @ts-ignore\n  return function(...args) {\n    // tslint:disable:no-this-assignment\n    // @ts-ignore\n    const context = this;\n    const later = () => {\n      timeout = null;\n      if (!immediate) {\n        func.apply(context, args);\n      }\n    };\n    const callNow = immediate && !timeout;\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n    if (callNow) {\n      func.apply(context, args);\n    }\n  };\n};\n","export const compare = (a: string, b: string) => {\n  if (a < b) {\n    return -1;\n  }\n  if (a > b) {\n    return 1;\n  }\n\n  return 0;\n};\n\nexport const caseInsensitiveCompare = (a: string, b: string) =>\n  compare(a.toLowerCase(), b.toLowerCase());\n","export const afterNextRender = (cb: () => void): void => {\n  requestAnimationFrame(() => setTimeout(cb, 0));\n};\n\nexport const nextRender = () => {\n  return new Promise((resolve) => {\n    afterNextRender(resolve);\n  });\n};\n","import { HomeAssistant } from \"../types\";\nimport { DataEntryFlowStep, DataEntryFlowProgress } from \"./data_entry_flow\";\nimport { debounce } from \"../common/util/debounce\";\nimport { getCollection, Connection } from \"home-assistant-js-websocket\";\nimport { LocalizeFunc } from \"../common/translations/localize\";\n\nexport const DISCOVERY_SOURCES = [\"unignore\", \"homekit\", \"ssdp\", \"zeroconf\"];\n\nexport const createConfigFlow = (hass: HomeAssistant, handler: string) =>\n  hass.callApi<DataEntryFlowStep>(\"POST\", \"config/config_entries/flow\", {\n    handler,\n  });\n\nexport const fetchConfigFlow = (hass: HomeAssistant, flowId: string) =>\n  hass.callApi<DataEntryFlowStep>(\n    \"GET\",\n    `config/config_entries/flow/${flowId}`\n  );\n\nexport const handleConfigFlowStep = (\n  hass: HomeAssistant,\n  flowId: string,\n  data: { [key: string]: any }\n) =>\n  hass.callApi<DataEntryFlowStep>(\n    \"POST\",\n    `config/config_entries/flow/${flowId}`,\n    data\n  );\n\nexport const ignoreConfigFlow = (hass: HomeAssistant, flowId: string) =>\n  hass.callWS({ type: \"config_entries/ignore_flow\", flow_id: flowId });\n\nexport const deleteConfigFlow = (hass: HomeAssistant, flowId: string) =>\n  hass.callApi(\"DELETE\", `config/config_entries/flow/${flowId}`);\n\nexport const getConfigFlowHandlers = (hass: HomeAssistant) =>\n  hass.callApi<string[]>(\"GET\", \"config/config_entries/flow_handlers\");\n\nconst fetchConfigFlowInProgress = (conn) =>\n  conn.sendMessagePromise({\n    type: \"config_entries/flow/progress\",\n  });\n\nconst subscribeConfigFlowInProgressUpdates = (conn, store) =>\n  conn.subscribeEvents(\n    debounce(\n      () =>\n        fetchConfigFlowInProgress(conn).then((flows) =>\n          store.setState(flows, true)\n        ),\n      500,\n      true\n    ),\n    \"config_entry_discovered\"\n  );\n\nexport const getConfigFlowInProgressCollection = (conn: Connection) =>\n  getCollection<DataEntryFlowProgress[]>(\n    conn,\n    \"_configFlowProgress\",\n    fetchConfigFlowInProgress,\n    subscribeConfigFlowInProgressUpdates\n  );\n\nexport const subscribeConfigFlowInProgress = (\n  hass: HomeAssistant,\n  onChange: (flows: DataEntryFlowProgress[]) => void\n) => getConfigFlowInProgressCollection(hass.connection).subscribe(onChange);\n\nexport const localizeConfigFlowTitle = (\n  localize: LocalizeFunc,\n  flow: DataEntryFlowProgress\n) => {\n  const placeholders = flow.context.title_placeholders || {};\n  const placeholderKeys = Object.keys(placeholders);\n  if (placeholderKeys.length === 0) {\n    return localize(`component.${flow.handler}.config.title`);\n  }\n  const args: string[] = [];\n  placeholderKeys.forEach((key) => {\n    args.push(key);\n    args.push(placeholders[key]);\n  });\n  return localize(`component.${flow.handler}.config.flow_title`, ...args);\n};\n","import { TemplateResult } from \"lit-html\";\nimport { fireEvent } from \"../../common/dom/fire_event\";\nimport { HomeAssistant } from \"../../types\";\nimport {\n  DataEntryFlowStepCreateEntry,\n  DataEntryFlowStepExternal,\n  DataEntryFlowStepForm,\n  DataEntryFlowStep,\n  DataEntryFlowStepAbort,\n  FieldSchema,\n} from \"../../data/data_entry_flow\";\n\nexport interface FlowConfig {\n  loadDevicesAndAreas: boolean;\n\n  getFlowHandlers?: (hass: HomeAssistant) => Promise<string[]>;\n\n  createFlow(hass: HomeAssistant, handler: string): Promise<DataEntryFlowStep>;\n\n  fetchFlow(hass: HomeAssistant, flowId: string): Promise<DataEntryFlowStep>;\n\n  handleFlowStep(\n    hass: HomeAssistant,\n    flowId: string,\n    data: { [key: string]: any }\n  ): Promise<DataEntryFlowStep>;\n\n  deleteFlow(hass: HomeAssistant, flowId: string): Promise<unknown>;\n\n  renderAbortDescription(\n    hass: HomeAssistant,\n    step: DataEntryFlowStepAbort\n  ): TemplateResult | \"\";\n\n  renderShowFormStepHeader(\n    hass: HomeAssistant,\n    step: DataEntryFlowStepForm\n  ): string;\n\n  renderShowFormStepDescription(\n    hass: HomeAssistant,\n    step: DataEntryFlowStepForm\n  ): TemplateResult | \"\";\n\n  renderShowFormStepFieldLabel(\n    hass: HomeAssistant,\n    step: DataEntryFlowStepForm,\n    field: FieldSchema\n  ): string;\n\n  renderShowFormStepFieldError(\n    hass: HomeAssistant,\n    step: DataEntryFlowStepForm,\n    error: string\n  ): string;\n\n  renderExternalStepHeader(\n    hass: HomeAssistant,\n    step: DataEntryFlowStepExternal\n  ): string;\n\n  renderExternalStepDescription(\n    hass: HomeAssistant,\n    step: DataEntryFlowStepExternal\n  ): TemplateResult | \"\";\n\n  renderCreateEntryDescription(\n    hass: HomeAssistant,\n    step: DataEntryFlowStepCreateEntry\n  ): TemplateResult | \"\";\n}\n\nexport interface DataEntryFlowDialogParams {\n  startFlowHandler?: string;\n  continueFlowId?: string;\n  dialogClosedCallback?: (params: { flowFinished: boolean }) => void;\n  flowConfig: FlowConfig;\n  showAdvanced?: boolean;\n}\n\nexport const loadDataEntryFlowDialog = () =>\n  import(/* webpackChunkName: \"dialog-config-flow\" */ \"./dialog-data-entry-flow\");\n\nexport const showFlowDialog = (\n  element: HTMLElement,\n  dialogParams: Omit<DataEntryFlowDialogParams, \"flowConfig\">,\n  flowConfig: FlowConfig\n): void => {\n  fireEvent(element, \"show-dialog\", {\n    dialogTag: \"dialog-data-entry-flow\",\n    dialogImport: loadDataEntryFlowDialog,\n    dialogParams: {\n      ...dialogParams,\n      flowConfig,\n    },\n  });\n};\n","import {\n  getConfigFlowHandlers,\n  fetchConfigFlow,\n  handleConfigFlowStep,\n  deleteConfigFlow,\n  createConfigFlow,\n} from \"../../data/config_flow\";\nimport { html } from \"lit-element\";\nimport { localizeKey } from \"../../common/translations/localize\";\nimport {\n  showFlowDialog,\n  DataEntryFlowDialogParams,\n  loadDataEntryFlowDialog,\n} from \"./show-dialog-data-entry-flow\";\nimport { caseInsensitiveCompare } from \"../../common/string/compare\";\n\nexport const loadConfigFlowDialog = loadDataEntryFlowDialog;\n\nexport const showConfigFlowDialog = (\n  element: HTMLElement,\n  dialogParams: Omit<DataEntryFlowDialogParams, \"flowConfig\">\n): void =>\n  showFlowDialog(element, dialogParams, {\n    loadDevicesAndAreas: true,\n    getFlowHandlers: (hass) =>\n      getConfigFlowHandlers(hass).then((handlers) =>\n        handlers.sort((handlerA, handlerB) =>\n          caseInsensitiveCompare(\n            hass.localize(`component.${handlerA}.config.title`),\n            hass.localize(`component.${handlerB}.config.title`)\n          )\n        )\n      ),\n    createFlow: createConfigFlow,\n    fetchFlow: fetchConfigFlow,\n    handleFlowStep: handleConfigFlowStep,\n    deleteFlow: deleteConfigFlow,\n\n    renderAbortDescription(hass, step) {\n      const description = localizeKey(\n        hass.localize,\n        `component.${step.handler}.config.abort.${step.reason}`,\n        step.description_placeholders\n      );\n\n      return description\n        ? html`\n            <ha-markdown allowsvg .content=${description}></ha-markdown>\n          `\n        : \"\";\n    },\n\n    renderShowFormStepHeader(hass, step) {\n      return hass.localize(\n        `component.${step.handler}.config.step.${step.step_id}.title`\n      );\n    },\n\n    renderShowFormStepDescription(hass, step) {\n      const description = localizeKey(\n        hass.localize,\n        `component.${step.handler}.config.step.${step.step_id}.description`,\n        step.description_placeholders\n      );\n      return description\n        ? html`\n            <ha-markdown allowsvg .content=${description}></ha-markdown>\n          `\n        : \"\";\n    },\n\n    renderShowFormStepFieldLabel(hass, step, field) {\n      return hass.localize(\n        `component.${step.handler}.config.step.${step.step_id}.data.${\n          field.name\n        }`\n      );\n    },\n\n    renderShowFormStepFieldError(hass, step, error) {\n      return hass.localize(`component.${step.handler}.config.error.${error}`);\n    },\n\n    renderExternalStepHeader(hass, step) {\n      return hass.localize(\n        `component.${step.handler}.config.step.${step.step_id}.title`\n      );\n    },\n\n    renderExternalStepDescription(hass, step) {\n      const description = localizeKey(\n        hass.localize,\n        `component.${step.handler}.config.${step.step_id}.description`,\n        step.description_placeholders\n      );\n\n      return html`\n        <p>\n          ${hass.localize(\n            \"ui.panel.config.integrations.config_flow.external_step.description\"\n          )}\n        </p>\n        ${description\n          ? html`\n              <ha-markdown allowsvg .content=${description}></ha-markdown>\n            `\n          : \"\"}\n      `;\n    },\n\n    renderCreateEntryDescription(hass, step) {\n      const description = localizeKey(\n        hass.localize,\n        `component.${step.handler}.config.create_entry.${step.description ||\n          \"default\"}`,\n        step.description_placeholders\n      );\n\n      return html`\n        ${description\n          ? html`\n              <ha-markdown allowsvg .content=${description}></ha-markdown>\n            `\n          : \"\"}\n        <p>\n          ${hass.localize(\n            \"ui.panel.config.integrations.config_flow.created_config\",\n            \"name\",\n            step.title\n          )}\n        </p>\n      `;\n    },\n  });\n","import { Map } from \"leaflet\";\n\n// Sets up a Leaflet map on the provided DOM element\nexport type LeafletModuleType = typeof import(\"leaflet\");\nexport type LeafletDrawModuleType = typeof import(\"leaflet-draw\");\n\nexport const setupLeafletMap = async (\n  mapElement: HTMLElement,\n  darkMode = false,\n  draw = false\n): Promise<[Map, LeafletModuleType]> => {\n  if (!mapElement.parentNode) {\n    throw new Error(\"Cannot setup Leaflet map on disconnected element\");\n  }\n  // tslint:disable-next-line\n  const Leaflet = (await import(\n    /* webpackChunkName: \"leaflet\" */ \"leaflet\"\n  )) as LeafletModuleType;\n  Leaflet.Icon.Default.imagePath = \"/static/images/leaflet/images/\";\n\n  if (draw) {\n    await import(/* webpackChunkName: \"leaflet-draw\" */ \"leaflet-draw\");\n  }\n\n  const map = Leaflet.map(mapElement);\n  const style = document.createElement(\"link\");\n  style.setAttribute(\"href\", \"/static/images/leaflet/leaflet.css\");\n  style.setAttribute(\"rel\", \"stylesheet\");\n  mapElement.parentNode.appendChild(style);\n  map.setView([52.3731339, 4.8903147], 13);\n  createTileLayer(Leaflet, darkMode).addTo(map);\n\n  return [map, Leaflet];\n};\n\nexport const createTileLayer = (\n  leaflet: LeafletModuleType,\n  darkMode: boolean\n) => {\n  return leaflet.tileLayer(\n    `https://{s}.basemaps.cartocdn.com/${\n      darkMode ? \"dark_all\" : \"light_all\"\n    }/{z}/{x}/{y}${leaflet.Browser.retina ? \"@2x.png\" : \".png\"}`,\n    {\n      attribution:\n        '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a>, &copy; <a href=\"https://carto.com/attributions\">CARTO</a>',\n      subdomains: \"abcd\",\n      minZoom: 0,\n      maxZoom: 20,\n    }\n  );\n};\n","import { HomeAssistant } from \"../types\";\n\nexport const defaultRadiusColor = \"#FF9800\";\nexport const homeRadiusColor: string = \"#03a9f4\";\nexport const passiveRadiusColor: string = \"#9b9b9b\";\n\nexport interface Zone {\n  id: string;\n  name: string;\n  icon?: string;\n  latitude: number;\n  longitude: number;\n  passive?: boolean;\n  radius?: number;\n}\n\nexport interface ZoneMutableParams {\n  icon: string;\n  latitude: number;\n  longitude: number;\n  name: string;\n  passive: boolean;\n  radius: number;\n}\n\nexport const fetchZones = (hass: HomeAssistant) =>\n  hass.callWS<Zone[]>({ type: \"zone/list\" });\n\nexport const createZone = (hass: HomeAssistant, values: ZoneMutableParams) =>\n  hass.callWS<Zone>({\n    type: \"zone/create\",\n    ...values,\n  });\n\nexport const updateZone = (\n  hass: HomeAssistant,\n  zoneId: string,\n  updates: Partial<ZoneMutableParams>\n) =>\n  hass.callWS<Zone>({\n    type: \"zone/update\",\n    zone_id: zoneId,\n    ...updates,\n  });\n\nexport const deleteZone = (hass: HomeAssistant, zoneId: string) =>\n  hass.callWS({\n    type: \"zone/delete\",\n    zone_id: zoneId,\n  });\n","import {\n  LitElement,\n  property,\n  TemplateResult,\n  html,\n  CSSResult,\n  css,\n  customElement,\n  PropertyValues,\n} from \"lit-element\";\nimport {\n  Marker,\n  Map,\n  LeafletMouseEvent,\n  DragEndEvent,\n  LatLng,\n  Circle,\n  DivIcon,\n} from \"leaflet\";\nimport {\n  setupLeafletMap,\n  LeafletModuleType,\n} from \"../../common/dom/setup-leaflet-map\";\nimport { fireEvent } from \"../../common/dom/fire_event\";\nimport { nextRender } from \"../../common/util/render-status\";\nimport { defaultRadiusColor } from \"../../data/zone\";\n\n@customElement(\"ha-location-editor\")\nclass LocationEditor extends LitElement {\n  @property() public location?: [number, number];\n  @property() public radius?: number;\n  @property() public radiusColor?: string;\n  @property() public icon?: string;\n  public fitZoom = 16;\n  private _iconEl?: DivIcon;\n  private _ignoreFitToMap?: [number, number];\n\n  // tslint:disable-next-line\n  private Leaflet?: LeafletModuleType;\n  private _leafletMap?: Map;\n  private _locationMarker?: Marker | Circle;\n\n  public fitMap(): void {\n    if (!this._leafletMap || !this.location) {\n      return;\n    }\n    if ((this._locationMarker as Circle).getBounds) {\n      this._leafletMap.fitBounds((this._locationMarker as Circle).getBounds());\n    } else {\n      this._leafletMap.setView(this.location, this.fitZoom);\n    }\n    this._ignoreFitToMap = this.location;\n  }\n\n  protected render(): TemplateResult {\n    return html`\n      <div id=\"map\"></div>\n    `;\n  }\n\n  protected firstUpdated(changedProps: PropertyValues): void {\n    super.firstUpdated(changedProps);\n    this._initMap();\n  }\n\n  protected updated(changedProps: PropertyValues): void {\n    super.updated(changedProps);\n\n    // Still loading.\n    if (!this.Leaflet) {\n      return;\n    }\n\n    if (changedProps.has(\"location\")) {\n      this._updateMarker();\n      if (\n        this.location &&\n        (!this._ignoreFitToMap ||\n          this._ignoreFitToMap[0] !== this.location[0] ||\n          this._ignoreFitToMap[1] !== this.location[1])\n      ) {\n        this.fitMap();\n      }\n    }\n    if (changedProps.has(\"radius\")) {\n      this._updateRadius();\n    }\n    if (changedProps.has(\"radiusColor\")) {\n      this._updateRadiusColor();\n    }\n    if (changedProps.has(\"icon\")) {\n      this._updateIcon();\n    }\n  }\n\n  private get _mapEl(): HTMLDivElement {\n    return this.shadowRoot!.querySelector(\"div\")!;\n  }\n\n  private async _initMap(): Promise<void> {\n    [this._leafletMap, this.Leaflet] = await setupLeafletMap(\n      this._mapEl,\n      false,\n      Boolean(this.radius)\n    );\n    this._leafletMap.addEventListener(\n      \"click\",\n      // @ts-ignore\n      (ev: LeafletMouseEvent) => this._locationUpdated(ev.latlng)\n    );\n    this._updateIcon();\n    this._updateMarker();\n    this.fitMap();\n    this._leafletMap.invalidateSize();\n  }\n\n  private _locationUpdated(latlng: LatLng) {\n    let longitude = latlng.lng;\n    if (Math.abs(longitude) > 180.0) {\n      // Normalize longitude if map provides values beyond -180 to +180 degrees.\n      longitude = (((longitude % 360.0) + 540.0) % 360.0) - 180.0;\n    }\n    this.location = this._ignoreFitToMap = [latlng.lat, longitude];\n    fireEvent(this, \"change\", undefined, { bubbles: false });\n  }\n\n  private _radiusUpdated() {\n    this._ignoreFitToMap = this.location;\n    this.radius = (this._locationMarker as Circle).getRadius();\n    fireEvent(this, \"change\", undefined, { bubbles: false });\n  }\n\n  private _updateIcon() {\n    if (!this.icon) {\n      this._iconEl = undefined;\n      return;\n    }\n\n    // create icon\n    let iconHTML = \"\";\n    const el = document.createElement(\"ha-icon\");\n    el.setAttribute(\"icon\", this.icon);\n    iconHTML = el.outerHTML;\n\n    this._iconEl = this.Leaflet!.divIcon({\n      html: iconHTML,\n      iconSize: [24, 24],\n      className: \"light leaflet-edit-move\",\n    });\n    this._setIcon();\n  }\n\n  private _setIcon() {\n    if (!this._locationMarker || !this._iconEl) {\n      return;\n    }\n\n    if (!this.radius) {\n      (this._locationMarker as Marker).setIcon(this._iconEl);\n      return;\n    }\n\n    // @ts-ignore\n    const moveMarker = this._locationMarker.editing._moveMarker;\n    moveMarker.setIcon(this._iconEl);\n  }\n\n  private _setupEdit() {\n    // @ts-ignore\n    this._locationMarker.editing.enable();\n    // @ts-ignore\n    const moveMarker = this._locationMarker.editing._moveMarker;\n    // @ts-ignore\n    const resizeMarker = this._locationMarker.editing._resizeMarkers[0];\n    this._setIcon();\n    moveMarker.addEventListener(\n      \"dragend\",\n      // @ts-ignore\n      (ev: DragEndEvent) => this._locationUpdated(ev.target.getLatLng())\n    );\n    resizeMarker.addEventListener(\n      \"dragend\",\n      // @ts-ignore\n      (ev: DragEndEvent) => this._radiusUpdated(ev)\n    );\n  }\n\n  private async _updateMarker(): Promise<void> {\n    if (!this.location) {\n      if (this._locationMarker) {\n        this._locationMarker.remove();\n        this._locationMarker = undefined;\n      }\n      return;\n    }\n\n    if (this._locationMarker) {\n      this._locationMarker.setLatLng(this.location);\n      if (this.radius) {\n        // @ts-ignore\n        this._locationMarker.editing.disable();\n        await nextRender();\n        this._setupEdit();\n      }\n      return;\n    }\n\n    if (!this.radius) {\n      this._locationMarker = this.Leaflet!.marker(this.location, {\n        draggable: true,\n      });\n      this._setIcon();\n      this._locationMarker.addEventListener(\n        \"dragend\",\n        // @ts-ignore\n        (ev: DragEndEvent) => this._locationUpdated(ev.target.getLatLng())\n      );\n      this._leafletMap!.addLayer(this._locationMarker);\n    } else {\n      this._locationMarker = this.Leaflet!.circle(this.location, {\n        color: this.radiusColor || defaultRadiusColor,\n        radius: this.radius,\n      });\n      this._leafletMap!.addLayer(this._locationMarker);\n      this._setupEdit();\n    }\n  }\n\n  private _updateRadius(): void {\n    if (!this._locationMarker || !this.radius) {\n      return;\n    }\n    (this._locationMarker as Circle).setRadius(this.radius);\n  }\n\n  private _updateRadiusColor(): void {\n    if (!this._locationMarker || !this.radius) {\n      return;\n    }\n    (this._locationMarker as Circle).setStyle({ color: this.radiusColor });\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        display: block;\n        height: 300px;\n      }\n      #map {\n        height: 100%;\n      }\n      .light {\n        color: #000000;\n      }\n      .leaflet-edit-move {\n        border-radius: 50%;\n        cursor: move !important;\n      }\n      .leaflet-edit-resize {\n        border-radius: 50%;\n        cursor: nesw-resize !important;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-location-editor\": LocationEditor;\n  }\n}\n","import { HomeAssistant } from \"../types\";\nimport { HassConfig } from \"home-assistant-js-websocket\";\n\nexport interface ConfigUpdateValues {\n  location_name: string;\n  latitude: number;\n  longitude: number;\n  elevation: number;\n  unit_system: \"metric\" | \"imperial\";\n  time_zone: string;\n}\n\nexport const saveCoreConfig = (\n  hass: HomeAssistant,\n  values: Partial<ConfigUpdateValues>\n) =>\n  hass.callWS<HassConfig>({\n    type: \"config/core/update\",\n    ...values,\n  });\n\nexport const detectCoreConfig = (hass: HomeAssistant) =>\n  hass.callWS<Partial<ConfigUpdateValues>>({\n    type: \"config/core/detect\",\n  });\n","import timezones from \"google-timezones-json\";\n\nexport const createTimezoneListEl = () => {\n  const list = document.createElement(\"datalist\");\n  list.id = \"timezones\";\n  Object.keys(timezones).forEach((key) => {\n    const option = document.createElement(\"option\");\n    option.value = key;\n    option.innerHTML = timezones[key];\n    list.appendChild(option);\n  });\n  return list;\n};\n","import \"web-animations-js/web-animations-next-lite.min\";\nimport {\n  LitElement,\n  customElement,\n  property,\n  TemplateResult,\n  html,\n  CSSResult,\n  css,\n} from \"lit-element\";\nimport \"@material/mwc-button/mwc-button\";\nimport \"@polymer/paper-input/paper-input\";\nimport \"@polymer/paper-radio-group/paper-radio-group\";\nimport \"@polymer/paper-radio-button/paper-radio-button\";\nimport \"@polymer/paper-listbox/paper-listbox\";\n// tslint:disable-next-line: no-duplicate-imports\nimport { PaperInputElement } from \"@polymer/paper-input/paper-input\";\nimport { HomeAssistant } from \"../types\";\nimport {\n  ConfigUpdateValues,\n  detectCoreConfig,\n  saveCoreConfig,\n} from \"../data/core\";\nimport { showConfigFlowDialog } from \"../dialogs/config-flow/show-dialog-config-flow\";\nimport { PolymerChangedEvent } from \"../polymer-types\";\nimport { onboardCoreConfigStep } from \"../data/onboarding\";\nimport { fireEvent } from \"../common/dom/fire_event\";\nimport { LocalizeFunc } from \"../common/translations/localize\";\nimport { createTimezoneListEl } from \"../components/timezone-datalist\";\nimport \"../components/map/ha-location-editor\";\n\nconst amsterdam = [52.069521, 19.480343];\n\n@customElement(\"onboarding-core-config\")\nclass OnboardingCoreConfig extends LitElement {\n  @property() public hass!: HomeAssistant;\n  @property() public onboardingLocalize!: LocalizeFunc;\n\n  @property() private _working = false;\n\n  @property() private _name!: ConfigUpdateValues[\"location_name\"];\n  @property() private _location!: [number, number];\n  @property() private _elevation!: string;\n  @property() private _unitSystem!: ConfigUpdateValues[\"unit_system\"];\n  @property() private _timeZone!: string;\n\n  protected render(): TemplateResult {\n    return html`\n      <p>\n        ${this.onboardingLocalize(\n          \"ui.panel.page-onboarding.core-config.intro\",\n          \"name\",\n          this.hass.user!.name\n        )}\n      </p>\n\n      <paper-input\n        .label=${this.onboardingLocalize(\n          \"ui.panel.page-onboarding.core-config.location_name\"\n        )}\n        name=\"name\"\n        .disabled=${this._working}\n        .value=${this._nameValue}\n        @value-changed=${this._handleChange}\n      ></paper-input>\n\n      <div class=\"middle-text\">\n        <p>\n          ${this.onboardingLocalize(\n            \"ui.panel.page-onboarding.core-config.intro_location\"\n          )}\n        </p>\n        <div class=\"row\">\n          <div>\n            ${this.onboardingLocalize(\n              \"ui.panel.page-onboarding.core-config.intro_location_detect\"\n            )}\n            Do tego jest potrzebne połączenie z Internetem.\n          </div>\n          <mwc-button @click=${this._connectWifi}>\n            POŁĄCZ Z WIFI\n          </mwc-button>\n        </div>\n\n        <div class=\"row\">\n          <div>\n            Ustal swoją lokalizację po adresie IP wysyłając jednorazowe\n            zapytanie do serwisu\n            <span style=\"font-weight: bold;\" @click=${this._detect}\n              >ipapi.co</span\n            >\n          </div>\n          <mwc-button @click=${this._detect}>\n            ${this.onboardingLocalize(\n              \"ui.panel.page-onboarding.core-config.button_detect\"\n            )}\n          </mwc-button>\n        </div>\n      </div>\n\n      <div class=\"row\">\n        <ha-location-editor\n          class=\"flex\"\n          .location=${this._locationValue}\n          .fitZoom=${14}\n          @change=${this._locationChanged}\n          style=\"z-index:100\"\n        ></ha-location-editor>\n      </div>\n\n      <div class=\"row\">\n        <paper-input\n          class=\"flex\"\n          .label=${this.hass.localize(\n            \"ui.panel.config.core.section.core.core_config.time_zone\"\n          )}\n          name=\"timeZone\"\n          list=\"timezones\"\n          .disabled=${this._working}\n          .value=${this._timeZoneValue}\n          @value-changed=${this._handleChange}\n        ></paper-input>\n\n        <paper-input\n          class=\"flex\"\n          .label=${this.hass.localize(\n            \"ui.panel.config.core.section.core.core_config.elevation\"\n          )}\n          name=\"elevation\"\n          type=\"number\"\n          .disabled=${this._working}\n          .value=${this._elevationValue}\n          @value-changed=${this._handleChange}\n        >\n          <span slot=\"suffix\">\n            ${this._unitSystem === \"metric\"\n              ? this.hass.localize(\n                  \"ui.panel.config.core.section.core.core_config.elevation_meters\"\n                )\n              : this.hass.localize(\n                  \"ui.panel.config.core.section.core.core_config.elevation_feet\"\n                )}\n          </span>\n        </paper-input>\n      </div>\n\n      <div class=\"row\">\n        <div class=\"flex\">\n          ${this.hass.localize(\n            \"ui.panel.config.core.section.core.core_config.unit_system\"\n          )}\n        </div>\n        <paper-radio-group\n          class=\"flex\"\n          .selected=${this._unitSystemValue}\n          @selected-changed=${this._unitSystemChanged}\n        >\n          <paper-radio-button name=\"metric\" .disabled=${this._working}>\n            ${this.hass.localize(\n              \"ui.panel.config.core.section.core.core_config.unit_system_metric\"\n            )}\n            <div class=\"secondary\">\n              ${this.hass.localize(\n                \"ui.panel.config.core.section.core.core_config.metric_example\"\n              )}\n            </div>\n          </paper-radio-button>\n          <paper-radio-button name=\"imperial\" .disabled=${this._working}>\n            ${this.hass.localize(\n              \"ui.panel.config.core.section.core.core_config.unit_system_imperial\"\n            )}\n            <div class=\"secondary\">\n              ${this.hass.localize(\n                \"ui.panel.config.core.section.core.core_config.imperial_example\"\n              )}\n            </div>\n          </paper-radio-button>\n        </paper-radio-group>\n      </div>\n\n      <div class=\"footer\">\n        <mwc-button @click=${this._save} .disabled=${this._working}>\n          ${this.onboardingLocalize(\n            \"ui.panel.page-onboarding.core-config.finish\"\n          )}\n        </mwc-button>\n      </div>\n    `;\n  }\n\n  protected firstUpdated(changedProps) {\n    super.firstUpdated(changedProps);\n    setTimeout(\n      () => this.shadowRoot!.querySelector(\"paper-input\")!.focus(),\n      100\n    );\n    this.addEventListener(\"keypress\", (ev) => {\n      if (ev.keyCode === 13) {\n        this._save(ev);\n      }\n    });\n    const input = this.shadowRoot!.querySelector(\n      \"[name=timeZone]\"\n    ) as PaperInputElement;\n    input.inputElement.appendChild(createTimezoneListEl());\n  }\n\n  private get _nameValue() {\n    return this._name !== undefined\n      ? this._name\n      : this.onboardingLocalize(\n          \"ui.panel.page-onboarding.core-config.location_name_default\"\n        );\n  }\n\n  private get _locationValue() {\n    return this._location || amsterdam;\n  }\n\n  private get _elevationValue() {\n    return this._elevation !== undefined ? this._elevation : 0;\n  }\n\n  private get _timeZoneValue() {\n    return this._timeZone;\n  }\n\n  private get _unitSystemValue() {\n    return this._unitSystem !== undefined ? this._unitSystem : \"metric\";\n  }\n\n  private _handleChange(ev: PolymerChangedEvent<string>) {\n    const target = ev.currentTarget as PaperInputElement;\n    this[`_${target.name}`] = target.value;\n  }\n\n  private _locationChanged(ev) {\n    this._location = ev.currentTarget.location;\n  }\n\n  private _unitSystemChanged(\n    ev: PolymerChangedEvent<ConfigUpdateValues[\"unit_system\"]>\n  ) {\n    this._unitSystem = ev.detail.value;\n  }\n\n  private async _detect() {\n    this._working = true;\n    try {\n      const values = await detectCoreConfig(this.hass);\n      if (values.latitude && values.longitude) {\n        this._location = [Number(values.latitude), Number(values.longitude)];\n      }\n      if (values.elevation) {\n        this._elevation = String(values.elevation);\n      }\n      if (values.unit_system) {\n        this._unitSystem = values.unit_system;\n      }\n      if (values.time_zone) {\n        this._timeZone = values.time_zone;\n      }\n    } catch (err) {\n      alert(`Failed to detect location information: ${err.message}`);\n    } finally {\n      this._working = false;\n    }\n  }\n\n  private _connectWifi() {\n    this.hass\n      .callApi(\"POST\", \"config/config_entries/flow\", {\n        handler: \"ais_wifi_service\",\n      })\n      .then((result: any) => {\n        this._continueFlow(result.flow_id);\n      });\n  }\n\n  private _continueFlow(flowId) {\n    showConfigFlowDialog(this, {\n      continueFlowId: flowId,\n      dialogClosedCallback: () => {\n        return;\n      },\n    });\n  }\n\n  private async _save(ev) {\n    ev.preventDefault();\n    this._working = true;\n    try {\n      const location = this._locationValue;\n      await saveCoreConfig(this.hass, {\n        location_name: this._nameValue,\n        latitude: location[0],\n        longitude: location[1],\n        elevation: Number(this._elevationValue),\n        unit_system: this._unitSystemValue,\n        time_zone: this._timeZoneValue || \"UTC\",\n      });\n      const result = await onboardCoreConfigStep(this.hass);\n      fireEvent(this, \"onboarding-step\", {\n        type: \"core_config\",\n        result,\n      });\n    } catch (err) {\n      this._working = false;\n      alert(`Failed to save: ${err.message}`);\n    }\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      .row {\n        display: flex;\n        flex-direction: row;\n        margin: 0 -8px;\n        align-items: center;\n      }\n\n      .secondary {\n        color: var(--secondary-text-color);\n      }\n\n      .flex {\n        flex: 1;\n      }\n\n      .middle-text {\n        margin: 24px 0;\n      }\n\n      .row > * {\n        margin: 0 8px;\n      }\n      .footer {\n        margin-top: 16px;\n        text-align: right;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"onboarding-core-config\": OnboardingCoreConfig;\n  }\n}\n"],"sourceRoot":""}