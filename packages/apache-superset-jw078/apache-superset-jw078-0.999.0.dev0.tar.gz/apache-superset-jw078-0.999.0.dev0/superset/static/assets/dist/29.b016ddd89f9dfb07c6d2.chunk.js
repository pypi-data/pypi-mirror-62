(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{2737:function(t,e,a){"use strict";a.d(e,"a",function(){return s});var r=a(12),n=a.n(r),o=[1,0,1,0,0,0,0];function i(t,e){var a=parseInt(n()(e).format("x"),10);return parseInt(n()(e).add(t).format("x"),10)-a}function s(t,e){var a,r,s=n()(Math.min.apply(Math,t)),l=n()(Math.max.apply(Math,t));if(-1!==e.indexOf("/")){var u=e.split("/",2);u[0].endsWith("Z")?(r=n()(u[0]),a=n.a.duration(u[1])):(r=n()(u[1]),a=n.a.duration(u[0]))}else r=function(t,e){var a=n()(t).subtract(e),r=t.toArray(),i=a.toArray(),s=r.map(function(t,e){return i[e]!==t}).indexOf(!0),l=r.map(function(t,e){if(e===s){var a=t-i[e];return t-(t-o[e])%a}return e<s||-1===s?t:o[e]});return n()(l)}(s,a=n.a.duration(e));var p,c=s.valueOf();for(p=r.clone();p.valueOf()<c;)p.add(a);for(;p.valueOf()>c;)p.subtract(a);var d,f=l.valueOf();for(d=r.clone();d.valueOf()>f;)d.subtract(a);for(;d.valueOf()<f;)d.add(a);var h=null==e?[p,d]:[p,p.clone().add(a)],g=t.every(function(t){return null===t});return{start:parseInt(p.format("x"),10),end:parseInt(d.format("x"),10),getStep:i.bind(this,a),values:h.map(function(t){return parseInt(t.format("x"),10)}),disabled:g}}},2739:function(t,e,a){"use strict";var r=a(1),n=a.n(r),o=a(0),i=a.n(o),s=a(2736),l=a(1336),u=a.n(l),p=a(8),c=a(1881),d=a.n(c);a(2169),a(2741);function f(t){return n.a.createElement("span",{className:"BootstrapSliderWrapper"},n.a.createElement(d.a,t))}a(2742);function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var g={start:i.a.number.isRequired,step:i.a.number.isRequired,end:i.a.number.isRequired,values:i.a.array.isRequired,onChange:i.a.func,loopDuration:i.a.number,maxFrames:i.a.number,orientation:i.a.oneOf(["horizontal","vertical"]),reversed:i.a.bool,disabled:i.a.bool,range:i.a.bool},m=function(t){function e(e){var a;(a=t.call(this,e)||this).state={intervalId:null};var r=e.end-e.start,n=Math.min(e.maxFrames,r/e.step),o=r/n;return a.intervalMilliseconds=e.loopDuration/n,a.increment=o<e.step?e.step:o-o%e.step,a.onChange=a.onChange.bind(h(a)),a.play=a.play.bind(h(a)),a.pause=a.pause.bind(h(a)),a.stepBackward=a.stepBackward.bind(h(a)),a.stepForward=a.stepForward.bind(h(a)),a.getPlayClass=a.getPlayClass.bind(h(a)),a.formatter=a.formatter.bind(h(a)),a}!function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}(e,t);var a=e.prototype;return a.componentDidMount=function(){u.a.bind(["space"],this.play)},a.componentWillUnmount=function(){u.a.unbind(["space"])},a.onChange=function(t){this.props.onChange(t.target.value),null!=this.state.intervalId&&this.pause()},a.getPlayClass=function(){return null==this.state.intervalId?"fa fa-play fa-lg slider-button":"fa fa-pause fa-lg slider-button"},a.play=function(){if(!this.props.disabled)if(null!=this.state.intervalId)this.pause();else{var t=setInterval(this.stepForward,this.intervalMilliseconds);this.setState({intervalId:t})}},a.pause=function(){clearInterval(this.state.intervalId),this.setState({intervalId:null})},a.stepForward=function(){var t=this,e=this.props,a=e.start,r=e.end,n=e.step,o=e.values;if(!e.disabled){var i=(Array.isArray(o)?o:[o,o+n]).map(function(e){return e+t.increment}),s=i[1]>r?i[0]-a:0;this.props.onChange(i.map(function(t){return t-s}))}},a.stepBackward=function(){var t=this,e=this.props,a=e.start,r=e.end,n=e.step,o=e.values;if(!e.disabled){var i=(Array.isArray(o)?o:[o,o+n]).map(function(e){return e-t.increment}),s=i[0]<a?r-i[1]:0;this.props.onChange(i.map(function(t){return t+s}))}},a.formatter=function(t){if(this.props.disabled)return Object(p.b)("Data has no time steps");var e=t;return Array.isArray(t)?t[0]===t[1]&&(e=[t[0]]):e=[t],e.map(function(t){return new Date(t).toUTCString()}).join(" : ")},a.render=function(){var t=this.props,e=t.start,a=t.end,r=t.step,o=t.orientation,i=t.reversed,s=t.disabled,l=t.range,u=t.values;return n.a.createElement("div",{className:"play-slider"},n.a.createElement("div",{className:"play-slider-controls padded"},n.a.createElement("i",{className:"fa fa-step-backward fa-lg slider-button ",onClick:this.stepBackward}),n.a.createElement("i",{className:this.getPlayClass(),onClick:this.play}),n.a.createElement("i",{className:"fa fa-step-forward fa-lg slider-button ",onClick:this.stepForward})),n.a.createElement("div",{className:"play-slider-scrobbler padded"},n.a.createElement(f,{value:l?u:u[0],range:l,formatter:this.formatter,change:this.onChange,min:e,max:a,step:r,orientation:o,reversed:i,disabled:s?"disabled":"enabled"})))},e}(n.a.PureComponent);function b(){return(b=Object.assign||function(t){for(var e,a=1;a<arguments.length;a++)for(var r in e=arguments[a])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)}m.propTypes=g,m.defaultProps={onChange:function(){},loopDuration:15e3,maxFrames:100,orientation:"horizontal",reversed:!1,disabled:!1,range:!0},a.d(e,"a",function(){return y});var v={getLayers:i.a.func.isRequired,start:i.a.number.isRequired,end:i.a.number.isRequired,getStep:i.a.func,values:i.a.array.isRequired,aggregation:i.a.bool,disabled:i.a.bool,viewport:i.a.object.isRequired,children:i.a.node,mapStyle:i.a.string,mapboxApiAccessToken:i.a.string.isRequired,setControlValue:i.a.func,onViewportChange:i.a.func,onValuesChange:i.a.func},y=function(t){function e(e){var a;return(a=t.call(this,e)||this).onViewportChange=a.onViewportChange.bind(function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(a)),a}!function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}(e,t);var a=e.prototype;return a.onViewportChange=function(t){var e=this.props.disabled?b({},t):b({},t,{height:t.height+20});this.props.onViewportChange(e)},a.render=function(){var t=this.props,e=t.start,a=t.end,r=t.getStep,o=t.disabled,i=t.aggregation,l=t.children,u=t.getLayers,p=t.values,c=t.onValuesChange,d=t.viewport,f=t.setControlValue,h=t.mapStyle,g=t.mapboxApiAccessToken,v=u(p),y=b({},d,{height:o?d.height:d.height-20});return n.a.createElement("div",null,n.a.createElement(s.a,{viewport:y,layers:v,setControlValue:f,mapStyle:h,mapboxApiAccessToken:g,onViewportChange:this.onViewportChange}),!o&&n.a.createElement(m,{start:e,end:a,step:r(e),values:p,range:!i,onChange:c}),l)},e}(n.a.Component);y.propTypes=v,y.defaultProps={aggregation:!1,disabled:!1,mapStyle:"light",setControlValue:function(){},onViewportChange:function(){},onValuesChange:function(){}}},2741:function(t,e,a){},2742:function(t,e,a){},2743:function(t,e,a){"use strict";var r=a(1),n=a.n(r),o=a(0),i=a.n(o),s=a(1335),l=a(2736),u=a(179),p=a(2739),c=a(2744),d=a(2748),f=a(2737),h=a(2735),g=a(2725);function m(){return(m=Object.assign||function(t){for(var e,a=1;a<arguments.length;a++)for(var r in e=arguments[a])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)}function b(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var v=u.CategoricalColorNamespace.getScale;var y={formData:i.a.object.isRequired,mapboxApiKey:i.a.string.isRequired,setControlValue:i.a.func.isRequired,viewport:i.a.object.isRequired,getLayer:i.a.func.isRequired,getPoints:i.a.func.isRequired,payload:i.a.object.isRequired,onAddFilter:i.a.func,setTooltip:i.a.func},C=function(t){function e(e){var a;return(a=t.call(this,e)||this).state=a.getStateFromProps(e),a.getLayers=a.getLayers.bind(b(a)),a.onValuesChange=a.onValuesChange.bind(b(a)),a.onViewportChange=a.onViewportChange.bind(b(a)),a.toggleCategory=a.toggleCategory.bind(b(a)),a.showSingleCategory=a.showSingleCategory.bind(b(a)),a}!function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}(e,t);var a=e.prototype;return a.UNSAFE_componentWillReceiveProps=function(t){t.payload.form_data!==this.state.formData&&this.setState(m({},this.getStateFromProps(t)))},a.onValuesChange=function(t){this.setState({values:Array.isArray(t)?t:[t,t+this.state.getStep(t)]})},a.onViewportChange=function(t){this.setState({viewport:t})},a.getStateFromProps=function(t,e){var a=t.payload.data.features||[],r=a.map(function(t){return t.__timestamp}),n=function(t,e){var a=t.color_picker||{r:0,g:0,b:0,a:1},r=[a.r,a.g,a.b,255*a.a],n=v(t.color_scheme),o={};return e.forEach(function(e){var i;null==e.cat_color||o.hasOwnProperty(e.cat_color)||(i=t.dimension?Object(d.hexToRGB)(n(e.cat_color),255*a.a):r,o[e.cat_color]={color:i,enabled:!0})}),o}(t.formData,a);if(e&&t.payload.form_data===e.formData)return m({},e,{categories:n});var o=t.payload.form_data.time_grain_sqla||t.payload.form_data.granularity||"P1D",i=Object(f.a)(r,o);return{start:i.start,end:i.end,getStep:i.getStep,values:i.values,disabled:i.disabled,viewport:t.formData.autozoom?Object(g.b)(t.viewport,t.getPoints(a)):t.viewport,selected:[],lastClick:0,formData:t.payload.form_data,categories:n}},a.getLayers=function(t){var e=this.props,a=e.getLayer,r=e.payload,n=e.formData,o=e.onAddFilter,i=e.setTooltip,s=r.data.features?[].concat(r.data.features):[];(s=this.addColor(s,n),n.js_data_mutator)&&(s=Object(h.a)(n.js_data_mutator)(s));s=t[0]===t[1]||t[1]===this.end?s.filter(function(e){return e.__timestamp>=t[0]&&e.__timestamp<=t[1]}):s.filter(function(e){return e.__timestamp>=t[0]&&e.__timestamp<t[1]});var l=this.state.categories;return n.dimension&&(s=s.filter(function(t){return l[t.cat_color]&&l[t.cat_color].enabled})),[a(n,m({},r,{data:m({},r.data,{features:s})}),o,i)]},a.addColor=function(t,e){var a=e.color_picker||{r:0,g:0,b:0,a:1},r=v(e.color_scheme);return t.map(function(t){return e.dimension?m({},t,{color:Object(d.hexToRGB)(r(t.cat_color),255*a.a)}):t})},a.toggleCategory=function(t){var e,a=this.state.categories[t],r=m({},this.state.categories,((e={})[t]=m({},a,{enabled:!a.enabled}),e));Object.values(r).every(function(t){return!t.enabled})&&Object.values(r).forEach(function(t){t.enabled=!0}),this.setState({categories:r})},a.showSingleCategory=function(t){var e=m({},this.state.categories);Object.values(e).forEach(function(t){t.enabled=!1}),e[t].enabled=!0,this.setState({categories:e})},a.render=function(){return n.a.createElement("div",{style:{position:"relative"}},n.a.createElement(p.a,{getLayers:this.getLayers,start:this.state.start,end:this.state.end,getStep:this.state.getStep,values:this.state.values,onValuesChange:this.onValuesChange,disabled:this.state.disabled,viewport:this.state.viewport,onViewportChange:this.onViewportChange,mapboxApiAccessToken:this.props.mapboxApiKey,mapStyle:this.props.formData.mapbox_style,setControlValue:this.props.setControlValue},n.a.createElement(c.a,{categories:this.state.categories,toggleCategory:this.toggleCategory,showSingleCategory:this.showSingleCategory,position:this.props.formData.legend_position,format:this.props.formData.legend_format})))},e}(n.a.PureComponent);function w(){return(w=Object.assign||function(t){for(var e,a=1;a<arguments.length;a++)for(var r in e=arguments[a])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)}C.propTypes=y,a.d(e,"b",function(){return O}),a.d(e,"a",function(){return V});var _={formData:i.a.object.isRequired,payload:i.a.object.isRequired,setControlValue:i.a.func.isRequired,viewport:i.a.object.isRequired,onAddFilter:i.a.func,setTooltip:i.a.func},j={onAddFilter:function(){},setTooltip:function(){}};function O(t,e){var a=function(a){function r(t){var r=a.call(this,t)||this,n=t.viewport,o=t.formData.autozoom?Object(g.b)(n,e(t.payload.data.features)):n;return r.state={viewport:o,layer:r.computeLayer(t)},r.onViewportChange=r.onViewportChange.bind(function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(r)),r}!function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}(r,a);var o=r.prototype;return o.UNSAFE_componentWillReceiveProps=function(t){var e=w({},t.formData,{viewport:null}),a=w({},this.props.formData,{viewport:null});Object(s.isEqual)(e,a)&&t.payload===this.props.payload||this.setState({layer:this.computeLayer(t)})},o.onViewportChange=function(t){this.setState({viewport:t})},o.computeLayer=function(e){var a=e.formData,r=e.payload,n=e.onAddFilter,o=e.setTooltip;return t(a,r,n,o)},o.render=function(){var t=this.props,e=t.formData,a=t.payload,r=t.setControlValue,o=this.state,i=o.layer,s=o.viewport;return n.a.createElement(l.a,{mapboxApiAccessToken:a.data.mapboxApiKey,viewport:s,layers:[i],mapStyle:e.mapbox_style,setControlValue:r,onViewportChange:this.onViewportChange})},r}(n.a.PureComponent);return a.propTypes=_,a.defaultProps=j,a}function V(t,e){function a(a){var r=a.formData,o=a.payload,i=a.setControlValue,s=a.onAddFilter,l=a.setTooltip,u=a.viewport;return n.a.createElement(C,{formData:r,mapboxApiKey:o.data.mapboxApiKey,setControlValue:i,viewport:u,getLayer:t,payload:o,onAddFilter:s,setTooltip:l,getPoints:e})}return a.propTypes=_,a.defaultProps=j,a}},2744:function(t,e,a){"use strict";a.d(e,"a",function(){return u});var r=a(1),n=a.n(r),o=a(0),i=a.n(o),s=a(578);a(2745);var l={categories:i.a.object,toggleCategory:i.a.func,showSingleCategory:i.a.func,format:i.a.string,position:i.a.oneOf([null,"tl","tr","bl","br"])},u=function(t){function e(){return t.apply(this,arguments)||this}!function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}(e,t);var a=e.prototype;return a.format=function(t){if(!this.props.format)return t;var e=parseFloat(t);return Object(s.b)(this.props.format,e)},a.formatCategoryLabel=function(t){if(!this.props.format)return t;if(t.includes(" - ")){var e=t.split(" - ");return this.format(e[0])+" - "+this.format(e[1])}return this.format(t)},a.render=function(){var t,e=this;if(0===Object.keys(this.props.categories).length||null===this.props.position)return null;var a=Object.entries(this.props.categories).map(function(t){var a=t[0],r=t[1],o={color:"rgba("+r.color.join(", ")+")"},i=r.enabled?"◼":"◻";return n.a.createElement("li",{key:a},n.a.createElement("a",{href:"#",onClick:function(){return e.props.toggleCategory(a)},onDoubleClick:function(){return e.props.showSingleCategory(a)}},n.a.createElement("span",{style:o},i)," ",e.formatCategoryLabel(a)))}),r="t"===this.props.position.charAt(0)?"top":"bottom",o="r"===this.props.position.charAt(1)?"right":"left",i=((t={position:"absolute"})[r]="0px",t[o]="10px",t);return n.a.createElement("div",{className:"legend",style:i},n.a.createElement("ul",{className:"categories"},a))},e}(n.a.PureComponent);u.propTypes=l,u.defaultProps={categories:{},toggleCategory:function(){},showSingleCategory:function(){},format:null,position:"tr"}},2745:function(t,e,a){},2751:function(t,e){},2752:function(t,e){},2753:function(t,e){},2831:function(t,e,a){"use strict";a.r(e),a.d(e,"getLayer",function(){return f});var r=a(2738),n=a(1),o=a.n(n),i=a(8),s=a(2725),l=a(2735),u=a(2743),p=a(2740);function c(){return(c=Object.assign||function(t){for(var e,a=1;a<arguments.length;a++)for(var r in e=arguments[a])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)}function d(t){return o.a.createElement("div",{className:"deckgl-tooltip"},o.a.createElement(p.a,{label:Object(i.b)("Longitude and Latitude")+": ",value:t.object.position[0]+", "+t.object.position[1]}),o.a.createElement(p.a,{label:Object(i.b)("Height")+": ",value:""+t.object.elevationValue}))}function f(t,e,a,n){var o=t,i=o.color_picker,u=e.data.features.map(function(t){return c({},t,{color:[i.r,i.g,i.b,255*i.a]})});o.js_data_mutator&&(u=Object(l.a)(o.js_data_mutator)(u));var p=Object(s.c)(o.js_agg_function,function(t){return t.weight});return new r.c(c({id:"grid-layer-"+o.slice_id,data:u,pickable:!0,cellSize:o.grid_size,minColor:[0,0,0,0],extruded:o.extruded,maxColor:[i.r,i.g,i.b,255*i.a],outline:!1,getElevationValue:p,getColorValue:p},Object(s.a)(o,n,d)))}e.default=Object(u.b)(f,function(t){return t.map(function(t){return t.position})})}}]);