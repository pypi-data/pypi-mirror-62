(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{2737:function(e,t,a){"use strict";a.d(t,"a",function(){return s});var n=a(12),r=a.n(n),o=[1,0,1,0,0,0,0];function i(e,t){var a=parseInt(r()(t).format("x"),10);return parseInt(r()(t).add(e).format("x"),10)-a}function s(e,t){var a,n,s=r()(Math.min.apply(Math,e)),l=r()(Math.max.apply(Math,e));if(-1!==t.indexOf("/")){var u=t.split("/",2);u[0].endsWith("Z")?(n=r()(u[0]),a=r.a.duration(u[1])):(n=r()(u[1]),a=r.a.duration(u[0]))}else n=function(e,t){var a=r()(e).subtract(t),n=e.toArray(),i=a.toArray(),s=n.map(function(e,t){return i[t]!==e}).indexOf(!0),l=n.map(function(e,t){if(t===s){var a=e-i[t];return e-(e-o[t])%a}return t<s||-1===s?e:o[t]});return r()(l)}(s,a=r.a.duration(t));var p,c=s.valueOf();for(p=n.clone();p.valueOf()<c;)p.add(a);for(;p.valueOf()>c;)p.subtract(a);var d,f=l.valueOf();for(d=n.clone();d.valueOf()>f;)d.subtract(a);for(;d.valueOf()<f;)d.add(a);var h=null==t?[p,d]:[p,p.clone().add(a)],m=e.every(function(e){return null===e});return{start:parseInt(p.format("x"),10),end:parseInt(d.format("x"),10),getStep:i.bind(this,a),values:h.map(function(e){return parseInt(e.format("x"),10)}),disabled:m}}},2739:function(e,t,a){"use strict";var n=a(1),r=a.n(n),o=a(0),i=a.n(o),s=a(2736),l=a(1336),u=a.n(l),p=a(8),c=a(1881),d=a.n(c);a(2169),a(2741);function f(e){return r.a.createElement("span",{className:"BootstrapSliderWrapper"},r.a.createElement(d.a,e))}a(2742);function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var m={start:i.a.number.isRequired,step:i.a.number.isRequired,end:i.a.number.isRequired,values:i.a.array.isRequired,onChange:i.a.func,loopDuration:i.a.number,maxFrames:i.a.number,orientation:i.a.oneOf(["horizontal","vertical"]),reversed:i.a.bool,disabled:i.a.bool,range:i.a.bool},g=function(e){function t(t){var a;(a=e.call(this,t)||this).state={intervalId:null};var n=t.end-t.start,r=Math.min(t.maxFrames,n/t.step),o=n/r;return a.intervalMilliseconds=t.loopDuration/r,a.increment=o<t.step?t.step:o-o%t.step,a.onChange=a.onChange.bind(h(a)),a.play=a.play.bind(h(a)),a.pause=a.pause.bind(h(a)),a.stepBackward=a.stepBackward.bind(h(a)),a.stepForward=a.stepForward.bind(h(a)),a.getPlayClass=a.getPlayClass.bind(h(a)),a.formatter=a.formatter.bind(h(a)),a}!function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}(t,e);var a=t.prototype;return a.componentDidMount=function(){u.a.bind(["space"],this.play)},a.componentWillUnmount=function(){u.a.unbind(["space"])},a.onChange=function(e){this.props.onChange(e.target.value),null!=this.state.intervalId&&this.pause()},a.getPlayClass=function(){return null==this.state.intervalId?"fa fa-play fa-lg slider-button":"fa fa-pause fa-lg slider-button"},a.play=function(){if(!this.props.disabled)if(null!=this.state.intervalId)this.pause();else{var e=setInterval(this.stepForward,this.intervalMilliseconds);this.setState({intervalId:e})}},a.pause=function(){clearInterval(this.state.intervalId),this.setState({intervalId:null})},a.stepForward=function(){var e=this,t=this.props,a=t.start,n=t.end,r=t.step,o=t.values;if(!t.disabled){var i=(Array.isArray(o)?o:[o,o+r]).map(function(t){return t+e.increment}),s=i[1]>n?i[0]-a:0;this.props.onChange(i.map(function(e){return e-s}))}},a.stepBackward=function(){var e=this,t=this.props,a=t.start,n=t.end,r=t.step,o=t.values;if(!t.disabled){var i=(Array.isArray(o)?o:[o,o+r]).map(function(t){return t-e.increment}),s=i[0]<a?n-i[1]:0;this.props.onChange(i.map(function(e){return e+s}))}},a.formatter=function(e){if(this.props.disabled)return Object(p.b)("Data has no time steps");var t=e;return Array.isArray(e)?e[0]===e[1]&&(t=[e[0]]):t=[e],t.map(function(e){return new Date(e).toUTCString()}).join(" : ")},a.render=function(){var e=this.props,t=e.start,a=e.end,n=e.step,o=e.orientation,i=e.reversed,s=e.disabled,l=e.range,u=e.values;return r.a.createElement("div",{className:"play-slider"},r.a.createElement("div",{className:"play-slider-controls padded"},r.a.createElement("i",{className:"fa fa-step-backward fa-lg slider-button ",onClick:this.stepBackward}),r.a.createElement("i",{className:this.getPlayClass(),onClick:this.play}),r.a.createElement("i",{className:"fa fa-step-forward fa-lg slider-button ",onClick:this.stepForward})),r.a.createElement("div",{className:"play-slider-scrobbler padded"},r.a.createElement(f,{value:l?u:u[0],range:l,formatter:this.formatter,change:this.onChange,min:t,max:a,step:n,orientation:o,reversed:i,disabled:s?"disabled":"enabled"})))},t}(r.a.PureComponent);function b(){return(b=Object.assign||function(e){for(var t,a=1;a<arguments.length;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)}g.propTypes=m,g.defaultProps={onChange:function(){},loopDuration:15e3,maxFrames:100,orientation:"horizontal",reversed:!1,disabled:!1,range:!0},a.d(t,"a",function(){return y});var v={getLayers:i.a.func.isRequired,start:i.a.number.isRequired,end:i.a.number.isRequired,getStep:i.a.func,values:i.a.array.isRequired,aggregation:i.a.bool,disabled:i.a.bool,viewport:i.a.object.isRequired,children:i.a.node,mapStyle:i.a.string,mapboxApiAccessToken:i.a.string.isRequired,setControlValue:i.a.func,onViewportChange:i.a.func,onValuesChange:i.a.func},y=function(e){function t(t){var a;return(a=e.call(this,t)||this).onViewportChange=a.onViewportChange.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(a)),a}!function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}(t,e);var a=t.prototype;return a.onViewportChange=function(e){var t=this.props.disabled?b({},e):b({},e,{height:e.height+20});this.props.onViewportChange(t)},a.render=function(){var e=this.props,t=e.start,a=e.end,n=e.getStep,o=e.disabled,i=e.aggregation,l=e.children,u=e.getLayers,p=e.values,c=e.onValuesChange,d=e.viewport,f=e.setControlValue,h=e.mapStyle,m=e.mapboxApiAccessToken,v=u(p),y=b({},d,{height:o?d.height:d.height-20});return r.a.createElement("div",null,r.a.createElement(s.a,{viewport:y,layers:v,setControlValue:f,mapStyle:h,mapboxApiAccessToken:m,onViewportChange:this.onViewportChange}),!o&&r.a.createElement(g,{start:t,end:a,step:n(t),values:p,range:!i,onChange:c}),l)},t}(r.a.Component);y.propTypes=v,y.defaultProps={aggregation:!1,disabled:!1,mapStyle:"light",setControlValue:function(){},onViewportChange:function(){},onValuesChange:function(){}}},2741:function(e,t,a){},2742:function(e,t,a){},2751:function(e,t){},2752:function(e,t){},2753:function(e,t){},2833:function(e,t,a){"use strict";a.r(t),a.d(t,"getLayer",function(){return b});var n=a(1),r=a.n(n),o=a(0),i=a.n(o),s=a(2738),l=a(8),u=a(2739),p=a(2737),c=a(2735),d=a(2725),f=a(2740);function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(){return(m=Object.assign||function(e){for(var t,a=1;a<arguments.length;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)}function g(e){return r.a.createElement("div",{className:"deckgl-tooltip"},r.a.createElement(f.a,{label:Object(l.b)("Longitude and Latitude")+": ",value:e.object.position[0]+", "+e.object.position[1]}),r.a.createElement(f.a,{label:Object(l.b)("Weight")+": ",value:""+e.object.weight}))}function b(e,t,a,n,r,o,i){var l=e,u=l.color_picker,p=t.data.features.map(function(e){return m({},e,{color:[u.r,u.g,u.b,255*u.a]})});if(l.js_data_mutator){var f=Object(c.a)(l.js_data_mutator);p=f(p)}return null!=i&&i.forEach(function(e){p=p.filter(e)}),new s.h(m({id:"screengrid-layer-"+l.slice_id,data:p,pickable:!0,cellSizePixels:l.grid_size,minColor:[u.r,u.g,u.b,0],maxColor:[u.r,u.g,u.b,255*u.a],outline:!1,getWeight:function(e){return e.weight||0}},Object(d.a)(l,n,g)))}var v={formData:i.a.object.isRequired,payload:i.a.object.isRequired,setControlValue:i.a.func.isRequired,viewport:i.a.object.isRequired,onAddFilter:i.a.func,setTooltip:i.a.func},y=function(e){function t(a){var n;return(n=e.call(this,a)||this).state=t.getDerivedStateFromProps(a),n.getLayers=n.getLayers.bind(h(n)),n.onValuesChange=n.onValuesChange.bind(h(n)),n.onViewportChange=n.onViewportChange.bind(h(n)),n}(function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t})(t,e),t.getDerivedStateFromProps=function(e,t){if(t&&e.payload.form_data===t.formData)return null;var a=e.payload.data.features||[],n=a.map(function(e){return e.__timestamp}),r=e.payload.form_data.time_grain_sqla||e.payload.form_data.granularity||"P1D",o=Object(p.a)(n,r);return{start:o.start,end:o.end,getStep:o.getStep,values:o.values,disabled:o.disabled,viewport:e.formData.autozoom?Object(d.b)(e.viewport,function(e){return e.map(function(e){return e.position})}(a)):e.viewport,selected:[],lastClick:0,formData:e.payload.form_data}};var a=t.prototype;return a.onValuesChange=function(e){this.setState({values:Array.isArray(e)?e:[e,e+this.state.getStep(e)]})},a.onViewportChange=function(e){this.setState({viewport:e})},a.getLayers=function(e){var t=[];return e[0]===e[1]||e[1]===this.end?t.push(function(t){return t.__timestamp>=e[0]&&t.__timestamp<=e[1]}):t.push(function(t){return t.__timestamp>=e[0]&&t.__timestamp<e[1]}),[b(this.props.formData,this.props.payload,this.props.onAddFilter,this.props.setTooltip)]},a.render=function(){var e=this.props,t=e.formData,a=e.payload,n=e.setControlValue;return r.a.createElement("div",null,r.a.createElement(u.a,{getLayers:this.getLayers,start:this.state.start,end:this.state.end,getStep:this.state.getStep,values:this.state.values,onValuesChange:this.onValuesChange,disabled:this.state.disabled,viewport:this.state.viewport,onViewportChange:this.onViewportChange,mapboxApiAccessToken:a.data.mapboxApiKey,mapStyle:t.mapbox_style,setControlValue:n,aggregation:!0}))},t}(r.a.PureComponent);y.propTypes=v,y.defaultProps={onAddFilter:function(){},setTooltip:function(){}},t.default=y}}]);