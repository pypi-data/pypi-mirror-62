import unittest
from morphling.input import Reader
from morphling.copy import Copy
from morphling.output import Writer


class TestCopyData(unittest.TestCase):
    def test_be_able_to_create_data_struct_from_intput_data(self):
        reader = Reader()
        writer = Writer()
        obj = Copy(reader, writer)
        obj.construct('test/input_file/basic_line')
        actual = obj.data
        self.assertEqual(
            actual,
            [
                [
                    '1079784248112951296',
                    'reply',
                    '@PNchP_ à¹€à¸ªà¸µà¸¢à¸ˆà¸±à¸¢à¸­à¸° à¹€à¸à¸·à¹ˆà¸­à¸™à¸‡à¸±à¸¢ à¸™à¸µà¹ˆà¹€à¸à¸·à¹ˆà¸­à¸™à¹€à¸­à¸‡',
                    '2019-01-01 00:00:00',
                    '560',
                    'twitter',
                    '1904452146',
                    'à¸«à¸¡à¸µà¸Šà¸¡à¸à¸¹',
                ]
            ],
        )

    def test_ba_able_to_create_data_struct_when_there_are_space_between_message(self):
        reader = Reader()
        writer = Writer()
        obj = Copy(reader, writer)
        obj.construct('test/input_file/space_between_message')
        actual = obj.data
        self.assertEqual(
            actual,
            [
                [
                    '079784245067829254',
                    'tweet',
                    'Happy New Years 2019ğŸ‰ğŸ‰ à¸™à¸°à¸„à¸°à¸—à¸¸à¸à¸„à¸™ à¸›à¸µà¸™à¸µà¹‰à¸à¹‡à¸‚à¸­à¸à¸²à¸à¸•à¸±à¸§à¸”à¹‰à¸§à¸¢à¸„à¹ˆà¸°!\nà¸›à¸µà¸—à¸µà¹ˆà¹à¸¥à¹‰à¸§à¸–à¹‰à¸²à¸—à¸³à¸­à¸°à¹„à¸£à¸œà¸´à¸”à¸à¸¥à¸²à¸”à¸«à¸£à¸·à¸­à¸—à¸³à¹ƒà¸«à¹‰à¹„à¸¡à¹ˆà¸à¸­à¹ƒà¸ˆà¸­à¸°à¹„à¸£à¹„à¸›à¸•à¹‰à¸­à¸‡à¸‚à¸­à¹‚à¸—à¸©à¸”à¹‰à¸§à¸¢à¸™à¸°à¸„à¸°ğŸ™\nà¸”à¸µà¹ƒà¸ˆà¸—à¸µà¹ˆà¹„à¸”à¹‰à¸£à¸¹à¹‰à¸ˆà¸±à¸à¸à¸±à¸šà¸—à¸¸à¸à¸„à¸™à¸„à¹ˆà¸° à¹à¸¥à¹‰à¸§à¸à¹‡à¸‚à¸­à¸šà¸„à¸¸à¸“à¸—à¸µà¹ˆà¸¡à¸²à¹€à¸§à¸´à¹ˆà¸™à¹€à¸§à¹‰à¸­à¸”à¹‰à¸§à¸¢à¸à¸±à¸™à¸™à¸°à¸„à¸° à¸”à¸µà¹ƒà¸ˆà¸¡à¸²à¸à¹€à¸¥à¸¢',
                    '2019-01-01 00:00:00',
                    '9857',
                    'twitter',
                    '2161099140',
                    'ğŸ„FreSanâ˜•59 days countdown to wmtsb3',
                ]
            ],
        )

    def test_be_able_to_create_data_when_there_is_comma_between_message(self):
        reader = Reader()
        writer = Writer()
        obj = Copy(reader, writer)
        obj.construct('test/input_file/comma_between_message')
        actual = obj.data
        self.assertEqual(
            actual,
            [
                [
                    '1079784248717070336',
                    'tweet',
                    'dear past ,\nthank you for all the lessons.\n\n.\n#HappyNewYear2019 https://t.co/LNIo1hGeoR',
                    '2019-01-01 00:00:00',
                    '5209',
                    'twitter',
                    '1192256738',
                    'Maink à¸¡à¸­à¸‡à¹‚à¸¥à¸',
                ]
            ],
        )

    def test_be_able_to_construct_when_owner_id_is_emoji(self):
        reader = Reader()
        writer = Writer()
        obj = Copy(reader, writer)
        obj.construct('test/input_file/owner_name_end_with_emoji')
        actual = obj.data
        self.assertEqual(
            actual,
            [
                [
                    '1079784244640010240',
                    'tweet',
                    'à¸ˆà¸¸à¸”à¸à¸¥à¸¸à¸à¸±à¸™à¸ªà¸™à¸¸à¸à¸¡à¸²à¸à¸™à¸°',
                    '2019-01-01 00:00:00',
                    '9672',
                    'twitter',
                    '1013618778',
                    'ğŸ’–',
                ]
            ],
        )

    def test_be_able_to_construct_data_when_owner_name_has_newline_in_between(self):
        reader = Reader()
        writer = Writer()
        obj = Copy(reader, writer)
        obj.construct('test/input_file/owner_name_has_new_line_in_between')
        actual = obj.data
        self.assertEqual(
            actual,
            [
                [
                    'skincarebymild__BuMRKW4FQyG',
                    'post',
                    'à¸•à¸²à¸¡à¸«à¸²à¸à¸±à¸™à¹à¸”à¸”à¸­à¸¢à¸¹à¹ˆà¸¡à¸²à¸—à¸²à¸‡à¸™à¸µà¹‰à¹€à¸”à¹‰à¸­ğŸ’š\nà¸à¸±à¸™à¹à¸”à¸”à¸‹à¸±à¸™à¸„à¸´à¸ª à¸«à¸™à¹‰à¸²à¹€à¸‡à¸² à¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™à¸™à¸±à¸à¸¨à¸¶à¸à¸©à¸²à¹ƒà¸Šà¹‰à¸—à¸²à¹„à¸›à¹‚à¸£à¸‡à¹€à¸£à¸µà¸¢à¸™à¸à¹‡à¹„à¸”à¹‰à¹„à¸¡à¹ˆà¸§à¸­à¸ à¸—à¸²à¹„à¸”à¹‰à¸—à¸¸à¸à¸ªà¸ à¸²à¸à¸œà¸´à¸§ à¹€à¸à¸¥à¸µà¹ˆà¸¢à¸‡à¹ˆà¸²à¸¢ à¹€à¸›à¹‡à¸™à¸à¸±à¸™à¹à¸”à¸”à¸œà¸ªà¸¡à¹‚à¸›à¸£à¸•à¸µà¸™à¹„à¸«à¸¡à¸à¸£à¹‰à¸­à¸¡à¸šà¸³à¸£à¸¸à¸‡à¸œà¸´à¸§à¸«à¸™à¹‰à¸² spf50 pa+++ ğŸŒ¤\n#à¸”à¸µà¸‚à¸™à¸²à¸”à¸™à¸µà¹‰à¹„à¸¡à¹ˆà¸¥à¸­à¸‡à¹„à¸¡à¹ˆà¹„à¸”à¹‰à¹à¸¥à¹‰à¸§ .\n~~~~~~~~~~~~~~~~~~~~~~~~~~~\n.\nâ˜€ï¸à¸ªà¸­à¸šà¸–à¸²à¸¡ | à¸ªà¸±à¹ˆà¸‡à¸‹à¸·à¹‰à¸­ | à¸›à¸£à¸¶à¸à¸©à¸²à¸Ÿà¸£à¸µğŸŒµ\nğŸŒˆLine ID : @zik7826z\nğŸ“à¸«à¸£à¸·à¸­ à¹„à¸”à¹€à¸£à¸ ig\n#skincÃ¤rebymild\n.\n.\n. .\n.\n.\n.\n.\n#à¸¥à¸´à¸›à¸¡à¸²à¸£à¹Œà¸„ #à¸£à¸²à¸„à¸²à¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™ #à¸£à¸²à¸„à¸²à¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™à¸™à¸±à¸à¸¨à¸¶à¸à¸©à¸² #à¸šà¸³à¸£à¸¸à¸‡à¸œà¸´à¸§à¸«à¸™à¹‰à¸² #à¸šà¸³à¸£à¸¸à¸‡à¸›à¸²à¸ #laneige #à¸ªà¸¥à¸´à¸›à¸›à¸´à¹‰à¸‡à¸¡à¸²à¸£à¹Œà¸„ #à¸¥à¸²à¹€à¸™à¸ˆà¸‚à¸­à¸‡à¹à¸—à¹‰ #à¸¥à¸²à¹€à¸™à¸ˆ #à¸‰à¸±à¸™à¸ˆà¸°à¸ªà¸§à¸¢ #à¸‹à¸±à¸™à¸„à¸´à¸ª #sunkiss',
                    '2019-02-23 00:01:13',
                    '8443',
                    'instagram',
                    '9188904578',
                    'â™¡ğ‘»ğ’†ğ’”ğ’•ğ’†ğ’“ â€¢ ğ’ğ’‚ğ’ğ’†ğ’Šğ’ˆğ’† â€¢ \nğ‘ºğ’–ğ’ğ’Œğ’Šğ’”ğ’”\n',
                ],
                [
                    '1079784248112951296',
                    'reply',
                    '@PNchP_ à¹€à¸ªà¸µà¸¢à¸ˆà¸±à¸¢à¸­à¸° à¹€à¸à¸·à¹ˆà¸­à¸™à¸‡à¸±à¸¢ à¸™à¸µà¹ˆà¹€à¸à¸·à¹ˆà¸­à¸™à¹€à¸­à¸‡',
                    '2019-01-01 00:00:00',
                    '560',
                    'twitter',
                    '1904452146',
                    'à¸«à¸¡à¸µà¸Šà¸¡à¸à¸¹',
                ],
                [
                    'pcnk_2hand_Bvo-Iy3g7gw',
                    'post',
                    'ğŸŒ»ğŸŒ»ğŸŒ» à¹€à¸ªà¸·à¹‰à¸­à¸™à¹ˆà¸²à¸£à¸±à¸à¸œà¹‰à¸²à¹ƒà¸ªà¹ˆà¸ªà¸šà¸²à¸¢ 50à¸¿ . ğŸ“Œ âœ¨à¸¥à¸—à¸š 30 ems 50\nâœ¨à¹€à¸à¸‡à¸¢à¸µà¸™à¸ªà¹Œ 40 ems 60\n\n__________________________\nà¸à¸•à¸´à¸à¸²ğŸ“¢ğŸ“¢ğŸ“¢ â€¼ï¸â€¼ï¸ à¹€à¸­à¸Ÿà¹ƒà¸•à¹‰à¸£à¸¹à¸› à¸«à¸£à¸·à¸­à¸—à¸±à¸à¸«à¸²à¹à¸¡à¹ˆà¸„à¹‰à¸²à¹„à¸”à¹‰à¹€à¸¥à¸¢à¸™à¹‰à¸²à¸²à¸²â€¼ï¸â€¼ï¸ âŒà¹€à¸­à¸Ÿà¸à¹ˆà¸­à¸™à¹‚à¸­à¸™à¸à¹ˆà¸­à¸™à¸ªà¹ˆà¸‡à¸à¹ˆà¸­à¸™ à¸‡à¸”à¸”à¸£à¸²à¸¡à¹ˆà¸²à¸ˆà¹‰à¸²à¸²à¸²âŒ ğŸ™ğŸ»à¸à¸£à¹‰à¸­à¸¡à¹‚à¸­à¸™à¸„à¹ˆà¸­à¸¢à¸—à¸±à¸à¸¡à¸²à¸™à¸°à¸„à¸° à¹„à¸¡à¹ˆà¹€à¸­à¸Ÿà¹€à¸¥à¹ˆà¸™à¸™à¹‰à¸²à¸²à¸²ğŸ™ğŸ» #à¹€à¸ªà¸·à¹‰à¸­à¸œà¹‰à¸²à¸¡à¸·à¸­à¸ªà¸­à¸‡ #à¹‚à¸¥à¹Šà¸°à¸•à¸¹à¹‰ #à¹€à¸ªà¸·à¹‰à¸­à¸œà¹‰à¸²à¹à¸Ÿà¸Šà¸±à¹ˆà¸™ #à¹€à¸ªà¸·à¹‰à¸­à¸œà¹‰à¸² #à¹‚à¸¥à¹Šà¸°à¸•à¸¹à¹‰à¹€à¸ªà¸·à¹‰à¸­à¸œà¹‰à¸²à¸¡à¸·à¸­à¸ªà¸­à¸‡ #à¸ªà¹ˆà¸‡à¸•à¹ˆà¸­à¹€à¸ªà¸·à¹‰à¸­à¸œà¹‰à¸²à¸¡à¸·à¸­à¸ªà¸­à¸‡ #à¹‚à¸¥à¹Šà¸°à¸•à¸¹à¹‰à¹€à¸ªà¸·à¹‰à¸­à¸œà¹‰à¸² #à¹‚à¸¥à¹Šà¸°à¹€à¸ªà¸·à¹‰à¸­à¸œà¹‰à¸² #à¹€à¸ªà¸·à¹‰à¸­à¸œà¹‰à¸²à¸ªà¸§à¸¢à¹† #2hand #à¸ªà¹ˆà¸‡à¸•à¹ˆà¸­à¸ªà¸ à¸²à¸à¸™à¸²à¸‡à¸Ÿà¹‰à¸² #à¸ªà¹ˆà¸‡à¸•à¹ˆà¸­ #à¹€à¸ªà¸·à¹‰à¸­à¸œà¹‰à¸²à¸–à¸¹à¸à¹† #à¹€à¸ªà¸·à¹‰à¸­à¸œà¹‰à¸²à¸¡à¸·à¸­2 #à¹€à¸ªà¸·à¹‰à¸­à¸œà¹‰à¸²à¸£à¸²à¸„à¸²à¸–à¸¹à¸ #à¹€à¸ªà¸·à¹‰à¸­à¸œà¹‰à¸²à¸£à¸²à¸„à¸²à¸–à¸¹à¸à¸à¸£à¹‰à¸­à¸¡à¸ªà¹ˆà¸‡ #à¹€à¸ªà¸·à¹‰à¸­à¸œà¹‰à¸²à¸£à¸²à¸„à¸²à¹€à¸šà¸²à¹† #à¸ªà¸ à¸²à¸à¸™à¸²à¸‡à¸Ÿà¹‰à¸² #à¸¡à¸·à¸­à¸ªà¸­à¸‡à¸ªà¸ à¸²à¸à¸”à¸µ #à¸¡à¸·à¸­à¸ªà¸­à¸‡à¸£à¸²à¸„à¸²à¸–à¸¹à¸ #à¸à¸²à¸‡à¹€à¸à¸‡ #à¸§à¸´à¸™à¹€à¸—à¸ˆ #à¹€à¸à¸‡à¸¢à¸µà¸™à¸ªà¹Œ #à¸à¸²à¸‡à¹€à¸à¸‡à¸–à¸¹à¸à¹† #2hand  #2handthailand #à¸¡à¸·à¸­à¸ªà¸­à¸‡ #à¸§à¸´à¸™à¹€à¸—à¸ˆ #à¸£à¸²à¸„à¸²à¸–à¸¹à¸ #à¹€à¸ªà¸·à¹‰à¸­à¸œà¹‰à¸²à¸™à¹ˆà¸²à¸£à¸±à¸',
                    '2019-03-31 00:04:21',
                    '3860',
                    'instagram',
                    '10677434124',
                    'HELLO ğŸ‘‹ \nà¹€à¸ªà¸·à¹‰à¸­à¸œà¹‰à¸²à¸¡à¸·à¸­ 1,2ğŸ‘•ğŸ‘—\n',
                ],
                [
                    '1112038291539263489',
                    'tweet',
                    'à¸‹à¸·à¹‰à¸­à¸šà¸±à¸•à¸£ cat6 à¸”à¸µà¸¡à¹ˆà¸° à¸«à¸£à¸·à¸­à¸ˆà¸°à¹€à¸à¹‡à¸šà¹€à¸‡à¸´à¸™à¹„à¸›à¸‹à¸·à¹‰à¸­à¸‚à¸­à¸‡ cat t-shirt',
                    '2019-03-31 00:06:04',
                    '315',
                    'twitter',
                    '267263658',
                    'à¸¡à¸¸à¸à¸ªà¸¸à¹€à¸•à¸£à¸µà¸¢à¸¡à¸‚à¸¶à¹‰à¸™à¸§à¸­à¸£à¹Œà¸”med',
                ],
            ],
        )

    def test_be_able_to_construct_from_multiple_line(self):
        reader = Reader()
        writer = Writer()
        obj = Copy(reader, writer)
        obj.construct('test/input_file/multiple_line')
        actual = obj.data
        self.assertEqual(
            actual,
            [
                [
                    '1079784244640010240',
                    'tweet',
                    'à¸ˆà¸¸à¸”à¸à¸¥à¸¸à¸à¸±à¸™à¸ªà¸™à¸¸à¸à¸¡à¸²à¸à¸™à¸°',
                    '2019-01-01 00:00:00',
                    '9672',
                    'twitter',
                    '1013618778',
                    'ğŸ’–',
                ],
                [
                    '1079784248112951296',
                    'reply',
                    '@PNchP_ à¹€à¸ªà¸µà¸¢à¸ˆà¸±à¸¢à¸­à¸° à¹€à¸à¸·à¹ˆà¸­à¸™à¸‡à¸±à¸¢ à¸™à¸µà¹ˆà¹€à¸à¸·à¹ˆà¸­à¸™à¹€à¸­à¸‡',
                    '2019-01-01 00:00:00',
                    '560',
                    'twitter',
                    '1904452146',
                    'à¸«à¸¡à¸µà¸Šà¸¡à¸à¸¹',
                ],
                [
                    '1079784248717070336',
                    'tweet',
                    'dear past ,\nthank you for all the lessons.\n\n.\n#HappyNewYear2019 https://t.co/LNIo1hGeoR',
                    '2019-01-01 00:00:00',
                    '5209',
                    'twitter',
                    '1192256738',
                    'Maink à¸¡à¸­à¸‡à¹‚à¸¥à¸',
                ],
                [
                    '2104171073012154_2104263833002878',
                    'comment',
                    '',
                    '2019-03-31 00:06:02',
                    '7434',
                    'facebook',
                    '00000000',
                    'Unknown',
                ],
                [
                    'kpw_VFen_oJpn_Bvo-',
                    'post',
                    '#KRISTPERAWATSKY\nâ€¢â€¢\nâ€¢â€¢\nCr. Twitter : niitnoii \nà¸ªà¸²à¸¡à¸²à¸£à¸–à¸”à¸¹à¸£à¸¹à¸›à¹€à¸à¸´à¹ˆà¸¡à¹„à¸”à¹‰à¸—à¸µà¸§à¸´à¸•à¹€à¸•à¸­à¸£à¹Œà¸Šà¸·à¹ˆà¸­à¸™à¸µà¹‰à¸™à¹‰à¸²à¸²\n#kristtps #kristperawat\n#à¸à¸¥à¸—à¸«à¸²à¸£à¸‚à¸­à¸‡à¸à¹‰à¸­à¸™ #thxpic #à¸¢à¸¢à¸‚à¸„à¸',
                    '2019-03-31 00:06:02',
                    '1662',
                    'instagram',
                    '4484800865',
                    'kristtppraew_fc',
                ],
                [
                    'ultraviyolehi_Bvo-Qponcnp',
                    'post',
                    'Sen nasÄ±l bÃ¶yle yakÄ±ÅŸÄ±klÄ± oldun kolyeni yerim senin. AÅŸka geldim mdÃ¶smd\n\n#tawan_v #taytawan #newwiee #newthitipoom #taynew #petekao #OurSkyy #kissmeagain #darkbluekiss #TayNewMealDate #GMM25 #GMMTV #LineTV #bl #blseries #oishi #thaiseries #thaiboy #thaiactor #à¸®à¸±à¸™à¸™à¸µà¹ˆ #polca #à¹€à¸•à¸™à¸´à¸§ #boyslove #cuteboys\n#taynew #taytawan  #newwietitiphoom  #kissmeagain #darkbluekiss #kristsingto #sotusstheseries  #addictedwebseries\n#addicted',
                    '2019-03-31 00:06:02',
                    '1630',
                    'instagram',
                    '11594034019',
                    'ultraviyolehi',
                ],
            ],
        )

    def test_be_able_to_construct_data_when_message_contain_datetime(self):
        reader = Reader()
        writer = Writer()
        obj = Copy(reader, writer)
        obj.construct('test/input_file/messge_contain_datetime')
        actual = obj.data
        self.assertEqual(
            actual,
            [
                [
                    '1079784250675613698',
                    'tweet',
                    '2019-01-01 00:00:01\n6. Chiang Rai\n7. #NHKç´…ç™½\n8. #ICONSIAM\n9. #à¸­à¸¢à¸²à¸à¸šà¸­à¸à¸­à¸°à¹„à¸£ygà¸à¹ˆà¸­à¸™à¸›à¸µà¹ƒà¸«à¸¡à¹ˆà¸¡à¸±à¹‰à¸¢\n10. #à¹à¸œà¹ˆà¸™à¸”à¸´à¸™à¹„à¸«à¸§',
                    '2019-01-01 00:00:01',
                    '880',
                    'twitter',
                    '837126367779008512',
                    'TopTrendThai',
                ],
                [
                    '1108050502279819265',
                    'tweet',
                    '2019-03-20 00:00:00 6. toy story 4 7. Blind Trust 8. #à¸¥à¸”à¹‚à¸¥à¸à¹€à¸¥à¸­à¸°à¸à¸±à¸šà¸œà¸¥à¸´à¸• 9. #à¸ˆà¸”à¸«à¸¡à¸²à¸¢à¹€à¸”à¹‡à¸à¹à¸¡à¸§ 10. #OCLOCK',
                    '2019-03-20 00:00:00',
                    '4132',
                    'twitter',
                    '837126367779008512',
                    'TopTrendThai',
                ],
                [
                    '1108051014274314240',
                    'tweet',
                    'Rank 1 Youtube Trend 2019-03-20 00:02:01 à¹€à¸¥à¸´à¸à¸„à¸¸à¸¢à¸—à¸±à¹‰à¸‡à¸­à¸³à¹€à¸ à¸­à¹€à¸à¸·à¹ˆà¸­à¹€à¸˜à¸­à¸„à¸™à¹€à¸”à¸µà¸¢à¸§ - à¸¥à¸´à¸¥à¸¥à¸µà¹ˆ à¹„à¸”à¹‰à¸«à¸¡à¸”à¸–à¹‰à¸²à¸ªà¸”à¸Šà¸·à¹ˆà¸™ Feat.à¹€à¸à¹‰à¸² à¹€à¸à¸£à¸´à¸à¸à¸¥ [OFFICIAL MVã€‘',
                    '2019-03-20 00:02:03',
                    '8075',
                    'twitter',
                    '837126367779008512',
                    'TopTrendThai',
                ],
                [
                    '1102252313303904256',
                    'reply',
                    '@icez à¸™à¸´à¸¢à¸²à¸¢à¸­à¸±à¸à¹€à¸”à¸—: Dreamcatcher : Corona Australis Academy (2019-03-03 23:59:14) https://t.co/7BUEIV1s2e',
                    '2019-03-04 00:00:05',
                    '2287',
                    'twitter',
                    '254500720',
                    'icez network',
                ],
                [
                    '1102614688255238144',
                    'tweet',
                    'Twitter Trend\n2019-03-05 00:00:01\n1. #thevoiceTH\n2. #à¸à¸£à¸‡à¸à¸£à¸£à¸¡\n3. #à¸ˆà¸±à¸™à¸—à¸£à¹ŒShockà¹‚à¸¥à¸à¸¢à¸±à¸‡à¹„à¸‡à¸‹à¸´\n4. #à¸«à¸±à¸§à¹ƒà¸ˆà¸¨à¸´à¸¥à¸²\n5. #à¸”à¸µà¹ƒà¸ˆà¸”à¹‰à¸§à¸¢à¸™à¸°',
                    '2019-03-05 00:00:01',
                    '7406',
                    'twitter',
                    '837126367779008512',
                    'TopTrendThai',
                ],
                [
                    '38667962',
                    'post',
                    'à¸¥à¸‡ Skyrim à¹ƒà¸™ Steam à¹ƒà¸«à¸¡à¹ˆ à¹€à¸™à¸·à¹ˆà¸­à¸‡à¸ˆà¸²à¸à¸§à¹ˆà¸²à¸­à¸¢à¸¹à¹ˆà¸”à¸µà¹† à¸•à¸±à¸§à¹€à¸à¸¡à¸¡à¸±à¸™à¸«à¸²à¸¢à¹„à¸›(à¹„à¸¡à¹ˆà¹„à¸”à¹‰à¸à¸” Uninstall à¹€à¸¥à¸¢) à¹à¸¥à¸°à¸­à¸¢à¸²à¸à¸à¸¥à¸±à¸šà¸¡à¸²à¹€à¸¥à¹ˆà¸™à¹ƒà¸«à¸¡à¹ˆ<br />\n<br />\nà¸›à¸£à¸²à¸à¸à¸§à¹ˆà¸² à¸¡à¸±à¸™à¸¥à¸‡à¹„à¸¡à¹ˆà¹„à¸”à¹‰....à¹à¸¥à¸°à¸¡à¸±à¸™à¸ˆà¸°à¸ªà¸¸à¹ˆà¸¡ Error à¸¡à¸² à¹à¸•à¹ˆà¸¥à¸°à¸„à¸£à¸±à¹‰à¸‡à¸ˆà¸°à¹„à¸¡à¹ˆà¹€à¸«à¸¡à¸·à¸­à¸™à¸à¸±à¸™ à¹€à¸Šà¹ˆà¸™<br />\n<br />\nà¸à¸²à¸£à¸­à¹ˆà¸²à¸™à¸”à¸´à¸ªà¸à¹Œà¸œà¸´à¸”à¸à¸¥à¸²à¸”<br />\nà¸”à¸´à¸ªà¸à¹Œà¹€à¸ªà¸µà¸¢à¸«à¸²à¸¢<br />\nà¹„à¸Ÿà¸¥à¹Œà¸­à¸±à¸à¹€à¸”à¸•à¹€à¸ªà¸µà¸¢à¸«à¸²à¸¢<br />\n<br />\n<img class="img-in-post" src="https://f.ptcdn.info/021/063/000/poirsfi8dCQ9zZa5TZW-o.png" data-image="img:544x139" /> <img class="img-in-post" src="https://f.ptcdn.info/021/063/000/poirsfudeCJ0LMlJDJ5-o.png" data-image="img:520x119" /> <img class="img-in-post" src="https://f.ptcdn.info/021/063/000/poirsf82a0yD1Uowr6G-o.png" data-image="img:492x125" /><br />\nà¸ˆà¸²à¸à¸™à¸±à¹‰à¸™à¸à¹‡à¸¥à¸­à¸‡....<br />\n<br />\n- à¹ƒà¸«à¹‰ Steam à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¹€à¸à¸¡<br />\n- à¸¥à¸šà¹à¸¥à¹‰à¸§à¸¥à¸‡à¹ƒà¸«à¸¡à¹ˆ(à¹„à¸¡à¹ˆà¸œà¹ˆà¸²à¸™à¸à¸²à¸£à¹ƒà¸«à¹‰ Steam à¸„à¸£à¸§à¸ˆà¸ªà¸­à¸šà¹€à¸à¸¡à¹à¸šà¸šà¸„à¸£à¸±à¹‰à¸‡à¸à¹ˆà¸­à¸™ à¸„à¸·à¸­à¸¥à¸‡à¹à¸šà¸š Clean à¹€à¸¥à¸¢)<br />\n- à¸¥à¸šà¹„à¸Ÿà¸¥à¹Œà¸—à¸µà¹ˆà¸¡à¸µà¸›à¸±à¸à¸«à¸² à¹ƒà¸™à¸—à¸µà¹ˆà¸™à¸µà¹‰à¸„à¸·à¸­ dragonborn.bsa à¹à¸¥à¸° HighResTexturePack03.bsa à¸­à¸­à¸ à¹à¸¥à¹‰à¸§à¹ƒà¸«à¹‰ Steam à¸„à¸£à¸§à¸ˆà¸ªà¸­à¸šà¹„à¸Ÿà¸¥à¹Œà¹ƒà¸«à¸¡à¹ˆ<br />\n- à¹ƒà¸Šà¹‰à¸„à¸³à¸ªà¸±à¹ˆà¸‡ chkdsk à¹à¸¥à¹‰à¸§à¸à¸¥à¸±à¸šà¹„à¸›à¸—à¸³à¸‹à¹‰à¸³à¸‚à¹‰à¸­ 1-3<br />\n- à¸à¹‡à¸­à¸›à¹„à¸Ÿà¸¥à¹Œà¸—à¸µà¹ˆà¸¡à¸±à¸™à¸‚à¸¶à¹‰à¸™ Error à¸ˆà¸²à¸à¸­à¸µà¸à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡à¸¡à¸²à¸¥à¸‡à¸—à¸±à¸š<br />\n- à¹€à¸­à¸² Backup à¸ˆà¸²à¸à¸­à¸µà¸à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡à¸¡à¸²à¹ƒà¸ªà¹ˆ<br />\n- à¸¥à¸šà¹à¸„à¸Š<br />\n<br />\nà¸¥à¸­à¸‡à¸—à¸³à¸«à¸¡à¸”à¹à¸¥à¹‰à¸§à¸à¹‡à¹€à¸«à¸¡à¸·à¸­à¸™à¹€à¸”à¸´à¸¡<br />\n<br />\nà¹€à¸¥à¸¢à¸¥à¸­à¸‡à¹ƒà¸«à¹‰ Steam à¸‹à¹ˆà¸­à¸¡à¸„à¸¥à¸±à¸‡à¹€à¸à¸¡à¹ƒà¸«à¸¡à¹ˆà¸”à¸¹à¹à¸¥à¸°à¹ƒà¸Šà¹‰à¸„à¸³à¸ªà¸±à¹ˆà¸‡ chkdsk à¸›à¸£à¸²à¸à¸à¸§à¹ˆà¸²à¸¡à¸±à¸™à¹„à¸¡à¹ˆà¸¡à¸µà¸­à¸°à¹„à¸£à¸œà¸´à¸”à¸›à¸à¸•à¸´à¹€à¸¥à¸¢ à¹à¸¥à¸°à¹„à¸¡à¹ˆà¸¡à¸µà¹à¸ˆà¹‰à¸‡ Error à¸¡à¸²à¸”à¹‰à¸§à¸¢<br />\n<br />\n<img class="img-in-post" src="https://f.ptcdn.info/021/063/000/poirsfh0zyca8P6sUZ0-o.png" data-image="img:619x895" /> <img class="img-in-post" src="https://f.ptcdn.info/021/063/000/poirsfd93dhT857B5OZ-o.png" data-image="img:1333x625" /> <img class="img-in-post" src="https://f.ptcdn.info/021/063/000/poirsf3bxut0QpNcTSkE-o.png" data-image="img:1327x606" /><br />\nà¹„à¸Ÿà¸¥à¹Œ Log à¹ƒà¸™ Steam<br />\n<br />\n<img class="img-in-post" src="https://f.ptcdn.info/021/063/000/poirsgn22TFW18ynxbH-o.png" data-image="img:1791x469" /><br />\n<div class="code-style">[2019-03-17 22:36:26] Failed to write chunk in file <br />\n&quot;Data\\HighResTexturePack03.bsa&quot; 1048576 bytes at offset 1013856808 (Device Corrupt)</div><br />\nà¹„à¸¡à¹ˆà¹„à¸«à¸§à¹à¸¥à¹‰à¸§....à¸¥à¸­à¸‡à¸¥à¸±à¸à¹„à¸à¹ˆ à¸£à¸±à¸™à¹€à¸à¸¡à¹‚à¸”à¸¢à¸•à¸£à¸‡à¸ˆà¸²à¸ SkyrimLauncher.exe à¸à¹‡à¹„à¸¡à¹ˆà¹„à¸”à¹‰ à¸¡à¸±à¸™à¸šà¸±à¸‡à¸„à¸±à¸šà¸­à¸±à¸à¹€à¸”à¸•à¹à¸¥à¹‰à¸§à¸à¹‡à¹à¸šà¸šà¸™à¸µà¹‰<br />\n<br />\n<img class="img-in-post" src="https://f.ptcdn.info/021/063/000/poirx3oooWUW1SUS991-o.png" data-image="img:553x191" /><br />\nà¸ªà¸£à¸¸à¸›à¸„à¸·à¸­à¸¥à¸­à¸‡à¸—à¸¸à¸à¸­à¸¢à¹ˆà¸²à¸‡à¹à¸¥à¹‰à¸§ à¹à¸¥à¹‰à¸§à¸„à¸§à¸£à¸ˆà¸°à¸—à¸³à¸¢à¸±à¸‡à¹„à¸‡à¸•à¹ˆà¸­à¸”à¸µ??',
                    '2019-03-18 00:01:16',
                    '2344',
                    'pantip',
                    '663452',
                    'MrCatZaa',
                ],
            ],
        )

    def test_be_able_to_construct_data_when_owner_id_is_cha(self):
        reader = Reader()
        writer = Writer()
        obj = Copy(reader, writer)
        obj.construct('test/input_file/owner_id_is_cha')
        actual = obj.data
        self.assertEqual(
            actual,
            [
                [
                    'mifarashita_BsnYvqDhEKM_d1c6e9dd2f6e65209065b5bb7533b02ca0d0fe3d',
                    'comment',
                    '@pansika à¸‚à¸­à¸šà¸„à¸¸à¸“à¸„à¹ˆà¸²à¸²ğŸ˜˜',
                    '2019-01-15 00:02:15',
                    '4462',
                    'instagram',
                    'mifarashita',
                    'mifarashita',
                ],
            ],
        )

    def test_be_able_to_construct_data_from_csv_file(self):
        reader = Reader()
        writer = Writer()
        obj = Copy(reader, writer)
        obj.construct_csv('test/input_file/csv_format')
        actual = obj.data
        self.assertEqual(
            actual,
            [
                [
                    'id',
                    'type',
                    'message',
                    'time',
                    'engagement',
                    'channel',
                    'owner id',
                    'owner name',
                ],
                [
                    '1079784248717070336',
                    'tweet',
                    'dear past ,\nthank you for all the lessons.\n\n.\n#HappyNewYear2019 https://t.co/LNIo1hGeoR',
                    '2019-01-01 00:00:00',
                    '5209',
                    'twitter',
                    '1192256738',
                    'Maink à¸¡à¸­à¸‡à¹‚à¸¥à¸',
                ],
                [
                    '1079784281419862021',
                    'tweet',
                    'ğ™ƒğ˜¼ğ™‹ğ™‹ğ™” ğ™‰ğ™€ğ™’ ğ™”ğ™€ğ˜¼ğ™ ğŸ®ğŸ¬ğŸ­ğŸµ ğŸŒ»ğŸ’›\nğ‘€ğ‘ğ‘¦ ğŸ¤ğŸ¢ğŸ£ğŸ« ğ‘ğ‘’ ğ‘¡ğ˜©ğ‘’ ğ‘¦ğ‘’ğ‘ğ‘Ÿ ğ‘¤ğ˜©ğ‘’ğ‘› ğ‘ğ‘™ğ‘™ ğ‘¦ğ‘œğ‘¢ğ‘Ÿ ğ‘‘ğ‘Ÿğ‘’ğ‘ğ‘šğ‘  ğ‘ğ‘œğ‘šğ‘’ ğ‘¡ğ‘Ÿğ‘¢ğ‘’, ğ‘ğ‘™ğ‘™ ğ‘¦ğ‘œğ‘¢ğ‘Ÿ ğ˜©ğ‘ğ‘Ÿğ‘‘ ğ‘¤ğ‘œğ‘Ÿğ‘˜ ğ‘Ÿğ‘’ğ‘ğ‘ ğ‘”ğ‘Ÿğ‘’ğ‘ğ‘¡ ğ‘Ÿğ‘’ğ‘ ğ‘¢ğ‘™ğ‘¡ğ‘  ğ‘ğ‘›ğ‘‘ ğ‘Ÿğ‘’ğ‘¤ğ‘ğ‘Ÿğ‘‘ğ‘ . ğ»ğ‘ğ‘ğ‘ğ‘¦ ğ‘ğ‘’ğ‘¤ ğ‘Œğ‘’ğ‘ğ‘Ÿ. #JANUARYWISH https://t.co/wBHjlps4hQ',
                    '2019-01-01 00:00:08',
                    '4715',
                    'twitter',
                    '986274954030137344',
                    'à¸›à¹‰à¸­à¸à¹à¸›à¹‰à¸',
                ],
            ],
        )

    def test_be_able_to_restruct_csv_data(self):
        reader = Reader()
        writer = Writer()
        obj = Copy(reader, writer)
        destination_source = 'test/output_file/csv_format.csv'
        obj.restruct_csv('test/input_file/csv_format', destination_source)
        with open(destination_source, 'r') as reader:
            actual = reader.read()
        self.assertEqual(
            'id,type,message,time,engagement,channel,owner id,owner name\n1079784248717070336,tweet,"dear past ,\nthank you for all the lessons.\n\n.\n#HappyNewYear2019 https://t.co/LNIo1hGeoR",2019-01-01 00:00:00,5209,twitter,1192256738,Maink à¸¡à¸­à¸‡à¹‚à¸¥à¸\n1079784281419862021,tweet,"ğ™ƒğ˜¼ğ™‹ğ™‹ğ™” ğ™‰ğ™€ğ™’ ğ™”ğ™€ğ˜¼ğ™ ğŸ®ğŸ¬ğŸ­ğŸµ ğŸŒ»ğŸ’›\nğ‘€ğ‘ğ‘¦ ğŸ¤ğŸ¢ğŸ£ğŸ« ğ‘ğ‘’ ğ‘¡ğ˜©ğ‘’ ğ‘¦ğ‘’ğ‘ğ‘Ÿ ğ‘¤ğ˜©ğ‘’ğ‘› ğ‘ğ‘™ğ‘™ ğ‘¦ğ‘œğ‘¢ğ‘Ÿ ğ‘‘ğ‘Ÿğ‘’ğ‘ğ‘šğ‘  ğ‘ğ‘œğ‘šğ‘’ ğ‘¡ğ‘Ÿğ‘¢ğ‘’, ğ‘ğ‘™ğ‘™ ğ‘¦ğ‘œğ‘¢ğ‘Ÿ ğ˜©ğ‘ğ‘Ÿğ‘‘ ğ‘¤ğ‘œğ‘Ÿğ‘˜ ğ‘Ÿğ‘’ğ‘ğ‘ ğ‘”ğ‘Ÿğ‘’ğ‘ğ‘¡ ğ‘Ÿğ‘’ğ‘ ğ‘¢ğ‘™ğ‘¡ğ‘  ğ‘ğ‘›ğ‘‘ ğ‘Ÿğ‘’ğ‘¤ğ‘ğ‘Ÿğ‘‘ğ‘ . ğ»ğ‘ğ‘ğ‘ğ‘¦ ğ‘ğ‘’ğ‘¤ ğ‘Œğ‘’ğ‘ğ‘Ÿ. #JANUARYWISH https://t.co/wBHjlps4hQ",2019-01-01 00:00:08,4715,twitter,986274954030137344,à¸›à¹‰à¸­à¸à¹à¸›à¹‰à¸\n',
            actual,
        )

    def test_be_able_to_restruct_csv_file_when_owner_name_is_seperate_line(self):
        reader = Reader()
        writer = Writer()
        obj = Copy(reader, writer)
        destination_source = 'test/output_file/csv_owner_name_has_new_line_in_between.csv'
        obj.restruct_csv(
            'test/input_file/csv_owner_name_has_new_line_in_between', destination_source
        )
        with open(destination_source, 'r') as reader:
            actual = reader.read()
        self.assertEqual(
            'id,type,message,time,engagement,channel,owner id,owner name\n1079784248112951296,reply,@PNchP_ à¹€à¸ªà¸µà¸¢à¸ˆà¸±à¸¢à¸­à¸° à¹€à¸à¸·à¹ˆà¸­à¸™à¸‡à¸±à¸¢ à¸™à¸µà¹ˆà¹€à¸à¸·à¹ˆà¸­à¸™à¹€à¸­à¸‡,2019-01-01 00:00:00,560,twitter,1904452146,à¸«à¸¡à¸µà¸Šà¸¡à¸à¸¹\npcnk_2hand_Bvo-Iy3g7gw,post,"ğŸŒ»ğŸŒ»ğŸŒ» à¹€à¸ªà¸·à¹‰à¸­à¸™à¹ˆà¸²à¸£à¸±à¸à¸œà¹‰à¸²à¹ƒà¸ªà¹ˆà¸ªà¸šà¸²à¸¢ 50à¸¿ . ğŸ“Œ âœ¨à¸¥à¸—à¸š 30 ems 50\nâœ¨à¹€à¸à¸‡à¸¢à¸µà¸™à¸ªà¹Œ 40 ems 60\n\n__________________________\nà¸à¸•à¸´à¸à¸²ğŸ“¢ğŸ“¢ğŸ“¢ â€¼ï¸â€¼ï¸ à¹€à¸­à¸Ÿà¹ƒà¸•à¹‰à¸£à¸¹à¸› à¸«à¸£à¸·à¸­à¸—à¸±à¸à¸«à¸²à¹à¸¡à¹ˆà¸„à¹‰à¸²à¹„à¸”à¹‰à¹€à¸¥à¸¢à¸™à¹‰à¸²à¸²à¸²â€¼ï¸â€¼ï¸ âŒà¹€à¸­à¸Ÿà¸à¹ˆà¸­à¸™à¹‚à¸­à¸™à¸à¹ˆà¸­à¸™à¸ªà¹ˆà¸‡à¸à¹ˆà¸­à¸™ à¸‡à¸”à¸”à¸£à¸²à¸¡à¹ˆà¸²à¸ˆà¹‰à¸²à¸²à¸²âŒ ğŸ™ğŸ»à¸à¸£à¹‰à¸­à¸¡à¹‚à¸­à¸™à¸„à¹ˆà¸­à¸¢à¸—à¸±à¸à¸¡à¸²à¸™à¸°à¸„à¸° à¹„à¸¡à¹ˆà¹€à¸­à¸Ÿà¹€à¸¥à¹ˆà¸™à¸™à¹‰à¸²à¸²à¸²ğŸ™ğŸ» #à¹€à¸ªà¸·à¹‰à¸­à¸œà¹‰à¸²à¸¡à¸·à¸­à¸ªà¸­à¸‡ #à¹‚à¸¥à¹Šà¸°à¸•à¸¹à¹‰ #à¹€à¸ªà¸·à¹‰à¸­à¸œà¹‰à¸²à¹à¸Ÿà¸Šà¸±à¹ˆà¸™ #à¹€à¸ªà¸·à¹‰à¸­à¸œà¹‰à¸² #à¹‚à¸¥à¹Šà¸°à¸•à¸¹à¹‰à¹€à¸ªà¸·à¹‰à¸­à¸œà¹‰à¸²à¸¡à¸·à¸­à¸ªà¸­à¸‡ #à¸ªà¹ˆà¸‡à¸•à¹ˆà¸­à¹€à¸ªà¸·à¹‰à¸­à¸œà¹‰à¸²à¸¡à¸·à¸­à¸ªà¸­à¸‡ #à¹‚à¸¥à¹Šà¸°à¸•à¸¹à¹‰à¹€à¸ªà¸·à¹‰à¸­à¸œà¹‰à¸² #à¹‚à¸¥à¹Šà¸°à¹€à¸ªà¸·à¹‰à¸­à¸œà¹‰à¸² #à¹€à¸ªà¸·à¹‰à¸­à¸œà¹‰à¸²à¸ªà¸§à¸¢à¹† #2hand #à¸ªà¹ˆà¸‡à¸•à¹ˆà¸­à¸ªà¸ à¸²à¸à¸™à¸²à¸‡à¸Ÿà¹‰à¸² #à¸ªà¹ˆà¸‡à¸•à¹ˆà¸­ #à¹€à¸ªà¸·à¹‰à¸­à¸œà¹‰à¸²à¸–à¸¹à¸à¹† #à¹€à¸ªà¸·à¹‰à¸­à¸œà¹‰à¸²à¸¡à¸·à¸­2 #à¹€à¸ªà¸·à¹‰à¸­à¸œà¹‰à¸²à¸£à¸²à¸„à¸²à¸–à¸¹à¸ #à¹€à¸ªà¸·à¹‰à¸­à¸œà¹‰à¸²à¸£à¸²à¸„à¸²à¸–à¸¹à¸à¸à¸£à¹‰à¸­à¸¡à¸ªà¹ˆà¸‡ #à¹€à¸ªà¸·à¹‰à¸­à¸œà¹‰à¸²à¸£à¸²à¸„à¸²à¹€à¸šà¸²à¹† #à¸ªà¸ à¸²à¸à¸™à¸²à¸‡à¸Ÿà¹‰à¸² #à¸¡à¸·à¸­à¸ªà¸­à¸‡à¸ªà¸ à¸²à¸à¸”à¸µ #à¸¡à¸·à¸­à¸ªà¸­à¸‡à¸£à¸²à¸„à¸²à¸–à¸¹à¸ #à¸à¸²à¸‡à¹€à¸à¸‡ #à¸§à¸´à¸™à¹€à¸—à¸ˆ #à¹€à¸à¸‡à¸¢à¸µà¸™à¸ªà¹Œ #à¸à¸²à¸‡à¹€à¸à¸‡à¸–à¸¹à¸à¹† #2hand  #2handthailand #à¸¡à¸·à¸­à¸ªà¸­à¸‡ #à¸§à¸´à¸™à¹€à¸—à¸ˆ #à¸£à¸²à¸„à¸²à¸–à¸¹à¸ #à¹€à¸ªà¸·à¹‰à¸­à¸œà¹‰à¸²à¸™à¹ˆà¸²à¸£à¸±à¸",2019-03-31 00:04:21,3860,instagram,10677434124,"HELLO ğŸ‘‹ \nà¹€à¸ªà¸·à¹‰à¸­à¸œà¹‰à¸²à¸¡à¸·à¸­ 1,2ğŸ‘•ğŸ‘—"\n1112038291539263489,tweet,à¸‹à¸·à¹‰à¸­à¸šà¸±à¸•à¸£ cat6 à¸”à¸µà¸¡à¹ˆà¸° à¸«à¸£à¸·à¸­à¸ˆà¸°à¹€à¸à¹‡à¸šà¹€à¸‡à¸´à¸™à¹„à¸›à¸‹à¸·à¹‰à¸­à¸‚à¸­à¸‡ cat t-shirt,2019-03-31 00:06:04,315,twitter,267263658,à¸¡à¸¸à¸à¸ªà¸¸à¹€à¸•à¸£à¸µà¸¢à¸¡à¸‚à¸¶à¹‰à¸™à¸§à¸­à¸£à¹Œà¸”med\n',
            actual,
        )

    def test_be_able_to_write_data_into_file_with_csv_format(self):
        reader = Reader()
        writer = Writer()
        obj = Copy(reader, writer)
        obj.construct('test/input_file/basic_line')
        output_path = 'test/output_file/basic_data_to_csv'
        obj.to_csv(output_path)
        with open(output_path, 'r') as reader:
            expect = reader.read()
        self.assertEqual(
            '1079784248112951296,reply,@PNchP_ à¹€à¸ªà¸µà¸¢à¸ˆà¸±à¸¢à¸­à¸° à¹€à¸à¸·à¹ˆà¸­à¸™à¸‡à¸±à¸¢ à¸™à¸µà¹ˆà¹€à¸à¸·à¹ˆà¸­à¸™à¹€à¸­à¸‡,2019-01-01 00:00:00,560,twitter,1904452146,à¸«à¸¡à¸µà¸Šà¸¡à¸à¸¹\n',
            expect,
        )
