import unittest
from morphling.input import Reader
from morphling.copy import Copy
from morphling.output import Writer


class TestCopyData(unittest.TestCase):
    def test_be_able_to_create_data_struct_from_intput_data(self):
        reader = Reader()
        writer = Writer()
        obj = Copy(reader, writer)
        obj.construct('test/input_file/basic_line')
        actual = obj.data
        self.assertEqual(
            actual,
            [
                [
                    '1079784248112951296',
                    'reply',
                    '@PNchP_ ‡πÄ‡∏™‡∏µ‡∏¢‡∏à‡∏±‡∏¢‡∏≠‡∏∞ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏á‡∏±‡∏¢ ‡∏ô‡∏µ‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÄ‡∏≠‡∏á',
                    '2019-01-01 00:00:00',
                    '560',
                    'twitter',
                    '1904452146',
                    '‡∏´‡∏°‡∏µ‡∏ä‡∏°‡∏û‡∏π',
                ]
            ],
        )

    def test_ba_able_to_create_data_struct_when_there_are_space_between_message(self):
        reader = Reader()
        writer = Writer()
        obj = Copy(reader, writer)
        obj.construct('test/input_file/space_between_message')
        actual = obj.data
        self.assertEqual(
            actual,
            [
                [
                    '079784245067829254',
                    'tweet',
                    'Happy New Years 2019üéâüéâ ‡∏ô‡∏∞‡∏Ñ‡∏∞‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô ‡∏õ‡∏µ‡∏ô‡∏µ‡πâ‡∏Å‡πá‡∏Ç‡∏≠‡∏ù‡∏≤‡∏Å‡∏ï‡∏±‡∏ß‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡πà‡∏∞!\n‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß‡∏ñ‡πâ‡∏≤‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏´‡∏£‡∏∑‡∏≠‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÑ‡∏°‡πà‡∏û‡∏≠‡πÉ‡∏à‡∏≠‡∏∞‡πÑ‡∏£‡πÑ‡∏õ‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡πÇ‡∏ó‡∏©‡∏î‡πâ‡∏ß‡∏¢‡∏ô‡∏∞‡∏Ñ‡∏∞üôè\n‡∏î‡∏µ‡πÉ‡∏à‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å‡∏Å‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡∏Ñ‡πà‡∏∞ ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡πá‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏°‡∏≤‡πÄ‡∏ß‡∏¥‡πà‡∏ô‡πÄ‡∏ß‡πâ‡∏≠‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô‡∏ô‡∏∞‡∏Ñ‡∏∞ ‡∏î‡∏µ‡πÉ‡∏à‡∏°‡∏≤‡∏Å‡πÄ‡∏•‡∏¢',
                    '2019-01-01 00:00:00',
                    '9857',
                    'twitter',
                    '2161099140',
                    'üéÑFreSan‚òï59 days countdown to wmtsb3',
                ]
            ],
        )

    def test_be_able_to_create_data_when_there_is_comma_between_message(self):
        reader = Reader()
        writer = Writer()
        obj = Copy(reader, writer)
        obj.construct('test/input_file/comma_between_message')
        actual = obj.data
        self.assertEqual(
            actual,
            [
                [
                    '1079784248717070336',
                    'tweet',
                    'dear past ,\nthank you for all the lessons.\n\n.\n#HappyNewYear2019 https://t.co/LNIo1hGeoR',
                    '2019-01-01 00:00:00',
                    '5209',
                    'twitter',
                    '1192256738',
                    'Maink ‡∏°‡∏≠‡∏á‡πÇ‡∏•‡∏Å',
                ]
            ],
        )

    def test_be_able_to_construct_when_owner_id_is_emoji(self):
        reader = Reader()
        writer = Writer()
        obj = Copy(reader, writer)
        obj.construct('test/input_file/owner_name_end_with_emoji')
        actual = obj.data
        self.assertEqual(
            actual,
            [
                [
                    '1079784244640010240',
                    'tweet',
                    '‡∏à‡∏∏‡∏î‡∏û‡∏•‡∏∏‡∏Å‡∏±‡∏ô‡∏™‡∏ô‡∏∏‡∏Å‡∏°‡∏≤‡∏Å‡∏ô‡∏∞',
                    '2019-01-01 00:00:00',
                    '9672',
                    'twitter',
                    '1013618778',
                    'üíñ',
                ]
            ],
        )

    def test_be_able_to_construct_data_when_owner_name_has_newline_in_between(self):
        reader = Reader()
        writer = Writer()
        obj = Copy(reader, writer)
        obj.construct('test/input_file/owner_name_has_new_line_in_between')
        actual = obj.data
        self.assertEqual(
            actual,
            [
                [
                    'skincarebymild__BuMRKW4FQyG',
                    'post',
                    '‡∏ï‡∏≤‡∏°‡∏´‡∏≤‡∏Å‡∏±‡∏ô‡πÅ‡∏î‡∏î‡∏≠‡∏¢‡∏π‡πà‡∏°‡∏≤‡∏ó‡∏≤‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏î‡πâ‡∏≠üíö\n‡∏Å‡∏±‡∏ô‡πÅ‡∏î‡∏î‡∏ã‡∏±‡∏ô‡∏Ñ‡∏¥‡∏™ ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏á‡∏≤ ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÉ‡∏ä‡πâ‡∏ó‡∏≤‡πÑ‡∏õ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Å‡πá‡πÑ‡∏î‡πâ‡πÑ‡∏°‡πà‡∏ß‡∏≠‡∏Å ‡∏ó‡∏≤‡πÑ‡∏î‡πâ‡∏ó‡∏∏‡∏Å‡∏™‡∏†‡∏≤‡∏û‡∏ú‡∏¥‡∏ß ‡πÄ‡∏Å‡∏•‡∏µ‡πà‡∏¢‡∏á‡πà‡∏≤‡∏¢ ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏±‡∏ô‡πÅ‡∏î‡∏î‡∏ú‡∏™‡∏°‡πÇ‡∏õ‡∏£‡∏ï‡∏µ‡∏ô‡πÑ‡∏´‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡πâ‡∏≤ spf50 pa+++ üå§\n#‡∏î‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏•‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÅ‡∏•‡πâ‡∏ß .\n~~~~~~~~~~~~~~~~~~~~~~~~~~~\n.\n‚òÄÔ∏è‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏° | ‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ | ‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡∏ü‡∏£‡∏µüåµ\nüåàLine ID : @zik7826z\nüçì‡∏´‡∏£‡∏∑‡∏≠ ‡πÑ‡∏î‡πÄ‡∏£‡∏Å ig\n#skinc√§rebymild\n.\n.\n. .\n.\n.\n.\n.\n#‡∏•‡∏¥‡∏õ‡∏°‡∏≤‡∏£‡πå‡∏Ñ #‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô #‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤ #‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡πâ‡∏≤ #‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏õ‡∏≤‡∏Å #laneige #‡∏™‡∏•‡∏¥‡∏õ‡∏õ‡∏¥‡πâ‡∏á‡∏°‡∏≤‡∏£‡πå‡∏Ñ #‡∏•‡∏≤‡πÄ‡∏ô‡∏à‡∏Ç‡∏≠‡∏á‡πÅ‡∏ó‡πâ #‡∏•‡∏≤‡πÄ‡∏ô‡∏à #‡∏â‡∏±‡∏ô‡∏à‡∏∞‡∏™‡∏ß‡∏¢ #‡∏ã‡∏±‡∏ô‡∏Ñ‡∏¥‡∏™ #sunkiss',
                    '2019-02-23 00:01:13',
                    '8443',
                    'instagram',
                    '9188904578',
                    '‚ô°ùëªùíÜùíîùíïùíÜùíì ‚Ä¢ ùíçùíÇùíèùíÜùíäùíàùíÜ ‚Ä¢ \nùë∫ùíñùíèùíåùíäùíîùíî\n',
                ],
                [
                    '1079784248112951296',
                    'reply',
                    '@PNchP_ ‡πÄ‡∏™‡∏µ‡∏¢‡∏à‡∏±‡∏¢‡∏≠‡∏∞ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏á‡∏±‡∏¢ ‡∏ô‡∏µ‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÄ‡∏≠‡∏á',
                    '2019-01-01 00:00:00',
                    '560',
                    'twitter',
                    '1904452146',
                    '‡∏´‡∏°‡∏µ‡∏ä‡∏°‡∏û‡∏π',
                ],
                [
                    'pcnk_2hand_Bvo-Iy3g7gw',
                    'post',
                    'üåªüåªüåª ‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ô‡πà‡∏≤‡∏£‡∏±‡∏Å‡∏ú‡πâ‡∏≤‡πÉ‡∏™‡πà‡∏™‡∏ö‡∏≤‡∏¢ 50‡∏ø . üìå ‚ú®‡∏•‡∏ó‡∏ö 30 ems 50\n‚ú®‡πÄ‡∏Å‡∏á‡∏¢‡∏µ‡∏ô‡∏™‡πå 40 ems 60\n\n__________________________\n‡∏Å‡∏ï‡∏¥‡∏Å‡∏≤üì¢üì¢üì¢ ‚ÄºÔ∏è‚ÄºÔ∏è ‡πÄ‡∏≠‡∏ü‡πÉ‡∏ï‡πâ‡∏£‡∏π‡∏õ ‡∏´‡∏£‡∏∑‡∏≠‡∏ó‡∏±‡∏Å‡∏´‡∏≤‡πÅ‡∏°‡πà‡∏Ñ‡πâ‡∏≤‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏ô‡πâ‡∏≤‡∏≤‡∏≤‚ÄºÔ∏è‚ÄºÔ∏è ‚ùå‡πÄ‡∏≠‡∏ü‡∏Å‡πà‡∏≠‡∏ô‡πÇ‡∏≠‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á‡∏Å‡πà‡∏≠‡∏ô ‡∏á‡∏î‡∏î‡∏£‡∏≤‡∏°‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏≤‡∏≤‚ùå üôèüèª‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÇ‡∏≠‡∏ô‡∏Ñ‡πà‡∏≠‡∏¢‡∏ó‡∏±‡∏Å‡∏°‡∏≤‡∏ô‡∏∞‡∏Ñ‡∏∞ ‡πÑ‡∏°‡πà‡πÄ‡∏≠‡∏ü‡πÄ‡∏•‡πà‡∏ô‡∏ô‡πâ‡∏≤‡∏≤‡∏≤üôèüèª #‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤‡∏°‡∏∑‡∏≠‡∏™‡∏≠‡∏á #‡πÇ‡∏•‡πä‡∏∞‡∏ï‡∏π‡πâ #‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô #‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤ #‡πÇ‡∏•‡πä‡∏∞‡∏ï‡∏π‡πâ‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤‡∏°‡∏∑‡∏≠‡∏™‡∏≠‡∏á #‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤‡∏°‡∏∑‡∏≠‡∏™‡∏≠‡∏á #‡πÇ‡∏•‡πä‡∏∞‡∏ï‡∏π‡πâ‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤ #‡πÇ‡∏•‡πä‡∏∞‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤ #‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤‡∏™‡∏ß‡∏¢‡πÜ #2hand #‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠‡∏™‡∏†‡∏≤‡∏û‡∏ô‡∏≤‡∏á‡∏ü‡πâ‡∏≤ #‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠ #‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤‡∏ñ‡∏π‡∏Å‡πÜ #‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤‡∏°‡∏∑‡∏≠2 #‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ñ‡∏π‡∏Å #‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ñ‡∏π‡∏Å‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡πà‡∏á #‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏ö‡∏≤‡πÜ #‡∏™‡∏†‡∏≤‡∏û‡∏ô‡∏≤‡∏á‡∏ü‡πâ‡∏≤ #‡∏°‡∏∑‡∏≠‡∏™‡∏≠‡∏á‡∏™‡∏†‡∏≤‡∏û‡∏î‡∏µ #‡∏°‡∏∑‡∏≠‡∏™‡∏≠‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ñ‡∏π‡∏Å #‡∏Å‡∏≤‡∏á‡πÄ‡∏Å‡∏á #‡∏ß‡∏¥‡∏ô‡πÄ‡∏ó‡∏à #‡πÄ‡∏Å‡∏á‡∏¢‡∏µ‡∏ô‡∏™‡πå #‡∏Å‡∏≤‡∏á‡πÄ‡∏Å‡∏á‡∏ñ‡∏π‡∏Å‡πÜ #2hand  #2handthailand #‡∏°‡∏∑‡∏≠‡∏™‡∏≠‡∏á #‡∏ß‡∏¥‡∏ô‡πÄ‡∏ó‡∏à #‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ñ‡∏π‡∏Å #‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤‡∏ô‡πà‡∏≤‡∏£‡∏±‡∏Å',
                    '2019-03-31 00:04:21',
                    '3860',
                    'instagram',
                    '10677434124',
                    'HELLO üëã \n‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤‡∏°‡∏∑‡∏≠ 1,2üëïüëó\n',
                ],
                [
                    '1112038291539263489',
                    'tweet',
                    '‡∏ã‡∏∑‡πâ‡∏≠‡∏ö‡∏±‡∏ï‡∏£ cat6 ‡∏î‡∏µ‡∏°‡πà‡∏∞ ‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏∞‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏õ‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á cat t-shirt',
                    '2019-03-31 00:06:04',
                    '315',
                    'twitter',
                    '267263658',
                    '‡∏°‡∏∏‡∏Å‡∏™‡∏∏‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡∏ß‡∏≠‡∏£‡πå‡∏îmed',
                ],
            ],
        )

    def test_be_able_to_construct_from_multiple_line(self):
        reader = Reader()
        writer = Writer()
        obj = Copy(reader, writer)
        obj.construct('test/input_file/multiple_line')
        actual = obj.data
        self.assertEqual(
            actual,
            [
                [
                    '1079784244640010240',
                    'tweet',
                    '‡∏à‡∏∏‡∏î‡∏û‡∏•‡∏∏‡∏Å‡∏±‡∏ô‡∏™‡∏ô‡∏∏‡∏Å‡∏°‡∏≤‡∏Å‡∏ô‡∏∞',
                    '2019-01-01 00:00:00',
                    '9672',
                    'twitter',
                    '1013618778',
                    'üíñ',
                ],
                [
                    '1079784248112951296',
                    'reply',
                    '@PNchP_ ‡πÄ‡∏™‡∏µ‡∏¢‡∏à‡∏±‡∏¢‡∏≠‡∏∞ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏á‡∏±‡∏¢ ‡∏ô‡∏µ‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÄ‡∏≠‡∏á',
                    '2019-01-01 00:00:00',
                    '560',
                    'twitter',
                    '1904452146',
                    '‡∏´‡∏°‡∏µ‡∏ä‡∏°‡∏û‡∏π',
                ],
                [
                    '1079784248717070336',
                    'tweet',
                    'dear past ,\nthank you for all the lessons.\n\n.\n#HappyNewYear2019 https://t.co/LNIo1hGeoR',
                    '2019-01-01 00:00:00',
                    '5209',
                    'twitter',
                    '1192256738',
                    'Maink ‡∏°‡∏≠‡∏á‡πÇ‡∏•‡∏Å',
                ],
                [
                    '2104171073012154_2104263833002878',
                    'comment',
                    '',
                    '2019-03-31 00:06:02',
                    '7434',
                    'facebook',
                    '00000000',
                    'Unknown',
                ],
                [
                    'kpw_VFen_oJpn_Bvo-',
                    'post',
                    '#KRISTPERAWATSKY\n‚Ä¢‚Ä¢\n‚Ä¢‚Ä¢\nCr. Twitter : niitnoii \n‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏π‡∏£‡∏π‡∏õ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡∏ß‡∏¥‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏µ‡πâ‡∏ô‡πâ‡∏≤‡∏≤\n#kristtps #kristperawat\n#‡∏û‡∏•‡∏ó‡∏´‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏Å‡πâ‡∏≠‡∏ô #thxpic #‡∏¢‡∏¢‡∏Ç‡∏Ñ‡∏û',
                    '2019-03-31 00:06:02',
                    '1662',
                    'instagram',
                    '4484800865',
                    'kristtppraew_fc',
                ],
                [
                    'ultraviyolehi_Bvo-Qponcnp',
                    'post',
                    'Sen nasƒ±l b√∂yle yakƒ±≈üƒ±klƒ± oldun kolyeni yerim senin. A≈üka geldim md√∂smd\n\n#tawan_v #taytawan #newwiee #newthitipoom #taynew #petekao #OurSkyy #kissmeagain #darkbluekiss #TayNewMealDate #GMM25 #GMMTV #LineTV #bl #blseries #oishi #thaiseries #thaiboy #thaiactor #‡∏Æ‡∏±‡∏ô‡∏ô‡∏µ‡πà #polca #‡πÄ‡∏ï‡∏ô‡∏¥‡∏ß #boyslove #cuteboys\n#taynew #taytawan  #newwietitiphoom  #kissmeagain #darkbluekiss #kristsingto #sotusstheseries  #addictedwebseries\n#addicted',
                    '2019-03-31 00:06:02',
                    '1630',
                    'instagram',
                    '11594034019',
                    'ultraviyolehi',
                ],
            ],
        )

    def test_be_able_to_construct_data_when_message_contain_datetime(self):
        reader = Reader()
        writer = Writer()
        obj = Copy(reader, writer)
        obj.construct('test/input_file/messge_contain_datetime')
        actual = obj.data
        self.assertEqual(
            actual,
            [
                [
                    '1079784250675613698',
                    'tweet',
                    '2019-01-01 00:00:01\n6. Chiang Rai\n7. #NHKÁ¥ÖÁôΩ\n8. #ICONSIAM\n9. #‡∏≠‡∏¢‡∏≤‡∏Å‡∏ö‡∏≠‡∏Å‡∏≠‡∏∞‡πÑ‡∏£yg‡∏Å‡πà‡∏≠‡∏ô‡∏õ‡∏µ‡πÉ‡∏´‡∏°‡πà‡∏°‡∏±‡πâ‡∏¢\n10. #‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô‡πÑ‡∏´‡∏ß',
                    '2019-01-01 00:00:01',
                    '880',
                    'twitter',
                    '837126367779008512',
                    'TopTrendThai',
                ],
                [
                    '1108050502279819265',
                    'tweet',
                    '2019-03-20 00:00:00 6. toy story 4 7. Blind Trust 8. #‡∏•‡∏î‡πÇ‡∏•‡∏Å‡πÄ‡∏•‡∏≠‡∏∞‡∏Å‡∏±‡∏ö‡∏ú‡∏•‡∏¥‡∏ï 9. #‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏î‡πá‡∏Å‡πÅ‡∏°‡∏ß 10. #OCLOCK',
                    '2019-03-20 00:00:00',
                    '4132',
                    'twitter',
                    '837126367779008512',
                    'TopTrendThai',
                ],
                [
                    '1108051014274314240',
                    'tweet',
                    'Rank 1 Youtube Trend 2019-03-20 00:02:01 ‡πÄ‡∏•‡∏¥‡∏Å‡∏Ñ‡∏∏‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ò‡∏≠‡∏Ñ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß - ‡∏•‡∏¥‡∏•‡∏•‡∏µ‡πà ‡πÑ‡∏î‡πâ‡∏´‡∏°‡∏î‡∏ñ‡πâ‡∏≤‡∏™‡∏î‡∏ä‡∏∑‡πà‡∏ô Feat.‡πÄ‡∏Å‡πâ‡∏≤ ‡πÄ‡∏Å‡∏£‡∏¥‡∏Å‡∏û‡∏• [OFFICIAL MV„Äë',
                    '2019-03-20 00:02:03',
                    '8075',
                    'twitter',
                    '837126367779008512',
                    'TopTrendThai',
                ],
                [
                    '1102252313303904256',
                    'reply',
                    '@icez ‡∏ô‡∏¥‡∏¢‡∏≤‡∏¢‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó: Dreamcatcher : Corona Australis Academy (2019-03-03 23:59:14) https://t.co/7BUEIV1s2e',
                    '2019-03-04 00:00:05',
                    '2287',
                    'twitter',
                    '254500720',
                    'icez network',
                ],
                [
                    '1102614688255238144',
                    'tweet',
                    'Twitter Trend\n2019-03-05 00:00:01\n1. #thevoiceTH\n2. #‡∏Å‡∏£‡∏á‡∏Å‡∏£‡∏£‡∏°\n3. #‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πåShock‡πÇ‡∏•‡∏Å‡∏¢‡∏±‡∏á‡πÑ‡∏á‡∏ã‡∏¥\n4. #‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏®‡∏¥‡∏•‡∏≤\n5. #‡∏î‡∏µ‡πÉ‡∏à‡∏î‡πâ‡∏ß‡∏¢‡∏ô‡∏∞',
                    '2019-03-05 00:00:01',
                    '7406',
                    'twitter',
                    '837126367779008512',
                    'TopTrendThai',
                ],
                [
                    '38667962',
                    'post',
                    '‡∏•‡∏á Skyrim ‡πÉ‡∏ô Steam ‡πÉ‡∏´‡∏°‡πà ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏ß‡πà‡∏≤‡∏≠‡∏¢‡∏π‡πà‡∏î‡∏µ‡πÜ ‡∏ï‡∏±‡∏ß‡πÄ‡∏Å‡∏°‡∏°‡∏±‡∏ô‡∏´‡∏≤‡∏¢‡πÑ‡∏õ(‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏Å‡∏î Uninstall ‡πÄ‡∏•‡∏¢) ‡πÅ‡∏•‡∏∞‡∏≠‡∏¢‡∏≤‡∏Å‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÄ‡∏•‡πà‡∏ô‡πÉ‡∏´‡∏°‡πà<br />\n<br />\n‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡∏ß‡πà‡∏≤ ‡∏°‡∏±‡∏ô‡∏•‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ....‡πÅ‡∏•‡∏∞‡∏°‡∏±‡∏ô‡∏à‡∏∞‡∏™‡∏∏‡πà‡∏° Error ‡∏°‡∏≤ ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ô ‡πÄ‡∏ä‡πà‡∏ô<br />\n<br />\n‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô‡∏î‡∏¥‡∏™‡∏Å‡πå‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î<br />\n‡∏î‡∏¥‡∏™‡∏Å‡πå‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢<br />\n‡πÑ‡∏ü‡∏•‡πå‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢<br />\n<br />\n<img class="img-in-post" src="https://f.ptcdn.info/021/063/000/poirsfi8dCQ9zZa5TZW-o.png" data-image="img:544x139" /> <img class="img-in-post" src="https://f.ptcdn.info/021/063/000/poirsfudeCJ0LMlJDJ5-o.png" data-image="img:520x119" /> <img class="img-in-post" src="https://f.ptcdn.info/021/063/000/poirsf82a0yD1Uowr6G-o.png" data-image="img:492x125" /><br />\n‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏Å‡πá‡∏•‡∏≠‡∏á....<br />\n<br />\n- ‡πÉ‡∏´‡πâ Steam ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏Å‡∏°<br />\n- ‡∏•‡∏ö‡πÅ‡∏•‡πâ‡∏ß‡∏•‡∏á‡πÉ‡∏´‡∏°‡πà(‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ Steam ‡∏Ñ‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏Å‡∏°‡πÅ‡∏ö‡∏ö‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏Å‡πà‡∏≠‡∏ô ‡∏Ñ‡∏∑‡∏≠‡∏•‡∏á‡πÅ‡∏ö‡∏ö Clean ‡πÄ‡∏•‡∏¢)<br />\n- ‡∏•‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ ‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠ dragonborn.bsa ‡πÅ‡∏•‡∏∞ HighResTexturePack03.bsa ‡∏≠‡∏≠‡∏Å ‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏´‡πâ Steam ‡∏Ñ‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏°‡πà<br />\n- ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á chkdsk ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ó‡∏≥‡∏ã‡πâ‡∏≥‡∏Ç‡πâ‡∏≠ 1-3<br />\n- ‡∏Å‡πá‡∏≠‡∏õ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏°‡∏±‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô Error ‡∏à‡∏≤‡∏Å‡∏≠‡∏µ‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏≤‡∏•‡∏á‡∏ó‡∏±‡∏ö<br />\n- ‡πÄ‡∏≠‡∏≤ Backup ‡∏à‡∏≤‡∏Å‡∏≠‡∏µ‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏≤‡πÉ‡∏™‡πà<br />\n- ‡∏•‡∏ö‡πÅ‡∏Ñ‡∏ä<br />\n<br />\n‡∏•‡∏≠‡∏á‡∏ó‡∏≥‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡πá‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°<br />\n<br />\n‡πÄ‡∏•‡∏¢‡∏•‡∏≠‡∏á‡πÉ‡∏´‡πâ Steam ‡∏ã‡πà‡∏≠‡∏°‡∏Ñ‡∏•‡∏±‡∏á‡πÄ‡∏Å‡∏°‡πÉ‡∏´‡∏°‡πà‡∏î‡∏π‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á chkdsk ‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡∏ß‡πà‡∏≤‡∏°‡∏±‡∏ô‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏≠‡∏∞‡πÑ‡∏£‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥‡πÄ‡∏•‡∏¢ ‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÅ‡∏à‡πâ‡∏á Error ‡∏°‡∏≤‡∏î‡πâ‡∏ß‡∏¢<br />\n<br />\n<img class="img-in-post" src="https://f.ptcdn.info/021/063/000/poirsfh0zyca8P6sUZ0-o.png" data-image="img:619x895" /> <img class="img-in-post" src="https://f.ptcdn.info/021/063/000/poirsfd93dhT857B5OZ-o.png" data-image="img:1333x625" /> <img class="img-in-post" src="https://f.ptcdn.info/021/063/000/poirsf3bxut0QpNcTSkE-o.png" data-image="img:1327x606" /><br />\n‡πÑ‡∏ü‡∏•‡πå Log ‡πÉ‡∏ô Steam<br />\n<br />\n<img class="img-in-post" src="https://f.ptcdn.info/021/063/000/poirsgn22TFW18ynxbH-o.png" data-image="img:1791x469" /><br />\n<div class="code-style">[2019-03-17 22:36:26] Failed to write chunk in file <br />\n&quot;Data\\HighResTexturePack03.bsa&quot; 1048576 bytes at offset 1013856808 (Device Corrupt)</div><br />\n‡πÑ‡∏°‡πà‡πÑ‡∏´‡∏ß‡πÅ‡∏•‡πâ‡∏ß....‡∏•‡∏≠‡∏á‡∏•‡∏±‡∏Å‡πÑ‡∏Å‡πà ‡∏£‡∏±‡∏ô‡πÄ‡∏Å‡∏°‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á‡∏à‡∏≤‡∏Å SkyrimLauncher.exe ‡∏Å‡πá‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡∏°‡∏±‡∏ô‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡πá‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ<br />\n<br />\n<img class="img-in-post" src="https://f.ptcdn.info/021/063/000/poirx3oooWUW1SUS991-o.png" data-image="img:553x191" /><br />\n‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏∑‡∏≠‡∏•‡∏≠‡∏á‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏ß‡∏£‡∏à‡∏∞‡∏ó‡∏≥‡∏¢‡∏±‡∏á‡πÑ‡∏á‡∏ï‡πà‡∏≠‡∏î‡∏µ??',
                    '2019-03-18 00:01:16',
                    '2344',
                    'pantip',
                    '663452',
                    'MrCatZaa',
                ],
            ],
        )

    def test_be_able_to_construct_data_when_owner_id_is_cha(self):
        reader = Reader()
        writer = Writer()
        obj = Copy(reader, writer)
        obj.construct('test/input_file/owner_id_is_cha')
        actual = obj.data
        self.assertEqual(
            actual,
            [
                [
                    'mifarashita_BsnYvqDhEKM_d1c6e9dd2f6e65209065b5bb7533b02ca0d0fe3d',
                    'comment',
                    '@pansika ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡πà‡∏≤‡∏≤üòò',
                    '2019-01-15 00:02:15',
                    '4462',
                    'instagram',
                    'mifarashita',
                    'mifarashita',
                ],
            ],
        )

    def test_be_able_to_construct_data_from_csv_file(self):
        reader = Reader()
        writer = Writer()
        obj = Copy(reader, writer)
        obj.construct_csv('test/input_file/csv_format')
        actual = obj.data
        self.assertEqual(
            actual,
            [
                [
                    'id',
                    'type',
                    'message',
                    'time',
                    'engagement',
                    'channel',
                    'owner id',
                    'owner name',
                ],
                [
                    '1079784248717070336',
                    'tweet',
                    'dear past ,\nthank you for all the lessons.\n\n.\n#HappyNewYear2019 https://t.co/LNIo1hGeoR',
                    '2019-01-01 00:00:00',
                    '5209',
                    'twitter',
                    '1192256738',
                    'Maink ‡∏°‡∏≠‡∏á‡πÇ‡∏•‡∏Å',
                ],
                [
                    '1079784281419862021',
                    'tweet',
                    'ùôÉùòºùôãùôãùôî ùôâùôÄùôí ùôîùôÄùòºùôç ùüÆùü¨ùü≠ùüµ üåªüíõ\nùëÄùëéùë¶ ùü§ùü¢ùü£ùü´ ùëèùëí ùë°ùò©ùëí ùë¶ùëíùëéùëü ùë§ùò©ùëíùëõ ùëéùëôùëô ùë¶ùëúùë¢ùëü ùëëùëüùëíùëéùëöùë† ùëêùëúùëöùëí ùë°ùëüùë¢ùëí, ùëéùëôùëô ùë¶ùëúùë¢ùëü ùò©ùëéùëüùëë ùë§ùëúùëüùëò ùëüùëíùëéùëù ùëîùëüùëíùëéùë° ùëüùëíùë†ùë¢ùëôùë°ùë† ùëéùëõùëë ùëüùëíùë§ùëéùëüùëëùë†. ùêªùëéùëùùëùùë¶ ùëÅùëíùë§ ùëåùëíùëéùëü. #JANUARYWISH https://t.co/wBHjlps4hQ',
                    '2019-01-01 00:00:08',
                    '4715',
                    'twitter',
                    '986274954030137344',
                    '‡∏õ‡πâ‡∏≠‡∏Å‡πÅ‡∏õ‡πâ‡∏Å',
                ],
            ],
        )

    def test_be_able_to_restruct_csv_data(self):
        reader = Reader()
        writer = Writer()
        obj = Copy(reader, writer)
        destination_source = 'test/output_file/csv_format.csv'
        obj.restruct_csv('test/input_file/csv_format', destination_source)
        with open(destination_source, 'r') as reader:
            actual = reader.read()
        self.assertEqual(
            'id,type,message,time,engagement,channel,owner id,owner name\n1079784248717070336,tweet,"dear past ,\nthank you for all the lessons.\n\n.\n#HappyNewYear2019 https://t.co/LNIo1hGeoR",2019-01-01 00:00:00,5209,twitter,1192256738,Maink ‡∏°‡∏≠‡∏á‡πÇ‡∏•‡∏Å\n1079784281419862021,tweet,"ùôÉùòºùôãùôãùôî ùôâùôÄùôí ùôîùôÄùòºùôç ùüÆùü¨ùü≠ùüµ üåªüíõ\nùëÄùëéùë¶ ùü§ùü¢ùü£ùü´ ùëèùëí ùë°ùò©ùëí ùë¶ùëíùëéùëü ùë§ùò©ùëíùëõ ùëéùëôùëô ùë¶ùëúùë¢ùëü ùëëùëüùëíùëéùëöùë† ùëêùëúùëöùëí ùë°ùëüùë¢ùëí, ùëéùëôùëô ùë¶ùëúùë¢ùëü ùò©ùëéùëüùëë ùë§ùëúùëüùëò ùëüùëíùëéùëù ùëîùëüùëíùëéùë° ùëüùëíùë†ùë¢ùëôùë°ùë† ùëéùëõùëë ùëüùëíùë§ùëéùëüùëëùë†. ùêªùëéùëùùëùùë¶ ùëÅùëíùë§ ùëåùëíùëéùëü. #JANUARYWISH https://t.co/wBHjlps4hQ",2019-01-01 00:00:08,4715,twitter,986274954030137344,‡∏õ‡πâ‡∏≠‡∏Å‡πÅ‡∏õ‡πâ‡∏Å\n',
            actual,
        )

    def test_be_able_to_restruct_csv_file_when_owner_name_is_seperate_line(self):
        reader = Reader()
        writer = Writer()
        obj = Copy(reader, writer)
        destination_source = 'test/output_file/csv_owner_name_has_new_line_in_between.csv'
        obj.restruct_csv(
            'test/input_file/csv_owner_name_has_new_line_in_between', destination_source
        )
        with open(destination_source, 'r') as reader:
            actual = reader.read()
        self.assertEqual(
            'id,type,message,time,engagement,channel,owner id,owner name\n1079784248112951296,reply,@PNchP_ ‡πÄ‡∏™‡∏µ‡∏¢‡∏à‡∏±‡∏¢‡∏≠‡∏∞ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏á‡∏±‡∏¢ ‡∏ô‡∏µ‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÄ‡∏≠‡∏á,2019-01-01 00:00:00,560,twitter,1904452146,‡∏´‡∏°‡∏µ‡∏ä‡∏°‡∏û‡∏π\npcnk_2hand_Bvo-Iy3g7gw,post,"üåªüåªüåª ‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ô‡πà‡∏≤‡∏£‡∏±‡∏Å‡∏ú‡πâ‡∏≤‡πÉ‡∏™‡πà‡∏™‡∏ö‡∏≤‡∏¢ 50‡∏ø . üìå ‚ú®‡∏•‡∏ó‡∏ö 30 ems 50\n‚ú®‡πÄ‡∏Å‡∏á‡∏¢‡∏µ‡∏ô‡∏™‡πå 40 ems 60\n\n__________________________\n‡∏Å‡∏ï‡∏¥‡∏Å‡∏≤üì¢üì¢üì¢ ‚ÄºÔ∏è‚ÄºÔ∏è ‡πÄ‡∏≠‡∏ü‡πÉ‡∏ï‡πâ‡∏£‡∏π‡∏õ ‡∏´‡∏£‡∏∑‡∏≠‡∏ó‡∏±‡∏Å‡∏´‡∏≤‡πÅ‡∏°‡πà‡∏Ñ‡πâ‡∏≤‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏ô‡πâ‡∏≤‡∏≤‡∏≤‚ÄºÔ∏è‚ÄºÔ∏è ‚ùå‡πÄ‡∏≠‡∏ü‡∏Å‡πà‡∏≠‡∏ô‡πÇ‡∏≠‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á‡∏Å‡πà‡∏≠‡∏ô ‡∏á‡∏î‡∏î‡∏£‡∏≤‡∏°‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏≤‡∏≤‚ùå üôèüèª‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÇ‡∏≠‡∏ô‡∏Ñ‡πà‡∏≠‡∏¢‡∏ó‡∏±‡∏Å‡∏°‡∏≤‡∏ô‡∏∞‡∏Ñ‡∏∞ ‡πÑ‡∏°‡πà‡πÄ‡∏≠‡∏ü‡πÄ‡∏•‡πà‡∏ô‡∏ô‡πâ‡∏≤‡∏≤‡∏≤üôèüèª #‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤‡∏°‡∏∑‡∏≠‡∏™‡∏≠‡∏á #‡πÇ‡∏•‡πä‡∏∞‡∏ï‡∏π‡πâ #‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô #‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤ #‡πÇ‡∏•‡πä‡∏∞‡∏ï‡∏π‡πâ‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤‡∏°‡∏∑‡∏≠‡∏™‡∏≠‡∏á #‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤‡∏°‡∏∑‡∏≠‡∏™‡∏≠‡∏á #‡πÇ‡∏•‡πä‡∏∞‡∏ï‡∏π‡πâ‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤ #‡πÇ‡∏•‡πä‡∏∞‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤ #‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤‡∏™‡∏ß‡∏¢‡πÜ #2hand #‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠‡∏™‡∏†‡∏≤‡∏û‡∏ô‡∏≤‡∏á‡∏ü‡πâ‡∏≤ #‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠ #‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤‡∏ñ‡∏π‡∏Å‡πÜ #‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤‡∏°‡∏∑‡∏≠2 #‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ñ‡∏π‡∏Å #‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ñ‡∏π‡∏Å‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡πà‡∏á #‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏ö‡∏≤‡πÜ #‡∏™‡∏†‡∏≤‡∏û‡∏ô‡∏≤‡∏á‡∏ü‡πâ‡∏≤ #‡∏°‡∏∑‡∏≠‡∏™‡∏≠‡∏á‡∏™‡∏†‡∏≤‡∏û‡∏î‡∏µ #‡∏°‡∏∑‡∏≠‡∏™‡∏≠‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ñ‡∏π‡∏Å #‡∏Å‡∏≤‡∏á‡πÄ‡∏Å‡∏á #‡∏ß‡∏¥‡∏ô‡πÄ‡∏ó‡∏à #‡πÄ‡∏Å‡∏á‡∏¢‡∏µ‡∏ô‡∏™‡πå #‡∏Å‡∏≤‡∏á‡πÄ‡∏Å‡∏á‡∏ñ‡∏π‡∏Å‡πÜ #2hand  #2handthailand #‡∏°‡∏∑‡∏≠‡∏™‡∏≠‡∏á #‡∏ß‡∏¥‡∏ô‡πÄ‡∏ó‡∏à #‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ñ‡∏π‡∏Å #‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤‡∏ô‡πà‡∏≤‡∏£‡∏±‡∏Å",2019-03-31 00:04:21,3860,instagram,10677434124,"HELLO üëã \n‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤‡∏°‡∏∑‡∏≠ 1,2üëïüëó"\n1112038291539263489,tweet,‡∏ã‡∏∑‡πâ‡∏≠‡∏ö‡∏±‡∏ï‡∏£ cat6 ‡∏î‡∏µ‡∏°‡πà‡∏∞ ‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏∞‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏õ‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á cat t-shirt,2019-03-31 00:06:04,315,twitter,267263658,‡∏°‡∏∏‡∏Å‡∏™‡∏∏‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡∏ß‡∏≠‡∏£‡πå‡∏îmed\n',
            actual,
        )

    def test_be_able_to_write_data_into_file_with_csv_format(self):
        reader = Reader()
        writer = Writer()
        obj = Copy(reader, writer)
        obj.construct('test/input_file/basic_line')
        output_path = 'test/output_file/basic_data_to_csv'
        obj.to_csv(output_path)
        with open(output_path, 'r') as reader:
            expect = reader.read()
        self.assertEqual(
            '1079784248112951296,reply,@PNchP_ ‡πÄ‡∏™‡∏µ‡∏¢‡∏à‡∏±‡∏¢‡∏≠‡∏∞ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏á‡∏±‡∏¢ ‡∏ô‡∏µ‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÄ‡∏≠‡∏á,2019-01-01 00:00:00,560,twitter,1904452146,‡∏´‡∏°‡∏µ‡∏ä‡∏°‡∏û‡∏π\n',
            expect,
        )
