---

title: Welcome to fa_convnav

keywords: fastai
sidebar: home_sidebar

summary: "CNN viewer and element selector."
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    {% raw %}
        
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>fa_convnav works with the fastai deep learning library, allowing users to explore convolutional neural network (CNN)  structure and composition as well as select modules and layers for further investigation using hooks and callbacks.</p>
<p>fa_convnav provides native support for the following types of CNN model:</p>
<ul>
<li>VGG</li>
<li>alexnet</li>
<li>resnets</li>
<li>squeezenets</li>
<li>densenets</li>
<li>xresnets</li>
</ul>
<p>With minimal code changes, fa_convnav can also be adapted for use with other CNN architectures and custom CNN models.</p>
<p><strong>A note about naming.</strong> Naming conventions for the elements of a CNN is confusing with many terms such as layer and module used interchangeably. Here we use the following definitions to describe a CNN.</p>
<ul>
<li><strong>'layers'</strong> are the information processing units of the model, they can be single elements (e.g. <code>conv2d</code>, <code>batchnorm2d</code>, <code>maxpool</code>, <code>relu</code> etc) or for larger models with deeply nested sequences, a short sequence of elements wrapped in a container element. </li>
<li><strong>'modules'</strong> may be layers but also container elements, such as <code>nn.sequential</code>, which wrap a sequence of layers.</li>
<li><strong>'container'</strong> elements group sequences of CNN layers or modules togather into functional units.</li>
<li><strong>'elements'</strong> are all the elements that make up the CNN, both container and non-container,  layers and modules.</li>
<li><strong>'divisions'</strong> refer to the head (1) and body (0)  of a transfer learning model</li>
<li><strong>'child containers'</strong> are the first tier of nested modules. These usually match the modules returned with the fastai <code>model.named_children()</code> method. </li>
<li><strong>'Blocks'</strong> are the second tier of nested modules, usually repeating throughout the main bulk of the model and containing a fixed sequence of layers. Depending on the architecture, blocks may have a specific name such as <code>BasicBlock</code> or <code>_DenseBlock</code>.</li>
<li><strong>'model'</strong> refers to a pre-trained architecture with head and body divisions. </li>
<li><strong>architecture</strong> is an untrained neural network</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Install">Install<a class="anchor-link" href="#Install">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">

<pre><code>pip install fa_convnav</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="How-to-Use">How to Use<a class="anchor-link" href="#How-to-Use">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First set up a deep learning vision project using fastai2 and create a Learner object from a dataloader, pretrained model and an optimizer. All the pretrained models installed with the fastai2 library are supported by fa_convnav. Run <code>convnav_supported_models()</code> in a notebook cell to see the complete list.</p>
<p>If you are not familiar with the fastai/fastai2 library then the <a href="https://dev.fast.ai/">fastai documentation</a> or most recent<a href="https://course.fast.ai/index.html">Deep Learning for Coders</a> course are excellent places to start. Alternatively to quickly get a feel for and play around with fastai2 and fa_convnav see the example notebooks, <code>03_examples00.ipynb</code> and <code>04_examples 01.ipynb</code> in this repo.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Create-and-view-a-ConvNav-dataframe.">Create and view a ConvNav dataframe.<a class="anchor-link" href="#Create-and-view-a-ConvNav-dataframe.">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">

<pre><code>from fa_convnav.navigator import *</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>With a fastai Learner object <code>Learner</code>, create a ConvNav instance <code>cn</code>:</p>

<pre><code>cn = ConvNav(learner, Learner.summary())</code></pre>
<p>The model type and name are automatically detected and a dataframe of CNN model information built. We will call this a CNDF dataframe. CNDF dataframes combine an intuitive representation of the model architecture along with the description, class, output dimensions, parameters and frozen/unfrozen status of each module and layer.</p>
<p>View a CNDF dataframe:</p>

<pre><code>cn.view()</code></pre>
<p>or</p>

<pre><code>cn() *prints just the first ten rows</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Searching-a-CNDF-dataframe-and-selecting-model-elements">Searching a CNDF dataframe and selecting model elements<a class="anchor-link" href="#Searching-a-CNDF-dataframe-and-selecting-model-elements">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>CNDF dataframes can be viewed whole to see the overall structure of the model as well as subsetted and/or searched for any combination of model element(s). The selected element(s) are displayed and the module objects returned for further use, for example as targets for pytorch hooks and fastai callbacks. CNDF dataframes can also be saved to persistent storage.</p>
<p>For example:</p>

<pre><code>cn.divs</code></pre>
<p>Displays summary information for the model body and head.</p>

<pre><code>cn.search('0.0.2', exact=True)</code></pre>
<p>Searches for, displays and returns the module object with module_name '0.0.2'.</p>

<pre><code>cn.spread(req='conv', num=8)</code></pre>
<p>Searches for, displays and returns the module objects for eight <code>Conv2d</code> layers equally spaced from start to end of the model.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Example-notebooks">Example notebooks<a class="anchor-link" href="#Example-notebooks">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Find <code>03_examples00.ipynb</code> and <code>04_examples01.ipynb</code> in this repo. These contain working examples of fa_convnav used to view a resnet model and select appropriate modules for use in investigating model training. Example notebooks can be downloaded and run in any notebook environment.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Tests">Tests<a class="anchor-link" href="#Tests">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To run test in parallel launch:
<code>nbdev_test_nbs</code> from the command line 
or
<code>!nbdev_test_nbs</code> from inside a Jupyter Notebook with nbdev installed</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Docs">Docs<a class="anchor-link" href="#Docs">&#182;</a></h2><p>This project, it's github repo and documentation were all built using the fastai nbdev literate programming environment for Jupyter Notebooks. Find out more about nbdev and use it in your own project <a href="https://github.com/fastai/nbdev">here</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Contributing">Contributing<a class="anchor-link" href="#Contributing">&#182;</a></h2><p>After you clone this repository, please run nbdev_install_git_hooks in your terminal. This sets up git hooks, which clean up the notebooks to remove the extraneous stuff stored in the notebooks (e.g. which cells you ran) which causes unnecessary merge conflicts.</p>
<p>Before submitting a PR, check that the local library and notebooks match. The script nbdev_diff_nbs can let you know if there is a difference between the local library and the notebooks.</p>
<p>If you made a change to the notebooks in one of the exported cells, you can export it to the library with nbdev_build_lib or make fastai2.
If you made a change to the library, you can export it back to the notebooks with nbdev_update_lib.</p>

</div>
</div>
</div>
    {% endraw %}
</div>
 

