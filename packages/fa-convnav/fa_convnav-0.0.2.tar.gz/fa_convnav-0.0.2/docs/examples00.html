---

title: Examples00

keywords: fastai
sidebar: home_sidebar

summary: "How to use fa_convnav to view a CNN pretrained model."
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 03_examples00.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    {% raw %}
        
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Import fastai deep learning library including pretrained vision models.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fastai2.basics</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">fastai2.callback.all</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">fastai2.vision.all</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="k">import</span> <span class="n">torch</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Import the fa_convnav.navigator module</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fa_convnav.navigator</span> <span class="k">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Supported models
================

vgg11_bn
vgg13_bn
vgg16_bn
vgg19_bn
alexnet
squeezenet1_0
squeezenet1_1
resnet18
resnet34
resnet50
resnet101
resnet151
densenet121
densenet161
densenet169
densenet201
xresnet101
xresnet152
xresnet18
xresnet18_deep
xresnet18_deeper
xresnet34
xresnet34_deep
xresnet34_deeper
xresnet50
xresnet50_deep
xresnet50_deeper
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Create a fastai datablock and dataloader using the Oxford PetsII dataset (included with fastai install), and apply some simple image transforms in the process.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pets</span> <span class="o">=</span> <span class="n">DataBlock</span><span class="p">(</span><span class="n">blocks</span><span class="o">=</span><span class="p">(</span><span class="n">ImageBlock</span><span class="p">,</span> <span class="n">CategoryBlock</span><span class="p">),</span> 
                 <span class="n">get_items</span><span class="o">=</span><span class="n">get_image_files</span><span class="p">,</span> 
                 <span class="n">splitter</span><span class="o">=</span><span class="n">RandomSplitter</span><span class="p">(),</span>
                 <span class="n">get_y</span><span class="o">=</span><span class="n">RegexLabeller</span><span class="p">(</span><span class="n">pat</span> <span class="o">=</span> <span class="s1">r&#39;/([^/]+)_\d+.jpg$&#39;</span><span class="p">),</span>
                 <span class="n">item_tfms</span><span class="o">=</span><span class="n">Resize</span><span class="p">(</span><span class="mi">460</span><span class="p">),</span>
                 <span class="n">batch_tfms</span><span class="o">=</span><span class="p">[</span><span class="o">*</span><span class="n">aug_transforms</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">224</span><span class="p">,</span> <span class="n">max_rotate</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">min_scale</span><span class="o">=</span><span class="mf">0.75</span><span class="p">),</span> <span class="n">Normalize</span><span class="o">.</span><span class="n">from_stats</span><span class="p">(</span><span class="o">*</span><span class="n">imagenet_stats</span><span class="p">)])</span>

<span class="n">dls</span> <span class="o">=</span> <span class="n">pets</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">PETS</span><span class="p">)</span><span class="o">/</span><span class="s2">&quot;images&quot;</span><span class="p">,</span>  <span class="n">bs</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Download the pretrained model we want to use</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">resnet18</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Create a fastai Learner object from the dataloader, the chosen model, an optimiser. We will use the error rate as our metric.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">cnn_learner</span><span class="p">(</span>
    <span class="n">dls</span><span class="p">,</span> 
    <span class="n">model</span><span class="p">,</span> 
    <span class="n">opt_func</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">Adam</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">3</span><span class="n">e</span><span class="o">-</span><span class="mi">3</span><span class="p">),</span> <span class="n">wd</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">8</span><span class="p">),</span> 
    <span class="n">metrics</span><span class="o">=</span><span class="n">error_rate</span><span class="p">,</span> 
    <span class="n">config</span><span class="o">=</span><span class="n">cnn_config</span><span class="p">(</span><span class="n">ps</span><span class="o">=</span><span class="mf">0.33</span><span class="p">))</span><span class="o">.</span><span class="n">to_fp16</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The model is ready to be trained but, now we have a Learner, it can also be viewed in detail using fa_convnav. Create a ConvNav instance.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cn</span> <span class="o">=</span> <span class="n">ConvNav</span><span class="p">(</span><span class="n">learn</span><span class="p">,</span> <span class="n">learn</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Creating an instance automatically builds a datraframe representation of the model (a CNDF dataframe). This step can take a few moments, especially for larger models such as densenets or xresnets which have hundreds of modules. If you have more than one Learner in your project, instantiate a separate ConvNav instance for each one.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Once the dataframe is built we can view, search and select from it. For example, print some summary information:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">cn</span><span class="o">.</span><span class="n">model_info</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Resnet: Resnet18
Input shape: [128 x 3 x 224 x 224] (bs, ch, h, w)
Output features: [128 x 37] (bs, classes)
Currently frozen to parameter group 3 out of 3
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Examine summary information about the body and head of the model.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cn</span><span class="o">.</span><span class="n">divs</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Resnet: Resnet18
Input shape: [128 x 3 x 224 x 224] (bs, ch, h, w)
Divisions:  body (0), head (1)

</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Module_name</th>
      <th>Model</th>
      <th>Division</th>
      <th>Container_child (num)</th>
      <th>Container_block (num)</th>
      <th>Layers</th>
      <th>Torch_class</th>
      <th>Output_dimensions</th>
      <th>Parameters</th>
      <th>Trainable</th>
      <th>Currently</th>
    </tr>
    <tr>
      <th>Index</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>resnet18</td>
      <td>Sequential</td>
      <td>8</td>
      <td>8</td>
      <td>53</td>
      <td>torch.nn.modules.container.Sequential</td>
      <td>[128 x 512 x 7 x 7]</td>
      <td>11176512</td>
      <td></td>
      <td>Frozen</td>
    </tr>
    <tr>
      <th>67</th>
      <td>1</td>
      <td>resnet18</td>
      <td>Sequential</td>
      <td>9</td>
      <td>0</td>
      <td>10</td>
      <td>torch.nn.modules.container.Sequential</td>
      <td>[128 x 37]</td>
      <td>546304</td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>View the whole CNDF dataframe. For brevity, only the first ten modules are displayed here, but set <code>top = False</code> (or remove) and all 79 rows of the dataframe will be shown. Run the notebook and try it!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cn</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Resnet: Resnet18
Input shape: [128 x 3 x 224 x 224] (bs, ch, h, w)
Output features: [128 x 37] (bs, classes)
Currently frozen to parameter group 3 out of 3

</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Module_name</th>
      <th>Model</th>
      <th>Division</th>
      <th>Container_child</th>
      <th>Container_block</th>
      <th>Layer_description</th>
      <th>Torch_class</th>
      <th>Output_dimensions</th>
      <th>Parameters</th>
      <th>Trainable</th>
      <th>Currently</th>
    </tr>
    <tr>
      <th>Index</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td></td>
      <td>Sequential</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>torch.nn.modules.container.Sequential</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td></td>
      <td>Sequential</td>
      <td></td>
      <td></td>
      <td></td>
      <td>torch.nn.modules.container.Sequential</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td></td>
      <td></td>
      <td>Conv2d</td>
      <td></td>
      <td>Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)</td>
      <td>torch.nn.modules.conv.Conv2d</td>
      <td>[128 x 64 x 112 x 11]</td>
      <td>9,408</td>
      <td>False</td>
      <td>Frozen</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.1</td>
      <td></td>
      <td></td>
      <td>BatchNorm2d</td>
      <td></td>
      <td>BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)</td>
      <td>torch.nn.modules.batchnorm.BatchNorm2d</td>
      <td>[128 x 64 x 112 x 11]</td>
      <td>128</td>
      <td>True</td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.2</td>
      <td></td>
      <td></td>
      <td>ReLU</td>
      <td></td>
      <td>ReLU(inplace=True)</td>
      <td>torch.nn.modules.activation.ReLU</td>
      <td>[128 x 64 x 112 x 11]</td>
      <td>0</td>
      <td>False</td>
      <td></td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.3</td>
      <td></td>
      <td></td>
      <td>MaxPool2d</td>
      <td></td>
      <td>MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)</td>
      <td>torch.nn.modules.pooling.MaxPool2d</td>
      <td>[128 x 64 x 56 x 56]</td>
      <td>0</td>
      <td>False</td>
      <td></td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.4</td>
      <td></td>
      <td></td>
      <td>Sequential</td>
      <td></td>
      <td></td>
      <td>torch.nn.modules.container.Sequential</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.4.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td>BasicBlock</td>
      <td></td>
      <td>torchvision.models.resnet.BasicBlock</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.4.0.conv1</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)</td>
      <td>torch.nn.modules.conv.Conv2d</td>
      <td>[128 x 64 x 56 x 56]</td>
      <td>36,864</td>
      <td>False</td>
      <td>Frozen</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.4.0.bn1</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)</td>
      <td>torch.nn.modules.batchnorm.BatchNorm2d</td>
      <td>[128 x 64 x 56 x 56]</td>
      <td>128</td>
      <td>True</td>
      <td></td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>...69 more layers
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can examine the layers of the head only.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cn</span><span class="o">.</span><span class="n">head</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Resnet: Resnet18
Input shape: [128 x 512 x 7 x 7] (bs, filt, h, w)
Output features: [128 x 37] (bs, classes)

</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<style  type="text/css" >
    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row0_col0 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row0_col1 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row0_col2 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row0_col3 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row0_col4 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row0_col5 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row0_col6 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row0_col7 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row0_col8 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row0_col9 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row1_col0 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row1_col1 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row1_col2 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row1_col3 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row1_col4 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row1_col5 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row1_col6 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row1_col7 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row1_col8 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row1_col9 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row2_col0 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row2_col1 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row2_col2 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row2_col3 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row2_col4 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row2_col5 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row2_col6 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row2_col7 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row2_col8 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row2_col9 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row3_col0 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row3_col1 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row3_col2 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row3_col3 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row3_col4 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row3_col5 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row3_col6 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row3_col7 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row3_col8 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row3_col9 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row4_col0 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row4_col1 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row4_col2 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row4_col3 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row4_col4 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row4_col5 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row4_col6 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row4_col7 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row4_col8 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row4_col9 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row5_col0 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row5_col1 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row5_col2 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row5_col3 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row5_col4 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row5_col5 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row5_col6 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row5_col7 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row5_col8 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row5_col9 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row6_col0 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row6_col1 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row6_col2 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row6_col3 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row6_col4 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row6_col5 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row6_col6 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row6_col7 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row6_col8 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row6_col9 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row7_col0 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row7_col1 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row7_col2 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row7_col3 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row7_col4 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row7_col5 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row7_col6 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row7_col7 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row7_col8 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row7_col9 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row8_col0 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row8_col1 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row8_col2 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row8_col3 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row8_col4 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row8_col5 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row8_col6 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row8_col7 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row8_col8 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row8_col9 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row9_col0 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row9_col1 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row9_col2 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row9_col3 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row9_col4 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row9_col5 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row9_col6 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row9_col7 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row9_col8 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row9_col9 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row10_col0 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row10_col1 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row10_col2 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row10_col3 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row10_col4 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row10_col5 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row10_col6 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row10_col7 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row10_col8 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row10_col9 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row11_col0 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row11_col1 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row11_col2 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row11_col3 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row11_col4 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row11_col5 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row11_col6 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row11_col7 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row11_col8 {
            text-align:  left;
        }    #T_7d84b828_5351_11ea_88f1_0242ac1c0002row11_col9 {
            text-align:  left;
        }</style><table id="T_7d84b828_5351_11ea_88f1_0242ac1c0002" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >Module_name</th>        <th class="col_heading level0 col1" >Model</th>        <th class="col_heading level0 col2" >Division</th>        <th class="col_heading level0 col3" >Container_child</th>        <th class="col_heading level0 col4" >Container_block</th>        <th class="col_heading level0 col5" >Layer_description</th>        <th class="col_heading level0 col6" >Torch_class</th>        <th class="col_heading level0 col7" >Output_dimensions</th>        <th class="col_heading level0 col8" >Parameters</th>        <th class="col_heading level0 col9" >Trainable</th>    </tr>    <tr>        <th class="index_name level0" >Index</th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>    </tr></thead><tbody>
                <tr>
                        <th id="T_7d84b828_5351_11ea_88f1_0242ac1c0002level0_row0" class="row_heading level0 row0" >67</th>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row0_col0" class="data row0 col0" >1</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row0_col1" class="data row0 col1" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row0_col2" class="data row0 col2" >Sequential</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row0_col3" class="data row0 col3" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row0_col4" class="data row0 col4" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row0_col5" class="data row0 col5" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row0_col6" class="data row0 col6" >torch.nn.modules.container.Sequential</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row0_col7" class="data row0 col7" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row0_col8" class="data row0 col8" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row0_col9" class="data row0 col9" ></td>
            </tr>
            <tr>
                        <th id="T_7d84b828_5351_11ea_88f1_0242ac1c0002level0_row1" class="row_heading level0 row1" >68</th>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row1_col0" class="data row1 col0" >1.0</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row1_col1" class="data row1 col1" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row1_col2" class="data row1 col2" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row1_col3" class="data row1 col3" >AdaptiveConcatPool2d</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row1_col4" class="data row1 col4" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row1_col5" class="data row1 col5" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row1_col6" class="data row1 col6" >fastai2.layers.AdaptiveConcatPool2d</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row1_col7" class="data row1 col7" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row1_col8" class="data row1 col8" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row1_col9" class="data row1 col9" ></td>
            </tr>
            <tr>
                        <th id="T_7d84b828_5351_11ea_88f1_0242ac1c0002level0_row2" class="row_heading level0 row2" >69</th>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row2_col0" class="data row2 col0" >1.0.ap</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row2_col1" class="data row2 col1" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row2_col2" class="data row2 col2" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row2_col3" class="data row2 col3" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row2_col4" class="data row2 col4" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row2_col5" class="data row2 col5" >AdaptiveAvgPool2d(output_size=1)</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row2_col6" class="data row2 col6" >torch.nn.modules.pooling.AdaptiveAvgPool2d</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row2_col7" class="data row2 col7" >[128 x 512 x 1 x 1]</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row2_col8" class="data row2 col8" >0</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row2_col9" class="data row2 col9" >False</td>
            </tr>
            <tr>
                        <th id="T_7d84b828_5351_11ea_88f1_0242ac1c0002level0_row3" class="row_heading level0 row3" >70</th>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row3_col0" class="data row3 col0" >1.0.mp</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row3_col1" class="data row3 col1" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row3_col2" class="data row3 col2" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row3_col3" class="data row3 col3" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row3_col4" class="data row3 col4" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row3_col5" class="data row3 col5" >AdaptiveMaxPool2d(output_size=1)</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row3_col6" class="data row3 col6" >torch.nn.modules.pooling.AdaptiveMaxPool2d</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row3_col7" class="data row3 col7" >[128 x 512 x 1 x 1]</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row3_col8" class="data row3 col8" >0</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row3_col9" class="data row3 col9" >False</td>
            </tr>
            <tr>
                        <th id="T_7d84b828_5351_11ea_88f1_0242ac1c0002level0_row4" class="row_heading level0 row4" >71</th>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row4_col0" class="data row4 col0" >1.1</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row4_col1" class="data row4 col1" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row4_col2" class="data row4 col2" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row4_col3" class="data row4 col3" >Flatten</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row4_col4" class="data row4 col4" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row4_col5" class="data row4 col5" >Flatten(full=False)</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row4_col6" class="data row4 col6" >fastai2.layers.Flatten</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row4_col7" class="data row4 col7" >[128 x 1024]</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row4_col8" class="data row4 col8" >0</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row4_col9" class="data row4 col9" >False</td>
            </tr>
            <tr>
                        <th id="T_7d84b828_5351_11ea_88f1_0242ac1c0002level0_row5" class="row_heading level0 row5" >72</th>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row5_col0" class="data row5 col0" >1.2</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row5_col1" class="data row5 col1" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row5_col2" class="data row5 col2" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row5_col3" class="data row5 col3" >BatchNorm1d</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row5_col4" class="data row5 col4" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row5_col5" class="data row5 col5" >BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row5_col6" class="data row5 col6" >torch.nn.modules.batchnorm.BatchNorm1d</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row5_col7" class="data row5 col7" >[128 x 1024]</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row5_col8" class="data row5 col8" >2,048</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row5_col9" class="data row5 col9" >True</td>
            </tr>
            <tr>
                        <th id="T_7d84b828_5351_11ea_88f1_0242ac1c0002level0_row6" class="row_heading level0 row6" >73</th>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row6_col0" class="data row6 col0" >1.3</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row6_col1" class="data row6 col1" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row6_col2" class="data row6 col2" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row6_col3" class="data row6 col3" >Dropout</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row6_col4" class="data row6 col4" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row6_col5" class="data row6 col5" >Dropout(p=0.165, inplace=False)</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row6_col6" class="data row6 col6" >torch.nn.modules.dropout.Dropout</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row6_col7" class="data row6 col7" >[128 x 1024]</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row6_col8" class="data row6 col8" >0</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row6_col9" class="data row6 col9" >False</td>
            </tr>
            <tr>
                        <th id="T_7d84b828_5351_11ea_88f1_0242ac1c0002level0_row7" class="row_heading level0 row7" >74</th>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row7_col0" class="data row7 col0" >1.4</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row7_col1" class="data row7 col1" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row7_col2" class="data row7 col2" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row7_col3" class="data row7 col3" >Linear</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row7_col4" class="data row7 col4" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row7_col5" class="data row7 col5" >Linear(in_features=1024, out_features=512, bias=False)</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row7_col6" class="data row7 col6" >torch.nn.modules.linear.Linear</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row7_col7" class="data row7 col7" >[128 x 512]</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row7_col8" class="data row7 col8" >524,288</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row7_col9" class="data row7 col9" >True</td>
            </tr>
            <tr>
                        <th id="T_7d84b828_5351_11ea_88f1_0242ac1c0002level0_row8" class="row_heading level0 row8" >75</th>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row8_col0" class="data row8 col0" >1.5</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row8_col1" class="data row8 col1" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row8_col2" class="data row8 col2" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row8_col3" class="data row8 col3" >ReLU</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row8_col4" class="data row8 col4" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row8_col5" class="data row8 col5" >ReLU(inplace=True)</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row8_col6" class="data row8 col6" >torch.nn.modules.activation.ReLU</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row8_col7" class="data row8 col7" >[128 x 512]</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row8_col8" class="data row8 col8" >0</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row8_col9" class="data row8 col9" >False</td>
            </tr>
            <tr>
                        <th id="T_7d84b828_5351_11ea_88f1_0242ac1c0002level0_row9" class="row_heading level0 row9" >76</th>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row9_col0" class="data row9 col0" >1.6</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row9_col1" class="data row9 col1" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row9_col2" class="data row9 col2" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row9_col3" class="data row9 col3" >BatchNorm1d</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row9_col4" class="data row9 col4" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row9_col5" class="data row9 col5" >BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row9_col6" class="data row9 col6" >torch.nn.modules.batchnorm.BatchNorm1d</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row9_col7" class="data row9 col7" >[128 x 512]</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row9_col8" class="data row9 col8" >1,024</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row9_col9" class="data row9 col9" >True</td>
            </tr>
            <tr>
                        <th id="T_7d84b828_5351_11ea_88f1_0242ac1c0002level0_row10" class="row_heading level0 row10" >77</th>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row10_col0" class="data row10 col0" >1.7</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row10_col1" class="data row10 col1" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row10_col2" class="data row10 col2" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row10_col3" class="data row10 col3" >Dropout</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row10_col4" class="data row10 col4" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row10_col5" class="data row10 col5" >Dropout(p=0.33, inplace=False)</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row10_col6" class="data row10 col6" >torch.nn.modules.dropout.Dropout</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row10_col7" class="data row10 col7" >[128 x 512]</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row10_col8" class="data row10 col8" >0</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row10_col9" class="data row10 col9" >False</td>
            </tr>
            <tr>
                        <th id="T_7d84b828_5351_11ea_88f1_0242ac1c0002level0_row11" class="row_heading level0 row11" >78</th>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row11_col0" class="data row11 col0" >1.8</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row11_col1" class="data row11 col1" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row11_col2" class="data row11 col2" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row11_col3" class="data row11 col3" >Linear</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row11_col4" class="data row11 col4" ></td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row11_col5" class="data row11 col5" >Linear(in_features=512, out_features=37, bias=False)</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row11_col6" class="data row11 col6" >torch.nn.modules.linear.Linear</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row11_col7" class="data row11 col7" >[128 x 37]</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row11_col8" class="data row11 col8" >18,944</td>
                        <td id="T_7d84b828_5351_11ea_88f1_0242ac1c0002row11_col9" class="data row11 col9" >True</td>
            </tr>
    </tbody></table>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Select a single block of modules.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">block</span> <span class="o">=</span> <span class="n">cn</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;0.4.0&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1 layers found matching searchterm(s): 0.4.0

</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Module_name</th>
      <th>Model</th>
      <th>Division</th>
      <th>Container_child</th>
      <th>Container_block</th>
      <th>Layer_description</th>
      <th>Torch_class</th>
      <th>Output_dimensions</th>
      <th>Parameters</th>
      <th>Trainable</th>
      <th>Currently</th>
    </tr>
    <tr>
      <th>Index</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>0.4.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td>BasicBlock</td>
      <td></td>
      <td>torchvision.models.resnet.BasicBlock</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Look at just those layers with dimension change between input and outputs.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">layers</span> <span class="o">=</span> <span class="n">cn</span><span class="o">.</span><span class="n">dim_transitions</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Resnet18
Layer dimension changes

</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Module_name</th>
      <th>Model</th>
      <th>Division</th>
      <th>Container_child</th>
      <th>Container_block</th>
      <th>Layer_description</th>
      <th>Torch_class</th>
      <th>Output_dimensions</th>
      <th>Parameters</th>
      <th>Trainable</th>
      <th>Currently</th>
    </tr>
    <tr>
      <th>Index</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td></td>
      <td>0</td>
      <td>Conv2d</td>
      <td></td>
      <td>Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)</td>
      <td>torch.nn.modules.conv.Conv2d</td>
      <td>[128 x 64 x 112 x 11]</td>
      <td>9,408</td>
      <td>False</td>
      <td>Frozen</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.4.0.conv1</td>
      <td></td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)</td>
      <td>torch.nn.modules.conv.Conv2d</td>
      <td>[128 x 64 x 56 x 56]</td>
      <td>36,864</td>
      <td>False</td>
      <td>Frozen</td>
    </tr>
    <tr>
      <th>21</th>
      <td>0.5.0.conv1</td>
      <td></td>
      <td>0</td>
      <td>5</td>
      <td>0</td>
      <td>Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)</td>
      <td>torch.nn.modules.conv.Conv2d</td>
      <td>[128 x 128 x 28 x 28]</td>
      <td>73,728</td>
      <td>False</td>
      <td>Frozen</td>
    </tr>
    <tr>
      <th>37</th>
      <td>0.6.0.conv1</td>
      <td></td>
      <td>0</td>
      <td>6</td>
      <td>0</td>
      <td>Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)</td>
      <td>torch.nn.modules.conv.Conv2d</td>
      <td>[128 x 256 x 14 x 14]</td>
      <td>294,912</td>
      <td>False</td>
      <td>Frozen</td>
    </tr>
    <tr>
      <th>53</th>
      <td>0.7.0.conv1</td>
      <td></td>
      <td>0</td>
      <td>7</td>
      <td>0</td>
      <td>Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)</td>
      <td>torch.nn.modules.conv.Conv2d</td>
      <td>[128 x 512 x 7 x 7]</td>
      <td>1,179,648</td>
      <td>False</td>
      <td>Frozen</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When selections are made, the selected modules are shown in a dataframe (above) but the corresponding module objects are returned to the user in a list (below). Module objects can be used to apply Pytorch hooks and fastai callbacks to further investigate model function.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">layers</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False),
 Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False),
 Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False),
 Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False),
 Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Or select a number of blocks evenly spaced over the model. This, and many of the fa_convnav selection methods, are trivial on a small model like vgg or resnet18 but come into their own when used with large, complex models such as densenets and xresnets where there may be many dozens of blocks and hundreds of layers.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">spread</span> <span class="o">=</span> <span class="n">cn</span><span class="o">.</span><span class="n">spread</span><span class="p">(</span><span class="s1">&#39;block&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>resnet18
Spread of block where n = 4

</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Module_name</th>
      <th>Model</th>
      <th>Division</th>
      <th>Container_child</th>
      <th>Container_block</th>
      <th>Num_layers</th>
      <th>Torch_class</th>
      <th>Output_dimensions</th>
      <th>Parameters</th>
      <th>Trainable</th>
      <th>Currently</th>
    </tr>
    <tr>
      <th>Index</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>0.4.0</td>
      <td></td>
      <td>0</td>
      <td>4</td>
      <td>BasicBlock</td>
      <td>5</td>
      <td>torchvision.models.resnet.BasicBlock</td>
      <td>[128 x 64 x 56 x 56]</td>
      <td></td>
      <td></td>
      <td>Frozen</td>
    </tr>
    <tr>
      <th>20</th>
      <td>0.5.0</td>
      <td></td>
      <td>0</td>
      <td>5</td>
      <td>BasicBlock</td>
      <td>8</td>
      <td>torchvision.models.resnet.BasicBlock</td>
      <td>[128 x 128 x 28 x 28]</td>
      <td></td>
      <td></td>
      <td>Frozen</td>
    </tr>
    <tr>
      <th>36</th>
      <td>0.6.0</td>
      <td></td>
      <td>0</td>
      <td>6</td>
      <td>BasicBlock</td>
      <td>8</td>
      <td>torchvision.models.resnet.BasicBlock</td>
      <td>[128 x 256 x 14 x 14]</td>
      <td></td>
      <td></td>
      <td>Frozen</td>
    </tr>
    <tr>
      <th>61</th>
      <td>0.7.1</td>
      <td></td>
      <td>0</td>
      <td>7</td>
      <td>BasicBlock</td>
      <td>5</td>
      <td>torchvision.models.resnet.BasicBlock</td>
      <td>[128 x 512 x 7 x 7]</td>
      <td></td>
      <td></td>
      <td>Frozen</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Selected blocks objects are also returned for further model investigation.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">spread</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;</span><span class="si">{b}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>BasicBlock(
  (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (relu): ReLU(inplace=True)
  (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
)

BasicBlock(
  (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (relu): ReLU(inplace=True)
  (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (downsample): Sequential(
    (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
    (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
)

BasicBlock(
  (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (relu): ReLU(inplace=True)
  (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (downsample): Sequential(
    (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
    (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
)

BasicBlock(
  (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (relu): ReLU(inplace=True)
  (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
)

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally CNDF dataframes can be saved and retrieved from persistenmt storage (see documentation). This allows you to work with a CNDF dataframe without the need to create it again from scratch every time.</p>

</div>
</div>
</div>
    {% endraw %}
</div>
 

